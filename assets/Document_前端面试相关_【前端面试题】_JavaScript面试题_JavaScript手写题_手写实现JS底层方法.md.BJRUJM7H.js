import{_ as s,c as n,o as a,a5 as l}from"./chunks/framework.DVTrgelf.js";const p="/FrontEndInterviewQuestion/assets/99977cf82d574db6ab5035a9d4ca5c40tplv-k3u1fbpfcp-jj-mark3024000q75.CGbqu5G9.webp",o="/FrontEndInterviewQuestion/assets/9f21b37ab3224207b35fc5ddc7b524fatplv-k3u1fbpfcp-jj-mark3024000q75.0e5rDdIf.webp",e="/FrontEndInterviewQuestion/assets/607f7c87fb8a42699c9b47157b28fc41tplv-k3u1fbpfcp-jj-mark3024000q75.9bOUL-9t.webp",t="/FrontEndInterviewQuestion/assets/75ed5d43d912462ba27375bfbbbfefd9tplv-k3u1fbpfcp-jj-mark3024000q75.DfNXwRDu.webp",r="/FrontEndInterviewQuestion/assets/f5b9100cb3344c52b603733aacded187tplv-k3u1fbpfcp-jj-mark3024000q75.CwiBlow4.webp",c="/FrontEndInterviewQuestion/assets/932fc9671ab846d5b86e9b73f73091c2tplv-k3u1fbpfcp-jj-mark3024000q75.CxJa8luU.webp",B="/FrontEndInterviewQuestion/assets/image-20240318180721640.DssZNSPd.png",y="/FrontEndInterviewQuestion/assets/image-20240318181140952.DBmttPq1.png",i="/FrontEndInterviewQuestion/assets/image-20240318181536184.B3AIVjV-.png",F="/FrontEndInterviewQuestion/assets/image-20240318181555586.C3bHCxvo.png",A="/FrontEndInterviewQuestion/assets/image-20240318181914567.DAxQ_IqF.png",C="/FrontEndInterviewQuestion/assets/image-20240318182147304.GZs7diZN.png",b="/FrontEndInterviewQuestion/assets/image-20240318182239803.B8wZU-JI.png",E="/FrontEndInterviewQuestion/assets/image-20240318201035211.J5fUAMO5.png",u="/FrontEndInterviewQuestion/assets/image-20240318201748272.CAK1Z82M.png",m="/FrontEndInterviewQuestion/assets/image-20240318201805973.CUieFVFr.png",D="/FrontEndInterviewQuestion/assets/image-20240318201819837.UBLqY8HS.png",d="/FrontEndInterviewQuestion/assets/image-20240318201831357.C2omuw9s.png",f="/FrontEndInterviewQuestion/assets/f32b5b305daa49f693f5bf5cf27d1787tplv-k3u1fbpfcp-jj-mark3024000q75.Bu9rHXrH.webp",g="/FrontEndInterviewQuestion/assets/50313439df974cf296925f33b27a479dtplv-k3u1fbpfcp-jj-mark3024000q75.UOJvfk9V.webp",h="/FrontEndInterviewQuestion/assets/3f63f4d37121469e9323a40c39c4ebc9tplv-k3u1fbpfcp-jj-mark3024000q75.h3uin2Tc.webp",T=JSON.parse('{"title":"æ‰‹å†™å®ç° JS åº•å±‚æ–¹æ³•","description":"","frontmatter":{},"headers":[],"relativePath":"Document/å‰ç«¯é¢è¯•ç›¸å…³/ã€å‰ç«¯é¢è¯•é¢˜ã€‘/JavaScripté¢è¯•é¢˜/JavaScriptæ‰‹å†™é¢˜/æ‰‹å†™å®ç°JSåº•å±‚æ–¹æ³•.md","filePath":"Document/å‰ç«¯é¢è¯•ç›¸å…³/ã€å‰ç«¯é¢è¯•é¢˜ã€‘/JavaScripté¢è¯•é¢˜/JavaScriptæ‰‹å†™é¢˜/æ‰‹å†™å®ç°JSåº•å±‚æ–¹æ³•.md","lastUpdated":1716655893000}'),v={name:"Document/å‰ç«¯é¢è¯•ç›¸å…³/ã€å‰ç«¯é¢è¯•é¢˜ã€‘/JavaScripté¢è¯•é¢˜/JavaScriptæ‰‹å†™é¢˜/æ‰‹å†™å®ç°JSåº•å±‚æ–¹æ³•.md"},q=l(`<h1 id="æ‰‹å†™å®ç°-js-åº•å±‚æ–¹æ³•" tabindex="-1">æ‰‹å†™å®ç° JS åº•å±‚æ–¹æ³• <a class="header-anchor" href="#æ‰‹å†™å®ç°-js-åº•å±‚æ–¹æ³•" aria-label="Permalink to &quot;æ‰‹å†™å®ç° JS åº•å±‚æ–¹æ³•&quot;">â€‹</a></h1><p>ä½¿ç”¨ JavaScript æ¨¡æ‹Ÿå®ç° JavaScript çš„åº•å±‚æ–¹æ³•</p><h2 id="ğŸŒŸ2022-2023-å¹´-å‰ç«¯-javascript-æ‰‹å†™é¢˜-ç¼–ç¨‹é¢˜" tabindex="-1">ğŸŒŸ2022-2023 å¹´ å‰ç«¯ JavaScript æ‰‹å†™é¢˜ï¼Œç¼–ç¨‹é¢˜ <a class="header-anchor" href="#ğŸŒŸ2022-2023-å¹´-å‰ç«¯-javascript-æ‰‹å†™é¢˜-ç¼–ç¨‹é¢˜" aria-label="Permalink to &quot;ğŸŒŸ2022-2023 å¹´ å‰ç«¯ JavaScript æ‰‹å†™é¢˜ï¼Œç¼–ç¨‹é¢˜&quot;">â€‹</a></h2><p>å‰ç«¯æ‰‹å†™é¢˜é›†é”¦ è®°å½•å¤§å‚<strong>ç¬”è¯•ï¼Œé¢è¯•å¸¸è€ƒ</strong>æ‰‹å†™é¢˜ï¼š<a href="https://github.com/Sunny-117/js-challenges" target="_blank" rel="noreferrer">https://github.com/Sunny-117/js-challenges</a></p><h2 id="å®ç°-json-parse" tabindex="-1">å®ç° JSON.parse <a class="header-anchor" href="#å®ç°-json-parse" aria-label="Permalink to &quot;å®ç° JSON.parse&quot;">â€‹</a></h2><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> json</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;{&quot;name&quot;:&quot;cxk&quot;, &quot;age&quot;:25}&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> obj</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> eval</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;(&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> json</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &quot;)&quot;</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æ­¤æ–¹æ³•å±äºâ¿Šé­”æ³•ï¼Œeval();ææ˜“å®¹æ˜“è¢« xss æ”»å‡»ï¼Œè¿˜æœ‰ä¸€ç§ new Function å¤§åŒå°å¼‚ã€‚</p><h2 id="æ‰‹å†™-object-create-æ–¹æ³•" tabindex="-1">æ‰‹å†™ Object.create æ–¹æ³• <a class="header-anchor" href="#æ‰‹å†™-object-create-æ–¹æ³•" aria-label="Permalink to &quot;æ‰‹å†™ Object.create æ–¹æ³•&quot;">â€‹</a></h2><p>Object.create()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½¿ç”¨ç°æœ‰çš„å¯¹è±¡æ¥æä¾›æ–°åˆ›å»ºçš„å¯¹è±¡çš„ protoã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// æ¨¡æ‹Ÿ Object.create</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> create</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">proto</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	function</span><span style="color:#61AFEF;"> F</span><span style="color:#ABB2BF;">() {}</span></span>
<span class="line"><span style="color:#E5C07B;">	F</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> proto</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">	F</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">constructor</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> F</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> F</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="object-is-å®ç°" tabindex="-1">Object.is å®ç° <a class="header-anchor" href="#object-is-å®ç°" aria-label="Permalink to &quot;Object.is å®ç°&quot;">â€‹</a></h2><p>é¢˜ç›®æè¿°:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">isä¸ä¼šè½¬æ¢è¢«æ¯”è¾ƒçš„ä¸¤ä¸ªå€¼çš„ç±»å‹</span><span style="color:#ABB2BF;">ï¼Œ</span><span style="color:#E06C75;">è¿™ç‚¹å’Œ</span><span style="color:#56B6C2;">===</span><span style="color:#E06C75;">æ›´ä¸ºç›¸ä¼¼</span><span style="color:#ABB2BF;">ï¼Œ</span><span style="color:#E06C75;">ä»–ä»¬ä¹‹é—´ä¹Ÿå­˜åœ¨ä¸€äº›åŒºåˆ«</span><span style="color:#ABB2BF;">ã€‚</span></span>
<span class="line"><span style="color:#D19A66;">    1.</span><span style="color:#E06C75;"> NaNåœ¨</span><span style="color:#56B6C2;">===</span><span style="color:#E06C75;">ä¸­æ˜¯ä¸ç›¸ç­‰çš„</span><span style="color:#ABB2BF;">ï¼Œ</span><span style="color:#E5C07B;">è€Œåœ¨Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">isä¸­æ˜¯ç›¸ç­‰çš„</span></span>
<span class="line"><span style="color:#D19A66;">    2.</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;">0</span><span style="color:#E06C75;">å’Œ</span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;">0</span><span style="color:#E06C75;">åœ¨</span><span style="color:#56B6C2;">===</span><span style="color:#E06C75;">ä¸­æ˜¯ç›¸ç­‰çš„</span><span style="color:#ABB2BF;">ï¼Œ</span><span style="color:#E5C07B;">è€Œåœ¨Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">isä¸­æ˜¯ä¸ç›¸ç­‰çš„</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å®ç°ä»£ç å¦‚ä¸‹:</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">is</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">x</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> y</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å½“å‰æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€ç§æƒ…å†µæ˜¯ç‰¹æ®Šçš„ï¼Œå³ +0 -0</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å¦‚æœ x !== 0ï¼Œåˆ™è¿”å›true</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å¦‚æœ x === 0ï¼Œåˆ™éœ€è¦åˆ¤æ–­+0å’Œ-0ï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ 1/+0 === Infinity å’Œ 1/-0 === -Infinityæ¥è¿›è¡Œåˆ¤æ–­</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> x</span><span style="color:#56B6C2;"> !==</span><span style="color:#D19A66;"> 0</span><span style="color:#56B6C2;"> ||</span><span style="color:#D19A66;"> 1</span><span style="color:#56B6C2;"> /</span><span style="color:#E06C75;"> x</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> 1</span><span style="color:#56B6C2;"> /</span><span style="color:#E06C75;"> y</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// x !== y çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦åˆ¤æ–­æ˜¯å¦ä¸ºNaNï¼Œå¦‚æœx!==xï¼Œåˆ™è¯´æ˜xæ˜¯NaNï¼ŒåŒç†yä¹Ÿä¸€æ ·</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// xå’ŒyåŒæ—¶ä¸ºNaNæ—¶ï¼Œè¿”å›true</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> x</span><span style="color:#56B6C2;"> !==</span><span style="color:#E06C75;"> x</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E06C75;"> y</span><span style="color:#56B6C2;"> !==</span><span style="color:#E06C75;"> y</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_1-æ‰‹å†™å®ç°-new-å…³é”®å­—-æ“ä½œç¬¦" tabindex="-1">1.æ‰‹å†™å®ç° New å…³é”®å­—(æ“ä½œç¬¦) <a class="header-anchor" href="#_1-æ‰‹å†™å®ç°-new-å…³é”®å­—-æ“ä½œç¬¦" aria-label="Permalink to &quot;1.æ‰‹å†™å®ç° New å…³é”®å­—(æ“ä½œç¬¦)&quot;">â€‹</a></h2><p>new è¢«è°ƒç”¨ååšäº†ä¸‰ä»¶äº‹æƒ…:</p><ul><li>1ï¼‰è®©å®ä¾‹å¯ä»¥è®¿é—®åˆ°ç§æœ‰å±æ€§</li><li>2ï¼‰è®©å®ä¾‹å¯ä»¥è®¿é—®æ„é€ å‡½æ•°åŸå‹(constructor.prototype)æ‰€åœ¨åŸå‹é“¾ä¸Šçš„å±æ€§</li><li>3ï¼‰å¦‚æœæ„é€ å‡½æ•°è¿”å›çš„ç»“æœä¸æ˜¯å¼•ç”¨æ•°æ®ç±»å‹</li></ul><p>å®ç°æ­¥éª¤ï¼š</p><ol><li>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡</li><li>è®¾ç½®åŸå‹ï¼Œå°†å¯¹è±¡çš„åŸå‹è®¾ç½®ä¸ºå‡½æ•°çš„ prototype å¯¹è±¡</li><li>è®©å‡½æ•°çš„ this æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œæ‰§è¡Œæ„é€ å‡½æ•°çš„ä»£ç </li><li>åˆ¤æ–­å‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼Œå¦‚æœæ˜¯å€¼ç±»å‹ï¼Œè¿”å›åˆ›å»ºçš„å¯¹è±¡ã€‚å¦‚æœæ˜¯å¼•ç”¨ç±»å‹ï¼Œå°±è¿”å›è¿™ä¸ªå¼•ç”¨ç±»å‹çš„å¯¹è±¡</li></ol><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> myNew</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">constructor</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±æŠ¥é”™</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">typeof</span><span style="color:#E06C75;"> constructor</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#98C379;"> &quot;myNew function the first param must be a function&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åŸºäºåŸå‹é“¾ åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œç»§æ‰¿æ„é€ å‡½æ•°constructorçš„åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> newObj</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">constructor</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å°†newObjä½œä¸ºthisï¼Œæ‰§è¡Œ constructor ï¼Œä¼ å…¥å‚æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> constructor</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">newObj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ¤æ–­å‡½æ•°çš„æ‰§è¡Œç»“æœæ˜¯å¦æ˜¯å¯¹è±¡ï¼Œtypeof null ä¹Ÿæ˜¯&#39;object&#39;æ‰€ä»¥è¦æ’é™¤null</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> isObject</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> typeof</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &quot;object&quot;</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> !==</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ¤æ–­å‡½æ•°çš„æ‰§è¡Œç»“æœæ˜¯å¦æ˜¯å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> isFunction</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> typeof</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &quot;function&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœå‡½æ•°çš„æ‰§è¡Œç»“æœæ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å‡½æ•°, åˆ™è¿”å›æ‰§è¡Œçš„ç»“æœ, å¦åˆ™, è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> isObject</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> isFunction</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> res</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> newObj</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç”¨æ³•</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> Person</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> name</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> age</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæ„é€ å‡½æ•°å†…éƒ¨ï¼Œreturn ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å¯¹è±¡ï¼Œåˆ™æ•´ä¸ªæ„é€ å‡½æ•°å¤±æ•ˆï¼Œè€Œæ˜¯è¿”å›è¿™ä¸ªå¼•ç”¨ç±»å‹çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">Person</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">say</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> p1</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> myNew</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">Person</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;poety&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">p1</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//poety</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//Person {name: &#39;poety&#39;, age: 18}</span></span>
<span class="line"><span style="color:#E5C07B;">p1</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">say</span><span style="color:#ABB2BF;">(); </span><span style="color:#7F848E;font-style:italic;">//18</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="`+p+`" alt="Snipaste_2024-02-02_09-52-15.png"></p><p>ç¬¬äºŒç§å®ç°</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> newOperator</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">ctor</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">typeof</span><span style="color:#E06C75;"> ctor</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &#39;function&#39;</span><span style="color:#ABB2BF;">){</span></span>
<span class="line"><span style="color:#C678DD;">    	throw</span><span style="color:#98C379;"> &#39;newOperator function the first param must be a function&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> obj</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">ctor</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> ctor</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> isObject</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> typeof</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;object&#39;</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> !==</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> isFunction</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> typoof</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;function&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E06C75;"> isObect</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> isFunction</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> res</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> obj</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å®ç° 3</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> myNew</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">fn</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> instance</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">fn</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> fn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">instance</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> typeof</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &quot;object&quot;</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> res</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> instance</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å®ç° 4</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> my_new</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">fn</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">arg</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// é¦–å…ˆåˆ›å»ºç©ºå¯¹è±¡</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> obj</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å°†ç©ºå¯¹è±¡çš„åŸå‹protoæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹prototype</span></span>
<span class="line"><span style="color:#E5C07B;">	Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setPrototypeOf</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">fn</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å°†thisæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå¹¶ä¸”æ‰§è¡Œæ„é€ å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> fn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arg</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ‰§è¡Œç»“æœæœ‰è¿”å›å€¼å¹¶ä¸”æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å›æ‰§è¡Œçš„ç»“æœï¼Œå¦ä¾§è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> result</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> Object</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> result</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> obj</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// éªŒè¯mu_newå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> Dog</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> name</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">say</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;my name is&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> dog</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> mu_new</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">Dog</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;å‚»ğŸ¶&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">dog</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">say</span><span style="color:#ABB2BF;">(); </span><span style="color:#7F848E;font-style:italic;">//my name iså‚»ğŸ¶</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç™½ <code>new</code> çš„åŸç†ã€‚å…³äº <code>new</code> çš„åŸç†ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p><ul><li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ ã€‚</li><li>ç”± <code>this</code> å˜é‡å¼•ç”¨è¯¥å¯¹è±¡ ã€‚</li><li>è¯¥å¯¹è±¡ç»§æ‰¿è¯¥å‡½æ•°çš„åŸå‹(æ›´æ”¹åŸå‹é“¾çš„æŒ‡å‘) ã€‚</li><li>æŠŠå±æ€§å’Œæ–¹æ³•åŠ å…¥åˆ° <code>this</code> å¼•ç”¨çš„å¯¹è±¡ä¸­ã€‚</li><li>æ–°åˆ›å»ºçš„å¯¹è±¡ç”± <code>this</code> å¼•ç”¨ ï¼Œæœ€åéšå¼åœ°è¿”å› <code>this</code></li></ul><p>æ˜ç™½äº†è¿™ä¸ªåŸç†åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•æ¥å®ç°ä¸€ä¸ª <code>new</code> æ–¹æ³•ï¼Œå‚è€ƒç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// æ„é€ å™¨å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#61AFEF;"> Parent</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    [</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">](</span><span style="color:#E06C75;">http</span><span style="color:#ABB2BF;">:</span><span style="color:#7F848E;font-style:italic;">//this.name) = name;</span></span>
<span class="line"><span style="color:#E5C07B;">    this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> age</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#E5C07B;">Parent</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sayName</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">([</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">](</span><span style="color:#E06C75;">http</span><span style="color:#ABB2BF;">:</span><span style="color:#7F848E;font-style:italic;">//this.name));</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// è‡ªå·±å®šä¹‰çš„newæ–¹æ³•</span></span>
<span class="line"><span style="color:#E06C75;">let</span><span style="color:#61AFEF;"> newMethod</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">Parent</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">rest</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 1.ä»¥æ„é€ å™¨çš„prototypeå±æ€§ä¸ºåŸå‹ï¼Œåˆ›å»ºæ–°å¯¹è±¡ï¼›</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> child</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Parent</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 2.å°†thiså’Œè°ƒç”¨å‚æ•°ä¼ ç»™æ„é€ å™¨æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Parent</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">child</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">rest</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 3.å¦‚æœæ„é€ å™¨æ²¡æœ‰æ‰‹åŠ¨è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›ç¬¬ä¸€æ­¥çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#C678DD;"> typeof</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;object&#39;</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> result</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> child</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// åˆ›å»ºå®ä¾‹ï¼Œå°†æ„é€ å‡½æ•°Parentä¸å½¢å‚ä½œä¸ºå‚æ•°ä¼ å…¥</span></span>
<span class="line"><span style="color:#E06C75;">const</span><span style="color:#E06C75;"> child</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> newMethod</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">Parent</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;echo&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">26</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sayName</span><span style="color:#ABB2BF;">() </span><span style="color:#7F848E;font-style:italic;">//&#39;echo&#39;;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æœ€åæ£€éªŒï¼Œä¸ä½¿ç”¨newçš„æ•ˆæœç›¸åŒ</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">child</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> Parent</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">//true</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hasOwnProperty</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;name&#39;</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;">//true</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hasOwnProperty</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;age&#39;</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;">//true</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hasOwnProperty</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;sayName&#39;</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;">//false</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="_2-callã€applyã€bind" tabindex="-1">2.callã€applyã€bind <a class="header-anchor" href="#_2-callã€applyã€bind" aria-label="Permalink to &quot;2.callã€applyã€bind&quot;">â€‹</a></h2><p><strong>call apply bind</strong></p><ul><li><a href="https://github.com/axuebin/articles/issues/7" target="_blank" rel="noreferrer">JavaScript åŸºç¡€å¿ƒæ³•â€”â€”call apply bind</a></li><li><a href="https://github.com/mqyqingfeng/Blog/issues/11" target="_blank" rel="noreferrer">JavaScript æ·±å…¥ä¹‹ call å’Œ apply çš„æ¨¡æ‹Ÿå®ç°</a></li><li><a href="https://github.com/mqyqingfeng/Blog/issues/12" target="_blank" rel="noreferrer">JavaScript æ·±å…¥ä¹‹ bind çš„æ¨¡æ‹Ÿå®ç°</a></li></ul><h3 id="å®ç°-call" tabindex="-1">å®ç° call <a class="header-anchor" href="#å®ç°-call" aria-label="Permalink to &quot;å®ç° call&quot;">â€‹</a></h3><p><strong>æ€è·¯</strong>ï¼šæ¥å—ä¼ å…¥çš„ context ä¸Šä¸‹æ–‡ï¼Œå¦‚æœä¸ä¼ é»˜è®¤ä¸º windowï¼Œå°†è¢«è°ƒç”¨çš„æ–¹æ³•è®¾ç½®ä¸ºä¸Šä¸‹æ–‡çš„å±æ€§ï¼Œä½¿ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œåˆ é™¤æ–°å¢å±æ€§ï¼Œè¿”å›ç»“æœã€‚</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å†™åœ¨å‡½æ•°çš„åŸå‹ä¸Š</span></span>
<span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœè¦è°ƒç”¨çš„æ–¹æ³•ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™æŠ¥é”™</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">typeof</span><span style="color:#E5C07B;"> this</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Error: this is not a function&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ¤æ–­ context æ˜¯å¦ä¼ å…¥,å¦‚æœæ²¡æœ‰ä¼ å°±è®¾ç½®ä¸º window</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è·å–å‚æ•°ï¼Œ[...arguments]æŠŠç±»æ•°ç»„è½¬ä¸ºæ•°ç»„</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> args</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [...</span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">slice</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å°†è¢«è°ƒç”¨çš„æ–¹æ³•è®¾ç½®ä¸ºcontextçš„å±æ€§,thiså³ä¸ºè¦è°ƒç”¨çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">	context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ‰§è¡Œè¦è¢«è°ƒç”¨çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#E06C75;">	result</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> context</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ é™¤æ‰‹åŠ¨å¢åŠ çš„å±æ€§æ–¹æ³•</span></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E5C07B;"> context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å°†æ‰§è¡Œç»“æœè¿”å›</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//æµ‹è¯•</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> f</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> b</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> obj</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">	name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;jack&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">add</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 3</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">add</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">null</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 3</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">add</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">undefined</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 3</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">add</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">window</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>å®ç° 2</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;fn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> args</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">		args</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;arguments[&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &quot;]&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> eval</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;context.fn(&quot;</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> args</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &quot;)&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E5C07B;"> context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>å®ç° 3</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°applyåªè¦æŠŠä¸‹ä¸€è¡Œä¸­çš„...argsæ¢æˆargså³å¯</span></span>
<span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> _that</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;fn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> _that</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">](...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// é‡ç‚¹ä»£ç ï¼Œåˆ©ç”¨thisæŒ‡å‘ï¼Œç›¸å½“äº</span></span>
<span class="line"><span style="color:#E5C07B;">	context</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">caller</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>ä¸è¿‡æˆ‘è®¤ä¸ºæ¢æˆ ES6 çš„è¯­æ³•ä¼šæ›´ç²¾ç‚¼ä¸€äº›ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;fn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> eval</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;context.fn(...args)&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E5C07B;"> context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> fnSymbol</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;fn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">](...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>å®ç° 4</p><p><strong>å®ç°æ­¥éª¤ï¼š</strong></p><ul><li>å¤„ç†è¾¹ç•Œï¼š <ul><li>å¯¹è±¡ä¸å­˜åœ¨ï¼Œthis æŒ‡å‘ windowï¼›</li></ul></li><li>å°†ã€Œè°ƒç”¨å‡½æ•°ã€<em>æŒ‚è½½åˆ°</em>ã€Œthis æŒ‡å‘çš„å¯¹è±¡ã€çš„ fn å±æ€§ä¸Šã€‚</li><li>æ‰§è¡Œã€Œthis æŒ‡å‘çš„å¯¹è±¡ã€ä¸Šçš„ fn å‡½æ•°ï¼Œå¹¶ä¼ å…¥å‚æ•°ï¼Œè¿”å›ç»“æœã€‚</li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">my_call</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//objä¸å­˜åœ¨æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ›é€ å”¯ä¸€çš„keyå€¼  ä½œä¸ºæˆ‘ä»¬æ„é€ çš„contextå†…éƒ¨æ–¹æ³•å</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//thisæŒ‡å‘è°ƒç”¨callçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ‰§è¡Œå‡½æ•°å¹¶è¿”å›ç»“æœ ç›¸å½“äºæŠŠè‡ªèº«ä½œä¸ºä¼ å…¥çš„contextçš„æ–¹æ³•è¿›è¡Œè°ƒç”¨äº†</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">](...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æµ‹è¯•</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> value</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> obj1</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">	value</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> bar</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> myObj</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		value</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">myObj</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#E5C07B;">bar</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">my_call</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">null</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//æ‰“å° 2 {name: undefined, age: undefined, value: 2}</span></span>
<span class="line"><span style="color:#E5C07B;">bar</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">my_call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj1</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;tom&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;110&quot;</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// æ‰“å° 1 {name: &quot;tom&quot;, age: &quot;110&quot;, value: 1}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="å®ç°-apply" tabindex="-1">å®ç° apply <a class="header-anchor" href="#å®ç°-apply" aria-label="Permalink to &quot;å®ç° apply&quot;">â€‹</a></h3><p><strong>æ€è·¯</strong>ï¼šé™¤äº†ä¼ å‚æ–¹å¼æ˜¯æ•°ç»„ï¼Œå…¶å®ƒä¸ call æ²¡åŒºåˆ«</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">typeof</span><span style="color:#E5C07B;"> this</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Type error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ä¸ä¸Šé¢ä»£ç ç›¸æ¯”ï¼Œæˆ‘ä»¬ä½¿ç”¨ Symbol æ¥ä¿è¯å±æ€§å”¯ä¸€,ä¹Ÿå°±æ˜¯ä¿è¯ä¸ä¼šé‡å†™ç”¨æˆ·è‡ªå·±åŸæ¥å®šä¹‰åœ¨ context ä¸­çš„åŒåå±æ€§</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> fnSymbol</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ‰§è¡Œè¦è¢«è°ƒç”¨çš„æ–¹æ³•,å¤„ç†å‚æ•°å’Œ call æœ‰åŒºåˆ«ï¼Œåˆ¤æ–­æ˜¯å¦ä¼ äº†å‚æ•°æ•°ç»„</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// ä¼ äº†å‚æ•°æ•°ç»„</span></span>
<span class="line"><span style="color:#E06C75;">		result</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">](...</span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æ²¡ä¼ å‚æ•°æ•°ç»„</span></span>
<span class="line"><span style="color:#E06C75;">		result</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">]();</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æµ‹è¯•</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> f</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> obj</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">	name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¼ ä¸‰&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#E5C07B;">f</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// 1 2, å¼ ä¸‰</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="`+o+`" alt="3.png"></p><p>å®ç° 2</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">	context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> eval</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;context.fn(...args)&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E5C07B;"> context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">argsArr</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> fnSymbol</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;fn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">](...</span><span style="color:#E06C75;">argsArr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>å®ç° 3</p><ul><li>ä¸ call ä¸€è‡´</li><li>åŒºåˆ«äºå‚æ•°çš„å½¢å¼</li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">my_apply</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// objä¸å­˜åœ¨æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> Window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#7F848E;font-style:italic;">// åˆ›é€ å”¯ä¸€çš„keyå€¼	ä½œä¸ºæˆ‘ä»¬æ„é€ çš„contextå†…éƒ¨æ–¹æ³•å</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">(); </span><span style="color:#7F848E;font-style:italic;">// thisæŒ‡å‘è°ƒç”¨callçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// æ‰§è¡Œå‡½æ•°å¹¶è¿”å›ç»“æœ	ç›¸å½“äºæŠŠè‡ªèº«ä½œä¸ºä¼ å…¥çš„contextçš„æ–¹æ³•è¿›è¡Œè°ƒç”¨äº†</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">](...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æµ‹è¯•</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> value</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> obj1</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> { </span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> };</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> bar</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> myObj</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> { </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;"> };</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">myObj</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#E5C07B;">bar</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">my_apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj1</span><span style="color:#ABB2BF;">, [</span><span style="color:#98C379;">&quot;tom&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;110&quot;</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// æ‰“å° 1   {name: &quot;tom&quot;, age:	&quot;110&quot;, value: 1}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="å®ç°-bind" tabindex="-1">å®ç° bind <a class="header-anchor" href="#å®ç°-bind" aria-label="Permalink to &quot;å®ç° bind&quot;">â€‹</a></h3><p><strong>å®ç° bind ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“å®ƒåšäº†å“ªäº›äº‹æƒ…ã€‚</strong></p><ul><li>1ï¼‰å¯¹äºæ™®é€šå‡½æ•°ï¼Œç»‘å®š this æŒ‡å‘</li><li>2ï¼‰å¯¹äºæ„é€ å‡½æ•°ï¼Œè¦ä¿è¯åŸå‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§ä¸èƒ½ä¸¢å¤±</li></ul><p><strong>æ€è·¯</strong>ï¼šbind è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œéœ€è¦åˆ¤æ–­å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°çš„æƒ…å†µï¼Œå½“ä½œä¸ºæ„é€ å‡½æ•°æ—¶ï¼Œthis æŒ‡å‘å®ä¾‹ï¼Œä¸ä¼šè¢«ä»»ä½•æ–¹å¼æ”¹å˜ thisï¼Œæ‰€ä»¥è¦å¿½ç•¥ä¼ å…¥çš„ context ä¸Šä¸‹æ–‡ã€‚</p><p>bind çš„ä½œç”¨ä¸ call å’Œ apply ç›¸åŒï¼ŒåŒºåˆ«æ˜¯ call å’Œ apply æ˜¯ç«‹å³è°ƒç”¨å‡½æ•°ï¼Œè€Œ bind æ˜¯è¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œéœ€è¦è°ƒç”¨çš„æ—¶å€™å†æ‰§è¡Œã€‚</p><p>bind å¯ä»¥åˆ†å¼€ä¼ é€’å‚æ•°ï¼Œæ‰€ä»¥éœ€è¦å°†å‚æ•°æ‹¼æ¥ã€‚å¦‚æœç»‘å®šçš„æ˜¯æ„é€ å‡½æ•°ï¼Œè¿˜éœ€è¦ç»§æ‰¿æ„é€ å‡½æ•°åŸå‹ä¸Šçš„å±æ€§å’Œæ–¹æ³•ï¼Œä¿è¯ä¸ä¸¢å¤±ã€‚</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myBind</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ¤æ–­è°ƒç”¨å¯¹è±¡æ˜¯å¦ä¸ºå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">typeof</span><span style="color:#E5C07B;"> this</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Type error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è·å–å‚æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> args</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [...</span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">slice</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// ä¿å­˜thisçš„å€¼ï¼Œä»£è¡¨è°ƒç”¨bindçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ­¤å‡½æ•°å¯ä»¥è¢«ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#61AFEF;"> Fn</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æ ¹æ®è°ƒç”¨æ–¹å¼ï¼Œä¼ å…¥ä¸åŒç»‘å®šå€¼</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å½“ä½œä¸ºæ„é€ å‡½æ•°æ—¶,this æŒ‡å‘å®ä¾‹ï¼Œä¸ä¼šè¢«ä»»ä½•æ–¹å¼æ”¹å˜ thisï¼Œè¦å¿½ç•¥ä¼ å…¥çš„contextä¸Šä¸‹æ–‡</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E5C07B;"> fn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">			this</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> Fn</span><span style="color:#C678DD;"> ?</span><span style="color:#E5C07B;"> this</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// bindå¯ä»¥åˆ†å¼€ä¼ é€’å‚æ•°(å¦‚f.bind(obj, 1)(2))ï¼Œæ‰€ä»¥éœ€è¦å°†å‚æ•°æ‹¼æ¥ï¼Œè¿™é‡Œä½¿ç”¨applyï¼Œå‚æ•°æ‹¼æ¥æˆä¸€ä¸ªæ•°ç»„</span></span>
<span class="line"><span style="color:#E5C07B;">			args</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(...</span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">//å½“å‰çš„è¿™ä¸ª arguments æ˜¯æŒ‡ Fn çš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥ç”¨å‰©ä½™å‚æ•°çš„æ–¹å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">		);</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//å¯¹äºæ„é€ å‡½æ•°ï¼Œè¦ä¿è¯åŸå‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§ä¸èƒ½ä¸¢å¤±</span></span>
<span class="line"><span style="color:#E5C07B;">	Fn</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">fn</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> Fn</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 1.å…ˆæµ‹è¯•ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> Person</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//æ„é€ å‡½æ•°thisæŒ‡å‘å®ä¾‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ„é€ å‡½æ•°åŸå‹çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Person</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">say</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;say&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> obj</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">	name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;cc&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">	age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> bindFun</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Person</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myBind</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;cxx&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> a</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> bindFun</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// cxx</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 10</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Person {}</span></span>
<span class="line"><span style="color:#E5C07B;">a</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">say</span><span style="color:#ABB2BF;">(); </span><span style="color:#7F848E;font-style:italic;">// say</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 2.å†æµ‹è¯•ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> normalFun</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// æ™®é€šå‡½æ•°thisæŒ‡å‘ç»‘å®šbindçš„ç¬¬ä¸€ä¸ªå‚æ•° ä¹Ÿå°±æ˜¯ä¾‹å­ä¸­çš„obj</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> obj</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">	name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;aa&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">	age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> bindNormalFun</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> normalFun</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myBind</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;cc&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">bindNormalFun</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// cc</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 12</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// { name: &#39;aa&#39;, age: 18 }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="`+e+`" alt="4.png"></p><p>å®ç° 2</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">bind</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // å¼‚å¸¸å¤„ç†</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">typeof</span><span style="color:#E5C07B;"> this</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">        throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Function.prototype.bind - what is trying to be bound i</span><span style="color:#FFFFFF;">s</span></span>
<span class="line"><span style="color:#E06C75;">        not</span><span style="color:#E06C75;"> callable</span><span style="color:#98C379;">&quot;)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // ä¿å­˜thisçš„å€¼ï¼Œå®ƒä»£è¡¨è°ƒç”¨ bind çš„å‡½æ•°</span></span>
<span class="line"><span style="color:#E06C75;">    var</span><span style="color:#E06C75;"> self</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">    var</span><span style="color:#61AFEF;"> fNOP</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {};</span></span>
<span class="line"><span style="color:#E06C75;">    var</span><span style="color:#61AFEF;"> fbound</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> self</span><span style="color:#C678DD;"> ?</span></span>
<span class="line"><span style="color:#E5C07B;">        this</span><span style="color:#C678DD;"> :</span></span>
<span class="line"><span style="color:#E06C75;">        context</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">args</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">slice</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">)));</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#E5C07B;">    fNOP</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">    fbound</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> fNOP</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">    return</span><span style="color:#E06C75;"> fbound</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>å®ç° 3</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">bind</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> self</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// è°¨è®°thisè¡¨ç¤ºè°ƒç”¨bindçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#61AFEF;"> fBound</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// this instanceof fBoundä¸ºtrueè¡¨ç¤ºæ„é€ å‡½æ•°çš„æƒ…å†µã€‚å¦‚new func.bind(obj)</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E5C07B;"> self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E5C07B;">			this</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> fBound</span><span style="color:#C678DD;"> ?</span><span style="color:#E5C07B;"> this</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E5C07B;">			args</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">slice</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">		);</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ä¿è¯åŸå‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§ä¸ä¸¢å¤±</span></span>
<span class="line"><span style="color:#E5C07B;">	fBound</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> fBound</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">bind</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> fnSymbol</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;fn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (...</span><span style="color:#E06C75;font-style:italic;">_args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		args</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> args</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">		context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">](...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		delete</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fnSymbol</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>ä¹Ÿå¯ä»¥ç”¨ Object.create æ¥å¤„ç†åŸå‹ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">bind</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">typeof</span><span style="color:#E5C07B;"> this</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">        throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Function.prototype.bind - what is trying to be bound i</span><span style="color:#FFFFFF;">s</span></span>
<span class="line"><span style="color:#E06C75;">        not</span><span style="color:#E06C75;"> callable</span><span style="color:#98C379;">&quot;)</span><span style="color:#FFFFFF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#E06C75;">    var</span><span style="color:#E06C75;"> self</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">    var</span><span style="color:#61AFEF;"> fbound</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">        self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> self</span><span style="color:#C678DD;"> ?</span></span>
<span class="line"><span style="color:#E5C07B;">        this</span><span style="color:#C678DD;"> :</span></span>
<span class="line"><span style="color:#E06C75;">        context</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">args</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">concat</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">slice</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">)));</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#E5C07B;">    fbound</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">    return</span><span style="color:#E06C75;"> fbound</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>å®ç° 4</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">my_bind</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">context</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> context</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		context</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#7F848E;font-style:italic;">// åˆ›é€ å”¯ä¸€çš„keyå€¼	ä½œä¸ºæˆ‘ä»¬æ„é€ çš„contextå†…éƒ¨æ–¹æ³•å</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Symbol</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">	context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> _this</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// bindæƒ…å†µè¦å¤æ‚ä¸€ç‚¹</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#61AFEF;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (...</span><span style="color:#E06C75;font-style:italic;">innerArgs</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//	ç¬¬ä¸€ç§æƒ…å†µ :è‹¥æ˜¯å°† bind ç»‘å®šä¹‹åçš„å‡½æ•°å½“ä½œæ„é€ å‡½æ•°ï¼Œé€šè¿‡ new	æ“ä½œç¬¦ä½¿ç”¨ï¼Œåˆ™ä¸ç»‘å®šä¼ å…¥çš„ thisï¼Œè€Œæ˜¯å°† this æŒ‡å‘å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// 	æ­¤æ—¶ç”±äºnewæ“ä½œç¬¦ä½œç”¨ thisæŒ‡å‘resultå®ä¾‹å¯¹è±¡ è€Œresultåˆç»§æ‰¿è‡ªä¼ å…¥çš„_this	æ ¹æ®åŸå‹é“¾çŸ¥è¯†å¯å¾—å‡ºä»¥ä¸‹ç»“è®º</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// this.__proto__ === result.prototype</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//this	instanceof result =&gt;true</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// this.__proto__.__proto__ ===</span></span>
<span class="line"><span style="color:#E5C07B;">		result</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__proto__</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> _this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// this instanceof _this =&gt;true</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">this</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> _this</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// æ­¤æ—¶thisæŒ‡å‘æŒ‡å‘resultçš„å®ä¾‹	è¿™æ—¶å€™ä¸éœ€è¦æ”¹å˜thisæŒ‡å‘</span></span>
<span class="line"><span style="color:#E5C07B;">			this</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> _this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">			this</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">](...[...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;">innerArgs</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			//è¿™é‡Œä½¿ç”¨es6çš„æ–¹æ³•è®©bindæ”¯æŒå‚æ•°åˆå¹¶</span></span>
<span class="line"><span style="color:#C678DD;">			delete</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">		} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			//	å¦‚æœåªæ˜¯ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨ é‚£å°±å¾ˆç®€å•äº† ç›´æ¥æ”¹å˜thisæŒ‡å‘ä¸ºä¼ å…¥çš„context</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">			context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">](...[...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;">innerArgs</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#C678DD;">			delete</span><span style="color:#E06C75;"> context</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//	å¦‚æœç»‘å®šçš„æ˜¯æ„é€ å‡½æ•° é‚£ä¹ˆéœ€è¦ç»§æ‰¿æ„é€ å‡½æ•°åŸå‹å±æ€§å’Œæ–¹æ³•</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å®ç°ç»§æ‰¿çš„æ–¹å¼:	ä½¿ç”¨Object.create</span></span>
<span class="line"><span style="color:#E5C07B;">	result</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">	result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> Person</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//&#39;æˆ‘æ˜¯å‚æ•°ä¼ è¿›æ¥çš„name&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//&#39;æˆ‘æ˜¯å‚æ•°ä¼ è¿›æ¥çš„age&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//æ„é€ å‡½æ•°thisæŒ‡å‘å®ä¾‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ„é€ å‡½æ•°åŸå‹çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Person</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">say</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">123</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}; </span><span style="color:#7F848E;font-style:italic;">// æ™®é€šå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> normalFun</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//&#39;æˆ‘æ˜¯å‚æ•°ä¼ è¿›æ¥çš„name&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//&#39;æˆ‘æ˜¯å‚æ•°ä¼ è¿›æ¥çš„age&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//æ™®é€šå‡½æ•°thisæŒ‡å‘ç»‘å®šbindçš„ç¬¬ä¸€ä¸ªå‚æ•° ä¹Ÿå°±æ˜¯ä¾‹å­ä¸­çš„obj</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">objName</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//&#39;æˆ‘æ˜¯objä¼ è¿›æ¥çš„name&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">objAge</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//&#39;æˆ‘æ˜¯objä¼ è¿›æ¥çš„age&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> obj</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> { </span><span style="color:#E06C75;">objName</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æˆ‘æ˜¯objä¼ è¿›æ¥çš„name&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">objAge</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æˆ‘æ˜¯objä¼ è¿›æ¥çš„age&quot;</span><span style="color:#ABB2BF;"> };</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å…ˆæµ‹è¯•ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// let bindFun =	Person.my_bind(obj, &#39;æˆ‘æ˜¯å‚æ•°ä¼ è¿›æ¥çš„name&#39;);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// let a = newbindFun(&#39;æˆ‘æ˜¯å‚æ•°ä¼ è¿›æ¥çš„age&#39;);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// a.say();</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 123</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å†æµ‹è¯•ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨a;</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> bindFun</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> normalFun</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">my_bind</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;æˆ‘æ˜¯å‚æ•°ä¼ è¿›æ¥çš„name&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">bindFun</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æˆ‘æ˜¯å‚æ•°ä¼ è¿›æ¥çš„age&quot;</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h2 id="_3-æ‰‹å†™å®ç°-instanceof" tabindex="-1">3.æ‰‹å†™å®ç° instanceof <a class="header-anchor" href="#_3-æ‰‹å†™å®ç°-instanceof" aria-label="Permalink to &quot;3.æ‰‹å†™å®ç° instanceof&quot;">â€‹</a></h2><h3 id="instanceof-çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆ" tabindex="-1">instanceof çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆ <a class="header-anchor" href="#instanceof-çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆ" aria-label="Permalink to &quot;instanceof çš„ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆ&quot;">â€‹</a></h3><p><strong>ä¼˜ç¼ºç‚¹ï¼š</strong></p><ul><li><strong>ã€Œä¼˜ç‚¹ã€</strong>ï¼šèƒ½å¤ŸåŒºåˆ† Arrayã€Object å’Œ Functionï¼Œé€‚åˆç”¨äºåˆ¤æ–­è‡ªå®šä¹‰çš„ç±»å®ä¾‹å¯¹è±¡</li><li><strong>ã€Œç¼ºç‚¹ã€</strong>ï¼šNumberï¼ŒBooleanï¼ŒString åŸºæœ¬æ•°æ®ç±»å‹ä¸èƒ½åˆ¤æ–­</li></ul><p><strong>å®ç°æ­¥éª¤ï¼š</strong></p><ul><li>ä¼ å…¥å‚æ•°ä¸ºå·¦ä¾§çš„å®ä¾‹ Lï¼Œå’Œå³ä¾§çš„æ„é€ å‡½æ•° R</li><li>å¤„ç†è¾¹ç•Œï¼Œå¦‚æœè¦æ£€æµ‹å¯¹è±¡ä¸ºåŸºæœ¬ç±»å‹åˆ™è¿”å› false</li><li>åˆ†åˆ«å–ä¼ å…¥å‚æ•°çš„åŸå‹</li><li>åˆ¤æ–­å·¦ä¾§çš„åŸå‹æ˜¯å¦å–åˆ°äº† nullï¼Œå¦‚æœæ˜¯ null è¿”å› falseï¼›å¦‚æœä¸¤ä¾§åŸå‹ç›¸ç­‰ï¼Œè¿”å› trueï¼Œå¦åˆ™ç»§ç»­å–å·¦ä¾§åŸå‹çš„åŸå‹ã€‚</li></ul><h3 id="æ ¸å¿ƒå®ç°è¦ç‚¹-åŸå‹é“¾çš„å‘ä¸ŠæŸ¥æ‰¾ã€‚" tabindex="-1">æ ¸å¿ƒå®ç°è¦ç‚¹ï¼šåŸå‹é“¾çš„å‘ä¸ŠæŸ¥æ‰¾ã€‚ <a class="header-anchor" href="#æ ¸å¿ƒå®ç°è¦ç‚¹-åŸå‹é“¾çš„å‘ä¸ŠæŸ¥æ‰¾ã€‚" aria-label="Permalink to &quot;æ ¸å¿ƒå®ç°è¦ç‚¹ï¼šåŸå‹é“¾çš„å‘ä¸ŠæŸ¥æ‰¾ã€‚&quot;">â€‹</a></h3><p>instanceof ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚</p><p>instanceof åˆ¤æ–­çš„æ˜¯å³æ“ä½œæ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨å·¦æ“ä½œæ•°çš„åŸå‹é“¾ä¸Šã€‚æ ¸å¿ƒæ˜¯è¦æ‹¿åˆ°å·¦æ“ä½œæ•°çš„åŸå‹è¿›è¡Œæ£€æŸ¥ï¼Œè¦é¡ºç€åŸå‹é“¾æ£€æŸ¥ã€‚å–å¾—åŸå‹æ˜¯åˆ©ç”¨äº† Object.getPrototypeOf(obj)ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> myInstanceof</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">instance</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">constructor</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœä¸æ˜¯å¯¹è±¡ï¼Œæˆ–è€…æ˜¯nullï¼Œç›´æ¥è¿”å›false</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">typeof</span><span style="color:#E06C75;"> instance</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;object&quot;</span><span style="color:#56B6C2;"> ||</span><span style="color:#E06C75;"> instance</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±æŠ¥é”™</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">typeof</span><span style="color:#E06C75;"> constructor</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#98C379;"> &quot;myInstanceof function the first param must be a function&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è·å–å¯¹è±¡çš„åŸå‹</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> proto</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getPrototypeOf</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">instance</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è·å–æ„é€ å‡½æ•°çš„ prototype å¯¹è±¡</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> constructor</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ¤æ–­æ„é€ å‡½æ•°çš„ prototypeå¯¹è±¡æ˜¯å¦åœ¨å¯¹è±¡çš„åŸå‹é“¾ä¸Š</span></span>
<span class="line"><span style="color:#C678DD;">	while</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// åˆ°è¾¾åŸå‹é“¾ç»ˆç‚¹nullï¼Œè¯´æ˜æ²¡æ‰¾åˆ°</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">proto</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			return</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">proto</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> prototype</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			return</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ç»§ç»­ä»å…¶åŸå‹ä¸Šæ‰¾</span></span>
<span class="line"><span style="color:#E06C75;">		proto</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getPrototypeOf</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">proto</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æµ‹è¯•</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#61AFEF;"> Fn</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {};</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> p1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Fn</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">myInstanceof</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">Fn</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// true</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">myInstanceof</span><span style="color:#ABB2BF;">([], </span><span style="color:#E06C75;">Fn</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// false</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">myInstanceof</span><span style="color:#ABB2BF;">([], </span><span style="color:#E06C75;">Array</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// true</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">myInstanceof</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {}, </span><span style="color:#E06C75;">Function</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="`+t+`" alt="5.png"></p><p>ç®€å•ç‰ˆ</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> instanceof</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">left</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">right</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // è·å¾—ç±»å‹çš„åŸå‹</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> right</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // è·å¾—å¯¹è±¡çš„åŸå‹</span></span>
<span class="line"><span style="color:#E06C75;">    left</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> left</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__proto__</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // åˆ¤æ–­å¯¹è±¡çš„ç±»å‹æ˜¯å¦ç­‰äºç±»å‹çš„åŸå‹</span></span>
<span class="line"><span style="color:#C678DD;">    while</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">left</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> false</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> left</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> true</span></span>
<span class="line"><span style="color:#E06C75;">        left</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> left</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__proto__</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>å®ç° 3</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> myInstanceof</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">left</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">right</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> proto</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getPrototypeOf</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">left</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	while</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">proto</span><span style="color:#56B6C2;"> ==</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">proto</span><span style="color:#56B6C2;"> ==</span><span style="color:#E5C07B;"> right</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">		proto</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getPrototypeof</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">proto</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å®ç° 4</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// ä¼ å…¥å‚æ•°å·¦ä¾§ä¸ºå®ä¾‹L, å³ä¾§ä¸ºæ„é€ å‡½æ•°R</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> mu_instanceof</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">L</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">R</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¤„ç†è¾¹ç•Œï¼šæ£€æµ‹å®ä¾‹ç±»å‹æ˜¯å¦ä¸ºåŸå§‹ç±»å‹</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> baseTypes</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&quot;string&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;number&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;boolean&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;symbol&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;undefined&quot;</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">baseTypes</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">includes</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">typeof</span><span style="color:#E5C07B;"> L</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#E5C07B;"> L</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ†åˆ«å–ä¼ å…¥å‚æ•°çš„åŸå‹</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> Lp</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> L</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__proto__</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> Rp</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> R</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‡½æ•°æ‰æ‹¥æœ‰prototypeå±æ€§</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ¤æ–­åŸå‹</span></span>
<span class="line"><span style="color:#C678DD;">	while</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">Lp</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">Lp</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> Rp</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">		Lp</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Lp</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__proto__</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// éªŒè¯</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> isArray</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> mu_instanceof</span><span style="color:#ABB2BF;">([], </span><span style="color:#E06C75;">Array</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">isArray</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// true const</span></span>
<span class="line"><span style="color:#E06C75;">isDate</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> mu_instanceof</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;2023-01-09&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">Date</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">isDate</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// false</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="intanceof-æ“ä½œç¬¦çš„å®ç°åŸç†åŠå®ç°" tabindex="-1"><code>intanceof</code> æ“ä½œç¬¦çš„å®ç°åŸç†åŠå®ç° <a class="header-anchor" href="#intanceof-æ“ä½œç¬¦çš„å®ç°åŸç†åŠå®ç°" aria-label="Permalink to &quot;\`intanceof\` æ“ä½œç¬¦çš„å®ç°åŸç†åŠå®ç°&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆï¼š</p><p><code>instanceof</code> ä¸»è¦ä½œç”¨å°±æ˜¯åˆ¤æ–­ä¸€ä¸ªå®ä¾‹æ˜¯å¦å±äºæŸç§ç±»å‹</p><p>ä¾‹å¦‚ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#61AFEF;"> Dog</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {};</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> tidy</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Dog</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">tidy</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> Dog</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">//true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>intanceof</code> æ“ä½œç¬¦å®ç°åŸç†</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> wonderFulInstanceOf</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">instance</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">constructorFn</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> constructorFnProto</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> constructorFn</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å–å³è¡¨è¾¾å¼çš„ prototype å€¼ï¼Œå‡½æ•°æ„é€ å™¨æŒ‡å‘çš„function</span></span>
<span class="line"><span style="color:#E06C75;">	instanceProto</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> instance</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__proto__</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å–å·¦è¡¨è¾¾å¼çš„__proto__å€¼ï¼Œå®ä¾‹çš„__proto__</span></span>
<span class="line"><span style="color:#C678DD;">	while</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">instanceProto</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			return</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">instanceProto</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> constructorFnProto</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			return</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#E06C75;">		instanceProto</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> instanceProto</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__proto__</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>å…¶å® <code>instanceof</code> ä¸»è¦çš„å®ç°åŸç†å°±æ˜¯åªè¦ <code>constructorFn</code> çš„ <code>prototype</code> åœ¨<em>instance</em>çš„åŸå‹é“¾ä¸Šå³å¯ã€‚</p><p>å› æ­¤ï¼Œ<code>instanceof</code> åœ¨æŸ¥æ‰¾çš„è¿‡ç¨‹ä¸­ä¼šéå†å·¦è¾¹å˜é‡çš„åŸå‹é“¾ï¼Œç›´åˆ°æ‰¾åˆ°å³è¾¹å˜é‡çš„ <code>prototype</code>ï¼Œå¦‚æœæŸ¥æ‰¾å¤±è´¥ï¼Œåˆ™ä¼šè¿”å› <code>false</code>ï¼Œå‘Šè¯‰æˆ‘ä»¬å·¦è¾¹å˜é‡å¹¶éæ˜¯å³è¾¹å˜é‡çš„å®ä¾‹ã€‚</p><h2 id="_4-å®ç°æ•°ç»„æ–¹æ³•" tabindex="-1">4.å®ç°æ•°ç»„æ–¹æ³• <a class="header-anchor" href="#_4-å®ç°æ•°ç»„æ–¹æ³•" aria-label="Permalink to &quot;4.å®ç°æ•°ç»„æ–¹æ³•&quot;">â€‹</a></h2><h3 id="æ•°ç»„-sort-æ’åº" tabindex="-1">æ•°ç»„ sort æ’åº <a class="header-anchor" href="#æ•°ç»„-sort-æ’åº" aria-label="Permalink to &quot;æ•°ç»„ sort æ’åº&quot;">â€‹</a></h3><h4 id="sort-æ’åº" tabindex="-1">sort æ’åº <a class="header-anchor" href="#sort-æ’åº" aria-label="Permalink to &quot;sort æ’åº&quot;">â€‹</a></h4><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å¯¹æ•°å­—è¿›è¡Œæ’åºï¼Œç®€å†™</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sort</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E06C75;"> a</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> b</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// [1, 2, 3, 4, 5]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å¯¹å­—æ¯è¿›è¡Œæ’åº</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&quot;b&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;c&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;a&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;e&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;d&quot;</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sort</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">a</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E06C75;"> b</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">a</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> b</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	else</span><span style="color:#C678DD;"> return</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="`+r+`" alt="Snipaste_2024-02-20_16-50-16.png"></p><h3 id="å†’æ³¡æ’åº" tabindex="-1">å†’æ³¡æ’åº <a class="header-anchor" href="#å†’æ³¡æ’åº" aria-label="Permalink to &quot;å†’æ³¡æ’åº&quot;">â€‹</a></h3><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> bubbleSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ¯”è¾ƒç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ ï¼Œå‰è€…å¤§å°±äº¤æ¢ä½ç½®</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> j</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">&gt;</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">]) {</span></span>
<span class="line"><span style="color:#C678DD;">				let</span><span style="color:#E06C75;"> num</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">				arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">				arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> num</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æ¯æ¬¡éå†ç»“æŸï¼Œéƒ½èƒ½æ‰¾åˆ°ä¸€ä¸ªæœ€å¤§å€¼ï¼Œæ”¾åœ¨æ•°ç»„æœ€å</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æµ‹è¯•</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">bubbleSort</span><span style="color:#ABB2BF;">([</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">])); </span><span style="color:#7F848E;font-style:italic;">// [ 1, 2, 3, 4, 5 ]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="`+c+`" alt="Snipaste_2024-02-20_16-50-59.png"></p><h3 id="æ‰‹å†™-reduce" tabindex="-1">æ‰‹å†™ reduce <a class="header-anchor" href="#æ‰‹å†™-reduce" aria-label="Permalink to &quot;æ‰‹å†™ reduce&quot;">â€‹</a></h3><h4 id="reduce-çš„ä½¿ç”¨" tabindex="-1">reduce çš„ä½¿ç”¨ <a class="header-anchor" href="#reduce-çš„ä½¿ç”¨" aria-label="Permalink to &quot;reduce çš„ä½¿ç”¨&quot;">â€‹</a></h4><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// æ™®é€šæ•°ç»„æ±‚å’Œ</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">9</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reduce</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">prev</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">cur</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> prev</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> cur</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 55</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å¤šç»´æ•°ç»„æ±‚å’Œ</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, [[</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">], </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">], </span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">9</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">flat</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">Infinity</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">reduce</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">prev</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">cur</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> prev</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> cur</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 45</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å¯¹è±¡æ•°ç»„æ±‚å’Œ</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [{ </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">9</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">c</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;"> }, { </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;"> }, { </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;"> }];</span></span>
<span class="line"><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reduce</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">prev</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">cur</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> prev</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> cur</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&quot;a&quot;</span><span style="color:#ABB2BF;">]; </span><span style="color:#7F848E;font-style:italic;">// 13 æ±‚å¯¹è±¡æ•°ç»„ä¸­æ‰€æœ‰å±æ€§ä¸ºaçš„å’Œ</span></span>
<span class="line"><span style="color:#ABB2BF;">}, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="reduce-çš„å®ç°" tabindex="-1">reduce çš„å®ç° <a class="header-anchor" href="#reduce-çš„å®ç°" aria-label="Permalink to &quot;reduce çš„å®ç°&quot;">â€‹</a></h4><p>æ ¸å¿ƒè¦ç‚¹ï¼š</p><ul><li>1ï¼‰åˆå§‹å€¼ä¸ä¼ æ€ä¹ˆå¤„ç†</li><li>2ï¼‰å›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å“ªäº›ï¼Œè¿”å›å€¼å¦‚ä½•å¤„ç†ã€‚</li></ul><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myReduce</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">initialValue</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// thiså°±æ˜¯è°ƒç”¨reduceæ–¹æ³•çš„æ•°ç»„</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> total</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> initialValue</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> initialValue</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">]; </span><span style="color:#7F848E;font-style:italic;">// ä¸ä¼ é»˜è®¤å–æ•°ç»„ç¬¬ä¸€é¡¹</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> initialValue</span><span style="color:#C678DD;"> ?</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> :</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// æœ‰åˆå§‹å€¼çš„è¯ä»0éå†ï¼Œå¦åˆ™ä»1éå†</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		total</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> cb</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">total</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// å‚æ•°ä¸ºåˆå§‹å€¼ã€å½“å‰å€¼ã€ç´¢å¼•ã€å½“å‰æ•°ç»„</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> total</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æµ‹è¯•</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">9</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myReduce</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">total</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">cur</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> total</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> cur</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 55</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å®ç° 2</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myReduce</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">fn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">initialValue</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">slice</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">	res</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> initialValue</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> initialValue</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">	startIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> initialValue</span><span style="color:#C678DD;"> ?</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> :</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> fn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">null</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°3</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myReduce</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> isInit</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> args</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> init</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> args</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> isInit</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> init</span><span style="color:#C678DD;"> :</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> index</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> isInit</span><span style="color:#C678DD;"> ?</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> :</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> index</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		res</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> cb</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="å®ç°æ•°ç»„-foreach-æ–¹æ³•" tabindex="-1">å®ç°æ•°ç»„ forEach æ–¹æ³• <a class="header-anchor" href="#å®ç°æ•°ç»„-foreach-æ–¹æ³•" aria-label="Permalink to &quot;å®ç°æ•°ç»„ forEach æ–¹æ³•&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°forEachæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myForEach</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å›è°ƒå‡½æ•°applyè°ƒç”¨ï¼ŒthisæŒ‡å‘æ›´æ”¹æˆå‰©ä½™å‚æ•°_arg2æˆ–è€…window</span></span>
<span class="line"><span style="color:#E5C07B;">		cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// applyçš„ç¬¬äºŒä¸ªå‚æ•°æ•°ç»„é‡Œé¢çš„ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="å®ç°-map-æ–¹æ³•" tabindex="-1">å®ç° map æ–¹æ³• <a class="header-anchor" href="#å®ç°-map-æ–¹æ³•" aria-label="Permalink to &quot;å®ç° map æ–¹æ³•&quot;">â€‹</a></h3><h4 id="ç”¨-es5-å®ç°æ•°ç»„çš„-map-æ–¹æ³•" tabindex="-1">ç”¨ ES5 å®ç°æ•°ç»„çš„ map æ–¹æ³• <a class="header-anchor" href="#ç”¨-es5-å®ç°æ•°ç»„çš„-map-æ–¹æ³•" aria-label="Permalink to &quot;ç”¨ ES5 å®ç°æ•°ç»„çš„ map æ–¹æ³•&quot;">â€‹</a></h4><p>æ ¸å¿ƒè¦ç‚¹ï¼š</p><p>1ï¼‰å›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å“ªäº›ï¼Œè¿”å›å€¼å¦‚ä½•å¤„ç†ã€‚ 2ï¼‰ä¸ä¿®æ”¹åŸæ¥çš„æ•°ç»„ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyMap</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">fn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">slice</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//ç”±äºæ˜¯ES5æ‰€ä»¥å°±ä¸ç”¨...å±•å¼€ç¬¦äº†</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> mappedArr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">		mappedArr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">fn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">context</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> mappedArr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="ç¬¬äºŒç§" tabindex="-1">ç¬¬äºŒç§ <a class="header-anchor" href="#ç¬¬äºŒç§" aria-label="Permalink to &quot;ç¬¬äºŒç§&quot;">â€‹</a></h5><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°mapæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myMap</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _newArr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _item</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		_item</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// ç»“åˆä¸Šé¢çš„æ·±æ‹·è´æ–¹æ³•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å›è°ƒå‡½æ•°applyè°ƒç”¨ï¼ŒthisæŒ‡å‘æ›´æ”¹æˆå‰©ä½™å‚æ•°_arg2æˆ–è€…window</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// applyçš„ç¬¬äºŒä¸ªå‚æ•°æ•°ç»„é‡Œé¢çš„ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</span></span>
<span class="line"><span style="color:#E06C75;">		_res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">		_res</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E5C07B;"> _newArr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_res</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// æ˜¯å¦æœ‰è¿”å›å€¼æ‰æ‰§è¡Œpush</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> _newArr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="å®ç°-filter-æ–¹æ³•" tabindex="-1">å®ç° filter æ–¹æ³• <a class="header-anchor" href="#å®ç°-filter-æ–¹æ³•" aria-label="Permalink to &quot;å®ç° filter æ–¹æ³•&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°filteræ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myFilter</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _newArr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _item</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		_item</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// æ·±æ‹·è´</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å›è°ƒå‡½æ•°applyè°ƒç”¨ï¼ŒthisæŒ‡å‘æ›´æ”¹æˆå‰©ä½™å‚æ•°_arg2æˆ–è€…window</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// applyçš„ç¬¬äºŒä¸ªå‚æ•°æ•°ç»„é‡Œé¢çš„ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">		cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]) </span><span style="color:#C678DD;">?</span><span style="color:#E5C07B;"> _newArr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">:</span><span style="color:#98C379;"> &quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> _newArr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="å®ç°-evey-æ–¹æ³•" tabindex="-1">å®ç° evey æ–¹æ³• <a class="header-anchor" href="#å®ç°-evey-æ–¹æ³•" aria-label="Permalink to &quot;å®ç° evey æ–¹æ³•&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°everyæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myEvery</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _res</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">])) {</span></span>
<span class="line"><span style="color:#E06C75;">			_res</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> _res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="å®ç°-some-æ–¹æ³•" tabindex="-1">å®ç° some æ–¹æ³• <a class="header-anchor" href="#å®ç°-some-æ–¹æ³•" aria-label="Permalink to &quot;å®ç° some æ–¹æ³•&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°someæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">mySome</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _res</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">])) {</span></span>
<span class="line"><span style="color:#E06C75;">			_res</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> _res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="å®ç°-reduce-ä¸-reduceright-æ–¹æ³•" tabindex="-1">å®ç° reduce ä¸ reduceRight æ–¹æ³• <a class="header-anchor" href="#å®ç°-reduce-ä¸-reduceright-æ–¹æ³•" aria-label="Permalink to &quot;å®ç° reduce ä¸ reduceRight æ–¹æ³•&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°reduceæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myReduce</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">initialValue</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæœ‰ç¬¬ä¸‰ä¸ªå‚æ•°å°±æŒ‡å‘å®ƒï¼Œæ²¡æœ‰å°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg3</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _item</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		_item</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// æ·±å…‹éš†</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æŒ‡å‘_arg3</span></span>
<span class="line"><span style="color:#E06C75;">		initialValue</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg3</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">initialValue</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> initialValue</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°reduceRightæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myReduceRight</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">initialValue</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæœ‰ç¬¬ä¸‰ä¸ªå‚æ•°å°±æŒ‡å‘å®ƒï¼Œæ²¡æœ‰å°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg3</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _item</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å€’å™æ’å…¥</span></span>
<span class="line"><span style="color:#E06C75;">		_item</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// æ·±å…‹éš†</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æŒ‡å‘_arg3çš„thisï¼Œå¹¶ä¼ å››ä¸ªå‚æ•°å›å»</span></span>
<span class="line"><span style="color:#E06C75;">		initialValue</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg3</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">initialValue</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> initialValue</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="æ‰€æœ‰çš„é‡å†™å®ç°æ•°ç»„æ–¹æ³•ç»ƒä¹ " tabindex="-1">æ‰€æœ‰çš„é‡å†™å®ç°æ•°ç»„æ–¹æ³•ç»ƒä¹  <a class="header-anchor" href="#æ‰€æœ‰çš„é‡å†™å®ç°æ•°ç»„æ–¹æ³•ç»ƒä¹ " aria-label="Permalink to &quot;æ‰€æœ‰çš„é‡å†™å®ç°æ•°ç»„æ–¹æ³•ç»ƒä¹ &quot;">â€‹</a></h3><p>index.htmlï¼š</p><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">&lt;!</span><span style="color:#E06C75;">DOCTYPE</span><span style="color:#D19A66;"> html</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">html</span><span style="color:#D19A66;"> lang</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;en&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">head</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		&lt;</span><span style="color:#E06C75;">meta</span><span style="color:#D19A66;"> charset</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;UTF-8&quot;</span><span style="color:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		&lt;</span><span style="color:#E06C75;">meta</span><span style="color:#D19A66;"> http-equiv</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;X-UA-Compatible&quot;</span><span style="color:#D19A66;"> content</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;IE=edge&quot;</span><span style="color:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		&lt;</span><span style="color:#E06C75;">meta</span><span style="color:#D19A66;"> name</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;viewport&quot;</span><span style="color:#D19A66;"> content</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;width=device-width, initial-scale=1.0&quot;</span><span style="color:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">		&lt;</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">&gt;jsçš„åº•å±‚æ–¹æ³•å®ç°&lt;/</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;/</span><span style="color:#E06C75;">head</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">script</span><span style="color:#D19A66;"> src</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;./utils.js&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">	&lt;</span><span style="color:#E06C75;">script</span><span style="color:#D19A66;"> src</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;./index.js&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">html</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>utils.jsï¼šé‡å†™å·¥å…·æ–¹æ³•</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// ES6å®ç°æ·±æ‹·è´</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">origin</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">hashMap</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> WeakMap</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">origin</span><span style="color:#56B6C2;"> ==</span><span style="color:#D19A66;"> undefined</span><span style="color:#56B6C2;"> ||</span><span style="color:#C678DD;"> typeof</span><span style="color:#E06C75;"> origin</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;object&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> origin</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæ˜¯æ—¶é—´æ„é€ å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">origin</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> Date</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Date</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">origin</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæ˜¯æ­£åˆ™æ„é€ å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">origin</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> RegExp</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> RegExp</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">origin</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ¤æ–­æ˜¯å¦å¼±å¼•ç”¨ï¼Œä¸¤ä¸ªå¯¹è±¡-ç›¸äº’æŠŠå¯¹æ–¹ä½œä¸ºé”®åèµ‹å€¼ç»™å¯¹æ–¹</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> hashKey</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> hashMap</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">origin</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">hashKey</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> hashKey</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ‰§è¡Œç»§æ‰¿æ¥çš„æ„é€ å™¨ï¼Œå®ä¾‹åŒ–æ„é€ å™¨å¾—åˆ°æ–°çš„å¯¹è±¡ï¼Œå°±ä¸ç”¨åˆ¤æ–­</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> target</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> origin</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">constructor</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è®¾ç½®å¼±å¼•ç”¨ï¼Œå¼•ç”¨åä¼šåˆ æ‰èŠ‚ç‚¹ï¼ŒèŠ‚çœå†…å­˜</span></span>
<span class="line"><span style="color:#E5C07B;">	hashMap</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">set</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">origin</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">target</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> k</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> origin</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">origin</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hasOwnProperty</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// å¯¹è±¡è‡ªèº«å±æ€§ä¸­æ˜¯å¦å…·æœ‰æŒ‡å®šçš„kå±æ€§</span></span>
<span class="line"><span style="color:#E06C75;">			target</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">origin</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">hashMap</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// é€’å½’å†èµ‹å€¼</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> target</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°forEachæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myForEach</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å›è°ƒå‡½æ•°applyè°ƒç”¨ï¼ŒthisæŒ‡å‘æ›´æ”¹æˆå‰©ä½™å‚æ•°_arg2æˆ–è€…window</span></span>
<span class="line"><span style="color:#E5C07B;">		cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// applyçš„ç¬¬äºŒä¸ªå‚æ•°æ•°ç»„é‡Œé¢çš„ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°mapæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myMap</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _newArr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _item</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		_item</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// ç»“åˆä¸Šé¢çš„æ·±æ‹·è´æ–¹æ³•</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å›è°ƒå‡½æ•°applyè°ƒç”¨ï¼ŒthisæŒ‡å‘æ›´æ”¹æˆå‰©ä½™å‚æ•°_arg2æˆ–è€…window</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// applyçš„ç¬¬äºŒä¸ªå‚æ•°æ•°ç»„é‡Œé¢çš„ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</span></span>
<span class="line"><span style="color:#E06C75;">		_res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">		_res</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E5C07B;"> _newArr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_res</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// æ˜¯å¦æœ‰è¿”å›å€¼æ‰æ‰§è¡Œpush</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> _newArr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°filteræ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myFilter</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _newArr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _item</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		_item</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// æ·±æ‹·è´</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å›è°ƒå‡½æ•°applyè°ƒç”¨ï¼ŒthisæŒ‡å‘æ›´æ”¹æˆå‰©ä½™å‚æ•°_arg2æˆ–è€…window</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// applyçš„ç¬¬äºŒä¸ªå‚æ•°æ•°ç»„é‡Œé¢çš„ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">		cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]) </span><span style="color:#C678DD;">?</span><span style="color:#E5C07B;"> _newArr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">:</span><span style="color:#98C379;"> &quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> _newArr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°everyæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myEvery</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _res</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">])) {</span></span>
<span class="line"><span style="color:#E06C75;">			_res</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> _res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°someæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">mySome</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// å‰©ä½™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _res</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg2</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">])) {</span></span>
<span class="line"><span style="color:#E06C75;">			_res</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> _res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°reduceæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myReduce</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">initialValue</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæœ‰ç¬¬ä¸‰ä¸ªå‚æ•°å°±æŒ‡å‘å®ƒï¼Œæ²¡æœ‰å°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg3</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _item</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> _len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		_item</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// æ·±å…‹éš†</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æŒ‡å‘_arg3</span></span>
<span class="line"><span style="color:#E06C75;">		initialValue</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg3</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">initialValue</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> initialValue</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®ç°reduceRightæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myReduceRight</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">initialValue</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæœ‰ç¬¬ä¸‰ä¸ªå‚æ•°å°±æŒ‡å‘å®ƒï¼Œæ²¡æœ‰å°±æŒ‡å‘window</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _arg3</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">||</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> _item</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> _len</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å€’å™æ’å…¥</span></span>
<span class="line"><span style="color:#E06C75;">		_item</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> deepClone</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]); </span><span style="color:#7F848E;font-style:italic;">// æ·±å…‹éš†</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æŒ‡å‘_arg3çš„thisï¼Œå¹¶ä¼ å››ä¸ªå‚æ•°å›å»</span></span>
<span class="line"><span style="color:#E06C75;">		initialValue</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> cb</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">_arg3</span><span style="color:#ABB2BF;">, [</span><span style="color:#E06C75;">initialValue</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">_arr</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> initialValue</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br></div></div><p>index.jsï¼šè°ƒç”¨æ¯”è¾ƒ</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> obj</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">	name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Jacky&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">	age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å‘¨ä¸€&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;åˆ˜äºŒ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">28</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¼ ä¸‰&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;æå››&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ç‹äº”&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">27</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;èµµå…­&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">36</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;èƒ¡ä¸ƒ&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">35</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#ABB2BF;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// forEachæ–¹æ³•è¾“å‡º</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// arr.forEach(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this.name);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(item, index, array);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(&#39;------&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// arr.myForEach(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this.name);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(item, index, array);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// mapæ–¹æ³•è¾“å‡º</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var newArr = arr.map(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(item, index, array);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return item;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(newArr);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(&#39;----------&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var newArr2 = arr.myMap(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(item, index, array);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return item;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(newArr2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// filteræ–¹æ³•è¾“å‡º</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var newArr = arr.filter(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return item.age &gt; 30;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(newArr);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(&#39;----------&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var newArr2 = arr.myFilter(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return item.age &gt; 30;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(newArr2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// everyæ–¹æ³•è¾“å‡º</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var res = arr.every(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return item.age &lt; 40;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(res);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(&#39;------&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var res2 = arr.myEvery(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return item.age &lt; 40;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(res2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// someæ–¹æ³•è¾“å‡º</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var res = arr.some(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return item.age &lt; 40;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(res);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(&#39;------&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var res2 = arr.mySome(function (item, index , array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return item.age &lt; 40;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, obj);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(res2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// reduceæ–¹æ³•è¾“å‡º</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var initialValue = [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//     name: &#39;å¤§å“¥&#39;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//     age: 18</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var newArr = arr.reduce(function (prev, item, index, array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   item.age &gt;= 25 &amp;&amp; prev.push(item);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return prev;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, initialValue, obj);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(newArr);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(&#39;----------&#39;);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var initialValue2 = [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//     name: &#39;äºŒå“¥&#39;,</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//     age: 18</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// var newArr2 = arr.myReduce(function (prev, item, index, array) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(this);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   item.age &gt;= 25 &amp;&amp; prev.push(item);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   return prev;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, initialValue2, obj);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// console.log(newArr2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// reduceRightæ–¹æ³•è¾“å‡º</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> initialValue</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å¤§å“¥&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> newArr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reduceRight</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">prev</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	item</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#D19A66;"> 25</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E5C07B;"> prev</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> prev</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}, </span><span style="color:#E06C75;">initialValue</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">newArr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;----------&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> initialValue2</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#E06C75;">		name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;äºŒå“¥&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">		age</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> newArr2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myReduceRight</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">prev</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	item</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#D19A66;"> 25</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E5C07B;"> prev</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> prev</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}, </span><span style="color:#E06C75;">initialValue2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">newArr2</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br></div></div><h2 id="æ‰‹åŠ¨å®ç°-array-prototype-map-æ–¹æ³•" tabindex="-1">æ‰‹åŠ¨å®ç° Array.prototype.map æ–¹æ³• <a class="header-anchor" href="#æ‰‹åŠ¨å®ç°-array-prototype-map-æ–¹æ³•" aria-label="Permalink to &quot;æ‰‹åŠ¨å®ç° Array.prototype.map æ–¹æ³•&quot;">â€‹</a></h2><p>map() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æœæ˜¯è¯¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨ä¸€ä¸ªæä¾›çš„å‡½æ•°åè¿”å›çš„ç»“æœã€‚</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> map</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">mapCallback</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// é¦–å…ˆï¼Œæ£€æŸ¥ä¼ é€’çš„å‚æ•°æ˜¯å¦æ­£ç¡®ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isArray</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#56B6C2;"> !</span><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> ||</span><span style="color:#C678DD;"> typeof</span><span style="color:#E06C75;"> mapCallback</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æ¯æ¬¡è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šåˆ›å»ºä¸€ä¸ª result æ•°ç»„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å› ä¸ºæˆ‘ä»¬ä¸æƒ³æ”¹å˜åŸå§‹æ•°ç»„ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">			result</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">mapCallback</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// å°† mapCallback è¿”å›çš„ç»“æœ push åˆ° result æ•°ç»„ä¸­</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="æ‰‹åŠ¨å®ç°-array-prototype-filter-æ–¹æ³•" tabindex="-1">æ‰‹åŠ¨å®ç° Array.prototype.filter æ–¹æ³• <a class="header-anchor" href="#æ‰‹åŠ¨å®ç°-array-prototype-filter-æ–¹æ³•" aria-label="Permalink to &quot;æ‰‹åŠ¨å®ç° Array.prototype.filter æ–¹æ³•&quot;">â€‹</a></h2><p>filter() æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„, å…¶åŒ…å«é€šè¿‡æ‰€æä¾›å‡½æ•°å®ç°çš„æµ‹è¯•çš„æ‰€æœ‰å…ƒç´ ã€‚</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> filter</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">filterCallback</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// é¦–å…ˆï¼Œæ£€æŸ¥ä¼ é€’çš„å‚æ•°æ˜¯å¦æ­£ç¡®ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">		!</span><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isArray</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#56B6C2;">		!</span><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> ||</span></span>
<span class="line"><span style="color:#C678DD;">		typeof</span><span style="color:#E06C75;"> filterCallback</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æ¯æ¬¡è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šåˆ›å»ºä¸€ä¸ª result æ•°ç»„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å› ä¸ºæˆ‘ä»¬ä¸æƒ³æ”¹å˜åŸå§‹æ•°ç»„ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// æ£€æŸ¥ filterCallback çš„è¿”å›å€¼æ˜¯å¦æ˜¯çœŸå€¼</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">filterCallback</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// å¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œåˆ™å°†æ•°ç»„å…ƒç´  push åˆ° result ä¸­</span></span>
<span class="line"><span style="color:#E5C07B;">				result</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// return the result array</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="æ‰‹åŠ¨å®ç°-array-prototype-reduce-æ–¹æ³•" tabindex="-1">æ‰‹åŠ¨å®ç° Array.prototype.reduce æ–¹æ³• <a class="header-anchor" href="#æ‰‹åŠ¨å®ç°-array-prototype-reduce-æ–¹æ³•" aria-label="Permalink to &quot;æ‰‹åŠ¨å®ç° Array.prototype.reduce æ–¹æ³•&quot;">â€‹</a></h2><p>reduce() æ–¹æ³•å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¸€ä¸ªç”±æ‚¨æä¾›çš„ reducer å‡½æ•°(å‡åºæ‰§è¡Œ)ï¼Œå°†å…¶ç»“æœæ±‡æ€»ä¸ºå•ä¸ªè¿”å›å€¼ã€‚</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> reduce</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reduceCallback</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">initialValue</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // é¦–å…ˆï¼Œæ£€æŸ¥ä¼ é€’çš„å‚æ•°æ˜¯å¦æ­£ç¡®ã€‚</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isArray</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#56B6C2;"> !</span><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> ||</span><span style="color:#C678DD;"> typeof</span><span style="color:#E06C75;"> reduceCallback</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &#39;function&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#ABB2BF;">  } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // å¦‚æœæ²¡æœ‰å°†initialValueä¼ é€’ç»™è¯¥å‡½æ•°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç¬¬ä¸€ä¸ªæ•°ç»„é¡¹ä½œä¸ºinitialValue</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> hasInitialValue</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> initialValue</span><span style="color:#56B6C2;"> !==</span><span style="color:#D19A66;"> undefined</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">    let</span><span style="color:#E06C75;"> value</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> hasInitialValue</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> initialValue</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // å¦‚æœæœ‰ä¼ é€’ initialValueï¼Œåˆ™ç´¢å¼•ä» 1 å¼€å§‹ï¼Œå¦åˆ™ä» 0 å¼€å§‹</span></span>
<span class="line"><span style="color:#C678DD;">    for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> hasInitialValue</span><span style="color:#C678DD;"> ?</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> :</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">      value</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> reduceCallback</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E06C75;"> value</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="æ‰‹å†™-reduce-flat" tabindex="-1">æ‰‹å†™ <code>reduce flat</code> <a class="header-anchor" href="#æ‰‹å†™-reduce-flat" aria-label="Permalink to &quot;æ‰‹å†™ \`reduce flat\`&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆï¼š</p><p><code>reduce</code> å®ç°ï¼š</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">my_reduce</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">callback</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">initialValue</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#56B6C2;">		!</span><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isArray</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#56B6C2;">		!</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> ||</span></span>
<span class="line"><span style="color:#C678DD;">		typeof</span><span style="color:#E06C75;"> callback</span><span style="color:#56B6C2;"> !==</span><span style="color:#98C379;"> &quot;function&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">	) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// åˆ¤æ–­æ˜¯å¦æœ‰åˆå§‹å€¼</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> hasInitialValue</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> initialValue</span><span style="color:#56B6C2;"> !==</span><span style="color:#D19A66;"> undefined</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> value</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> hasInitialValue</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> initialValue</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> tihs</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> index</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> hasInitialValue</span><span style="color:#C678DD;"> ?</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> :</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">index</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">index</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			const</span><span style="color:#E5C07B;"> element</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">index</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			value</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> callback</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">element</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">index</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> value</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">my_reduce</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">pre</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">cur</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">pre</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">cur</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> pre</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> cur</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//25</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><code>flat</code> å®ç°ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#D19A66;">	1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, [</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, [</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;zs&quot;</span><span style="color:#ABB2BF;">], </span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">, [</span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">9</span><span style="color:#ABB2BF;">, [</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">11</span><span style="color:#ABB2BF;">, [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, [</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">]]]]]],</span></span>
<span class="line"><span style="color:#ABB2BF;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//ä¸‡èƒ½çš„ç±»å‹æ£€æµ‹æ–¹æ³•</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> checkType</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">toString</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">slice</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//è‡ªå®šä¹‰flatæ–¹æ³•ï¼Œæ³¨æ„ï¼šä¸å¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œä½¿ç”¨åå†…éƒ¨çš„thisä¼šæŒ‡å‘window</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myFlat</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">num</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//åˆ¤æ–­ç¬¬ä¸€å±‚æ•°ç»„çš„ç±»å‹</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> type</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> checkType</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œç”¨äºä¿å­˜æ‹†åˆ†åçš„æ•°ç»„</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//è‹¥å½“å‰å¯¹è±¡éæ•°ç»„åˆ™è¿”å›undefined</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">is</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Array&quot;</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//éå†æ‰€æœ‰å­å…ƒç´ å¹¶åˆ¤æ–­ç±»å‹ï¼Œè‹¥ä¸ºæ•°ç»„åˆ™ç»§ç»­é€’å½’ï¼Œè‹¥ä¸ä¸ºæ•°ç»„åˆ™ç›´æ¥åŠ å…¥æ–°æ•°ç»„</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> cellType</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> checkType</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">is</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">cellType</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Array&quot;</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			//å½¢å‚numï¼Œè¡¨ç¤ºå½“å‰éœ€è¦æ‹†åˆ†å¤šå°‘å±‚æ•°ç»„ï¼Œä¼ å…¥Infinityåˆ™å°†å¤šç»´ç›´æ¥é™ä¸ºä¸€ç»´</span></span>
<span class="line"><span style="color:#E06C75;">			num</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">num</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">				let</span><span style="color:#E06C75;"> newArr</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> result</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				return</span><span style="color:#E06C75;"> newArr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			//ä½¿ç”¨ä¸‰ç‚¹è¿ç®—ç¬¦è§£æ„ï¼Œé€’å½’å‡½æ•°è¿”å›çš„æ•°ç»„ï¼Œå¹¶åŠ å…¥æ–°æ•°ç»„</span></span>
<span class="line"><span style="color:#E5C07B;">			result</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(...</span><span style="color:#E5C07B;">item</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myFlat</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">num</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">		} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">			result</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">flat</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">Infinity</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">//[1, 2, 3, 4, 5, 12, 3, &quot;zs&quot;, 7, 8, 9, 10, 11, 1, 2, 3, 4];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myFlat</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">Infinity</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">//[1, 2, 3, 4, 5, 12, 3, &quot;zs&quot;, 7, 8, 9, 10, 11, 1, 2, 3, 4];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// è‡ªå®šä¹‰æ–¹æ³•å’Œè‡ªå¸¦çš„flatè¿”å›ç»“æœä¸€è‡´!!!!</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">timeEnd</span><span style="color:#ABB2BF;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h2 id="å®ç°æ•°ç»„-map-æ–¹æ³•" tabindex="-1">å®ç°æ•°ç»„ map æ–¹æ³• ? <a class="header-anchor" href="#å®ç°æ•°ç»„-map-æ–¹æ³•" aria-label="Permalink to &quot;å®ç°æ•°ç»„ map æ–¹æ³• ?&quot;">â€‹</a></h2><p>ä¾ç…§ ecma262 è‰æ¡ˆï¼Œå®ç°çš„ map çš„è§„èŒƒå¦‚ä¸‹ï¼š</p><p><img src="`+B+`" alt="image-20240318180721640"></p><p>ä¸‹é¢æ ¹æ®è‰æ¡ˆçš„è§„å®šä¸€æ­¥æ­¥æ¥æ¨¡æ‹Ÿå®ç° map å‡½æ•°ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">map</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">callbackFn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">thisArg</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¤„ç†æ•°ç»„ç±»å‹å¼‚å¸¸</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">this</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> this</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> undefined</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Cannot read property &#39;map&#39; of null or undefined&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¤„ç†å›è°ƒç±»å‹å¼‚å¸¸</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">toString</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callbackfn</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;[object Function]&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callbackfn</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &quot; is not a function&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è‰æ¡ˆä¸­æåˆ°è¦å…ˆè½¬æ¢ä¸ºå¯¹è±¡</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E5C07B;"> O</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E5C07B;"> T</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> thisArg</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E5C07B;"> A</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Array</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">len</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> k</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">k</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">k</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// è¿˜è®°å¾—åŸå‹é“¾é‚£ä¸€èŠ‚æåˆ°çš„ in å—ï¼Ÿin è¡¨ç¤ºåœ¨åŸå‹é“¾æŸ¥æ‰¾</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å¦‚æœç”¨ hasOwnProperty æ˜¯æœ‰é—®é¢˜çš„ï¼Œå®ƒåªèƒ½æ‰¾ç§æœ‰å±æ€§</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">k</span><span style="color:#C678DD;"> in</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> kValue</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// ä¾æ¬¡ä¼ å…¥this, å½“å‰é¡¹ï¼Œå½“å‰ç´¢å¼•ï¼Œæ•´ä¸ªæ•°ç»„</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> mappedValue</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> callbackfn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">T</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">KValue</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">O</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">			A</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> mappedValue</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E5C07B;"> A</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>è¿™é‡Œè§£é‡Šä¸€ä¸‹, length &gt;&gt;&gt; 0, å­—é¢æ„æ€æ˜¯æŒ‡&quot;å³ç§» 0 ä½&quot;ï¼Œä½†å®é™…ä¸Šæ˜¯æŠŠå‰é¢çš„ç©ºä½ç”¨ 0 å¡«å……ï¼Œè¿™é‡Œçš„ä½œç”¨æ˜¯ä¿è¯ len ä¸ºæ•°å­—ä¸”ä¸ºæ•´æ•°ã€‚</p><p>ä¸¾å‡ ä¸ªç‰¹ä¾‹ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#D19A66;">null</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //0</span></span>
<span class="line"><span style="color:#D19A66;">undefined</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //0</span></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //0</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> a</span><span style="color:#ABB2BF;"> (){}; </span><span style="color:#E06C75;">a</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //0</span></span>
<span class="line"><span style="color:#ABB2BF;">[] </span><span style="color:#56B6C2;">&gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //0</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> a</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {}; </span><span style="color:#E06C75;">a</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //0</span></span>
<span class="line"><span style="color:#D19A66;">123123</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //123123</span></span>
<span class="line"><span style="color:#D19A66;">45.2</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //45</span></span>
<span class="line"><span style="color:#D19A66;">0</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //0</span></span>
<span class="line"><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">0</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //0</span></span>
<span class="line"><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //4294967295</span></span>
<span class="line"><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1212</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;"> //4294966084</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æ€»ä½“å®ç°èµ·æ¥å¹¶æ²¡é‚£ä¹ˆéš¾ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯ä½¿ç”¨ in æ¥è¿›è¡ŒåŸå‹é“¾æŸ¥æ‰¾ã€‚åŒæ—¶ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å°±ä¸å¤„ç†ï¼Œèƒ½æœ‰æ•ˆå¤„ç†ç¨€ç–æ•°ç»„çš„æƒ…å†µã€‚</p><p>æœ€åç»™å¤§å®¶å¥‰ä¸Š V8 æºç ï¼Œå‚ç…§æºç æ£€æŸ¥ä¸€ä¸‹ï¼Œå…¶å®è¿˜æ˜¯å®ç°å¾—å¾ˆå®Œæ•´äº†ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> ArrayMap</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">f</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">receiver</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">	CHECK_OBJECT_COERCIBLE</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Array.prototype.map&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// Pull out the length so that modifications to the length in the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// loop will not affect the looping and side effects are visible.</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> array</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> TO_OBJECT</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> length</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> TO_LENGTH</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#61AFEF;">IS_CALLABLE</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">f</span><span style="color:#ABB2BF;">)) </span><span style="color:#C678DD;">throw</span><span style="color:#56B6C2;"> %</span><span style="color:#61AFEF;">make_type_error</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">kCalledNonCallable</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">f</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> ArraySpeciesCreate</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">i</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			var</span><span style="color:#E06C75;"> element</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#56B6C2;">			%</span><span style="color:#61AFEF;">CreateDataProperty</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">result</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">%</span><span style="color:#61AFEF;">_Call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">f</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">receiver</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">element</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="å®ç°æ•°ç»„-reduce-æ–¹æ³•" tabindex="-1">å®ç°æ•°ç»„ reduce æ–¹æ³• ? <a class="header-anchor" href="#å®ç°æ•°ç»„-reduce-æ–¹æ³•" aria-label="Permalink to &quot;å®ç°æ•°ç»„ reduce æ–¹æ³• ?&quot;">â€‹</a></h2><p>ä¾ç…§ ecma262 è‰æ¡ˆï¼Œå®ç°çš„ reduce çš„è§„èŒƒå¦‚ä¸‹ï¼š</p><p><img src="`+y+`" alt="image-20240318181140952"></p><p>å…¶ä¸­æœ‰å‡ ä¸ªæ ¸å¿ƒè¦ç‚¹ï¼š</p><p>1ï¼‰åˆå§‹å€¼ä¸ä¼ æ€ä¹ˆå¤„ç† 2ï¼‰å›è°ƒå‡½æ•°çš„å‚æ•°æœ‰å“ªäº›ï¼Œè¿”å›å€¼å¦‚ä½•å¤„ç†ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reduce</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">callbackfn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">initialValue</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¼‚å¸¸å¤„ç†ï¼Œå’Œ map ä¸€æ ·</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¤„ç†æ•°ç»„ç±»å‹å¼‚å¸¸</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">this</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> this</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> undefined</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Cannot read property &#39;reduce&#39; of null or undefined&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¤„ç†å›è°ƒç±»å‹å¼‚å¸¸</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">toString</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callbackfn</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;[object Function]&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callbackfn</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &quot; is not a function&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E5C07B;"> O</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> k</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> accumulator</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> initialValue</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">accumulator</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> undefined</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (; </span><span style="color:#E06C75;">k</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">k</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// æŸ¥æ‰¾åŸå‹é“¾</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">k</span><span style="color:#C678DD;"> in</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">				accumulator</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">				k</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">				break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è¡¨ç¤ºæ•°ç»„å…¨ä¸ºç©º</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">k</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E06C75;"> accumulator</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> undefined</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Each element of the array is empty&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (; </span><span style="color:#E06C75;">k</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">k</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">k</span><span style="color:#C678DD;"> in</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// æ³¨æ„ï¼Œæ ¸å¿ƒï¼</span></span>
<span class="line"><span style="color:#E06C75;">			accumulator</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> callbackfn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">undefined</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">accumulator</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">O</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">k</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">O</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> accumulator</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>å…¶å®æ˜¯ä»æœ€åä¸€é¡¹å¼€å§‹éå†ï¼Œé€šè¿‡åŸå‹é“¾æŸ¥æ‰¾è·³è¿‡ç©ºé¡¹ã€‚</p><p>æœ€åç»™å¤§å®¶å¥‰ä¸Š V8 æºç ï¼Œä»¥ä¾›å¤§å®¶æ£€æŸ¥ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> ArrayReduce</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">callback</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">current</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">	CHECK_OBJECT_COERCIBLE</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Array.prototype.reduce&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// Pull out the length so that modifications to the length in the</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// loop will not affect the looping and side effects are visible.</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> array</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> TO_OBJECT</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> length</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> TO_LENGTH</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#61AFEF;"> InnerArrayReduce</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callback</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">current</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> InnerArrayReduce</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">callback</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">current</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">length</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">argumentsLength</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#61AFEF;">IS_CALLABLE</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callback</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#56B6C2;"> %</span><span style="color:#61AFEF;">make_type_error</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">kCalledNonCallable</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">callback</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">	find_initial</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">argumentsLength</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">i</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">				current</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">				break</span><span style="color:#E06C75;"> find_initial</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#56B6C2;"> %</span><span style="color:#61AFEF;">make_type_error</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">kReduceNoInitial</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">i</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			var</span><span style="color:#E06C75;"> element</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			current</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> callback</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">current</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">element</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> current</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="å®ç°æ•°ç»„-pushã€pop-æ–¹æ³•" tabindex="-1">å®ç°æ•°ç»„ pushã€pop æ–¹æ³• ? <a class="header-anchor" href="#å®ç°æ•°ç»„-pushã€pop-æ–¹æ³•" aria-label="Permalink to &quot;å®ç°æ•°ç»„ pushã€pop æ–¹æ³• ?&quot;">â€‹</a></h2><p>å‚ç…§ ecma262 è‰æ¡ˆçš„è§„å®šï¼Œå…³äº push å’Œ pop çš„è§„èŒƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="`+i+'" alt="image-20240318181536184"></p><p><img src="'+F+`" alt="image-20240318181555586"></p><p>å®ç° push æ–¹æ³•ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (...</span><span style="color:#E06C75;font-style:italic;">items</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E5C07B;"> O</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> argCount</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> items</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 2 ** 53 - 1 ä¸ºJSèƒ½è¡¨ç¤ºçš„æœ€å¤§æ­£æ•´æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">len</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> argCount</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 2</span><span style="color:#56B6C2;"> **</span><span style="color:#D19A66;"> 53</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#98C379;">			&quot;The number of array is over the max value restricted!&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">		);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> argCount</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">		O</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">len</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> items</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> newLength</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> argCount</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">	O</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> newLength</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> newLength</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>å®ç° pop æ–¹æ³•:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">pop</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E5C07B;"> O</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">len</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">		O</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#D19A66;"> undefined</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#E06C75;">	len</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> value</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">len</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">len</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E5C07B;">	O</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> value</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="å®ç°æ•°ç»„-filter-æ–¹æ³•" tabindex="-1">å®ç°æ•°ç»„ filter æ–¹æ³• ? <a class="header-anchor" href="#å®ç°æ•°ç»„-filter-æ–¹æ³•" aria-label="Permalink to &quot;å®ç°æ•°ç»„ filter æ–¹æ³• ?&quot;">â€‹</a></h2><p>ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">filter</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">callbackfn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">thisArg</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¤„ç†æ•°ç»„ç±»å‹å¼‚å¸¸</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">this</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> null</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> this</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> undefined</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Cannot read property &#39;filter&#39; of null or undefined&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¤„ç†å›è°ƒç±»å‹å¼‚å¸¸</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">toString</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callbackfn</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!=</span><span style="color:#98C379;"> &quot;[object Function]&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callbackfn</span><span style="color:#56B6C2;"> +</span><span style="color:#98C379;"> &quot; is not a function&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E5C07B;"> O</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> resLen</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">i</span><span style="color:#C678DD;"> in</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> element</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> O</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">callbackfn</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">thisArg</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">O</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">O</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#E06C75;">				res</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">resLen</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> element</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="å®ç°æ•°ç»„-splice-æ–¹æ³•" tabindex="-1">å®ç°æ•°ç»„ splice æ–¹æ³• ? <a class="header-anchor" href="#å®ç°æ•°ç»„-splice-æ–¹æ³•" aria-label="Permalink to &quot;å®ç°æ•°ç»„ splice æ–¹æ³• ?&quot;">â€‹</a></h2><p>splice å¯ä»¥è¯´æ˜¯æœ€å—æ¬¢è¿çš„æ•°ç»„æ–¹æ³•ä¹‹ä¸€ï¼Œapi çµæ´»ï¼Œä½¿ç”¨æ–¹ä¾¿ã€‚ç°åœ¨æ¥æ¢³ç†ä¸€ä¸‹ç”¨æ³•ï¼š</p><ul><li>splice(position, count) è¡¨ç¤ºä» position ç´¢å¼•çš„ä½ç½®å¼€å§‹ï¼Œåˆ é™¤ count ä¸ªå…ƒç´ </li><li>splice(position, 0, ele1, ele2, ...) è¡¨ç¤ºä» position ç´¢å¼•çš„å…ƒç´ åé¢æ’å…¥ä¸€ç³»åˆ—çš„å…ƒç´ </li><li>splice(postion, count, ele1, ele2, ...) è¡¨ç¤ºä» position ç´¢å¼•çš„ä½ç½®å¼€å§‹ï¼Œåˆ é™¤ count ä¸ªå…ƒç´ ï¼Œç„¶åå†æ’å…¥ä¸€ç³»åˆ—çš„å…ƒç´ </li><li>è¿”å›å€¼ä¸º è¢«åˆ é™¤å…ƒç´  ç»„æˆçš„ æ•°ç»„ ã€‚</li></ul><p><strong>æ¥ä¸‹æ¥æˆ‘ä»¬å®ç°æ•°ç»„ splice æ–¹æ³•ã€‚</strong></p><p>é¦–å…ˆæˆ‘ä»¬æ¢³ç†ä¸€ä¸‹å®ç°çš„æ€è·¯ï¼š</p><p><img src="`+A+`" alt="image-20240318181914567"></p><p>åˆæ­¥å®ç°ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">splice</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">addElements</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> argumentsLen</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> array</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> deleteArr</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Array</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ‹·è´åˆ é™¤çš„å…ƒç´ </span></span>
<span class="line"><span style="color:#61AFEF;">	sliceDeleteElements</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteArr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ç§»åŠ¨åˆ é™¤å…ƒç´ åé¢çš„å…ƒç´ </span></span>
<span class="line"><span style="color:#61AFEF;">	movePostElements</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">addElements</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ’å…¥æ–°å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> addElements</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#E5C07B;">	array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#56B6C2;"> +</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> deleteArr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å…ˆæ‹·è´åˆ é™¤çš„å…ƒç´ ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> sliceDeleteElements</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteArr</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> index</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">index</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> current</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">index</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			deleteArr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> current</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>ç„¶åå¯¹åˆ é™¤å…ƒç´ åé¢çš„å…ƒç´ è¿›è¡ŒæŒªåŠ¨, æŒªåŠ¨åˆ†ä¸ºä¸‰ç§æƒ…å†µï¼š</p><p>1ï¼‰æ·»åŠ çš„å…ƒç´ å’Œåˆ é™¤çš„å…ƒç´ ä¸ªæ•°ç›¸ç­‰ 2ï¼‰æ·»åŠ çš„å…ƒç´ ä¸ªæ•°å°äºåˆ é™¤çš„å…ƒç´  3ï¼‰æ·»åŠ çš„å…ƒç´ ä¸ªæ•°å¤§äºåˆ é™¤çš„å…ƒç´ </p><p>å½“ä¸¤è€…ç›¸ç­‰æ—¶ï¼Œ</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> movePostElements</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">addElements</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å½“æ·»åŠ çš„å…ƒç´ ä¸ªæ•°å°äºåˆ é™¤çš„å…ƒç´ æ—¶, å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="`+C+`" alt="image-20240318182147304"></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> movePostElements</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">addElements</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//...</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæ·»åŠ çš„å…ƒç´ å’Œåˆ é™¤çš„å…ƒç´ ä¸ªæ•°ä¸ç›¸ç­‰ï¼Œåˆ™ç§»åŠ¨åé¢çš„å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// åˆ é™¤çš„å…ƒç´ æ¯”æ–°å¢çš„å…ƒç´ å¤šï¼Œé‚£ä¹ˆåé¢çš„å…ƒç´ æ•´ä½“å‘å‰æŒªåŠ¨</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// ä¸€å…±éœ€è¦æŒªåŠ¨ len - startIndex - deleteCount ä¸ªå…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> fromIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// å°†è¦æŒªåŠ¨åˆ°çš„ç›®æ ‡ä½ç½®</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> toIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> -</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> -</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">fromIndex</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">				array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">toIndex</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fromIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">				delete</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">toIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æ³¨æ„æ³¨æ„ï¼è¿™é‡Œæˆ‘ä»¬æŠŠåé¢çš„å…ƒç´ å‘å‰æŒªï¼Œç›¸å½“äºæ•°ç»„é•¿åº¦å‡å°äº†ï¼Œéœ€è¦åˆ é™¤å†—ä½™å…ƒç´ </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// ç›®å‰é•¿åº¦ä¸º len + addElements - deleteCount</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> +</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			delete</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>å½“æ·»åŠ çš„å…ƒç´ ä¸ªæ•°å¤§äºåˆ é™¤çš„å…ƒç´ æ—¶, å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="`+b+`" alt="image-20240318182239803"></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> movePostElements</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">addElements</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//...</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// åˆ é™¤çš„å…ƒç´ æ¯”æ–°å¢çš„å…ƒç´ å°‘ï¼Œé‚£ä¹ˆåé¢çš„å…ƒç´ æ•´ä½“å‘åæŒªåŠ¨</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æ€è€ƒä¸€ä¸‹: è¿™é‡Œä¸ºä»€ä¹ˆè¦ä»åå¾€å‰éå†ï¼Ÿä»å‰å¾€åä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> fromIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// å°†è¦æŒªåŠ¨åˆ°çš„ç›®æ ‡ä½ç½®</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> toIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">fromIndex</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">				array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">toIndex</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fromIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">				delete</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">toIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="ä¼˜åŒ–ä¸€-å‚æ•°çš„è¾¹ç•Œæƒ…å†µ" tabindex="-1">ä¼˜åŒ–ä¸€: å‚æ•°çš„è¾¹ç•Œæƒ…å†µ <a class="header-anchor" href="#ä¼˜åŒ–ä¸€-å‚æ•°çš„è¾¹ç•Œæƒ…å†µ" aria-label="Permalink to &quot;ä¼˜åŒ–ä¸€: å‚æ•°çš„è¾¹ç•Œæƒ…å†µ&quot;">â€‹</a></h4><p>å½“ç”¨æˆ·ä¼ æ¥éæ³•çš„ startIndex å’Œ deleteCount æˆ–è€…è´Ÿç´¢å¼•çš„æ—¶å€™ï¼Œéœ€è¦æˆ‘ä»¬åšå‡ºç‰¹æ®Šçš„å¤„ç†ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> computeStartIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">len</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¤„ç†ç´¢å¼•è´Ÿæ•°çš„æƒ…å†µ</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">startIndex</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> len</span><span style="color:#C678DD;"> :</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#E06C75;"> len</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> len</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> computeDeleteCount</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">argumentsLen</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ é™¤æ•°ç›®æ²¡æœ‰ä¼ ï¼Œé»˜è®¤åˆ é™¤startIndexåŠåé¢æ‰€æœ‰çš„</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">argumentsLen</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ é™¤æ•°ç›®è¿‡å°</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ é™¤æ•°ç›®è¿‡å¤§</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">splice</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">addElements</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//,...</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> deleteArr</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Array</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ä¸‹é¢å‚æ•°çš„æ¸…æ´—å·¥ä½œ</span></span>
<span class="line"><span style="color:#E06C75;">	startIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> computeStartIndex</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">	deleteCount</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> computeDeleteCount</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">argumentsLen</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ‹·è´åˆ é™¤çš„å…ƒç´ </span></span>
<span class="line"><span style="color:#61AFEF;">	sliceDeleteElements</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteArr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//...</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="ä¼˜åŒ–äºŒ-æ•°ç»„ä¸ºå¯†å°å¯¹è±¡æˆ–å†»ç»“å¯¹è±¡" tabindex="-1">ä¼˜åŒ–äºŒï¼šæ•°ç»„ä¸ºå¯†å°å¯¹è±¡æˆ–å†»ç»“å¯¹è±¡ <a class="header-anchor" href="#ä¼˜åŒ–äºŒ-æ•°ç»„ä¸ºå¯†å°å¯¹è±¡æˆ–å†»ç»“å¯¹è±¡" aria-label="Permalink to &quot;ä¼˜åŒ–äºŒï¼šæ•°ç»„ä¸ºå¯†å°å¯¹è±¡æˆ–å†»ç»“å¯¹è±¡&quot;">â€‹</a></h4><h5 id="ä»€ä¹ˆæ˜¯å¯†å°å¯¹è±¡" tabindex="-1">ä»€ä¹ˆæ˜¯å¯†å°å¯¹è±¡? <a class="header-anchor" href="#ä»€ä¹ˆæ˜¯å¯†å°å¯¹è±¡" aria-label="Permalink to &quot;ä»€ä¹ˆæ˜¯å¯†å°å¯¹è±¡?&quot;">â€‹</a></h5><p>å¯†å°å¯¹è±¡æ˜¯ä¸å¯æ‰©å±•çš„å¯¹è±¡ï¼Œè€Œä¸”å·²æœ‰æˆå‘˜çš„[[Configurable]]å±æ€§è¢«è®¾ç½®ä¸º falseï¼Œè¿™æ„å‘³ç€ä¸èƒ½æ·»åŠ ã€åˆ é™¤æ–¹æ³•å’Œå±æ€§ã€‚ä½†æ˜¯å±æ€§å€¼æ˜¯å¯ä»¥ä¿®æ”¹çš„ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯å†»ç»“å¯¹è±¡" tabindex="-1">ä»€ä¹ˆæ˜¯å†»ç»“å¯¹è±¡ï¼Ÿ <a class="header-anchor" href="#ä»€ä¹ˆæ˜¯å†»ç»“å¯¹è±¡" aria-label="Permalink to &quot;ä»€ä¹ˆæ˜¯å†»ç»“å¯¹è±¡ï¼Ÿ&quot;">â€‹</a></h5><p>å†»ç»“å¯¹è±¡æ˜¯æœ€ä¸¥æ ¼çš„é˜²ç¯¡æ”¹çº§åˆ«ï¼Œé™¤äº†åŒ…å«å¯†å°å¯¹è±¡çš„é™åˆ¶å¤–ï¼Œè¿˜ä¸èƒ½ä¿®æ”¹å±æ€§å€¼ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æŠŠè¿™ä¸¤ç§æƒ…å†µä¸€ä¸€æ’é™¤ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// åˆ¤æ–­ sealed å¯¹è±¡å’Œ frozen å¯¹è±¡, å³ å¯†å°å¯¹è±¡ å’Œ å†»ç»“å¯¹è±¡</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isSealed</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#56B6C2;"> !==</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;the object is a sealed object!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#E5C07B;">	Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFrozen</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&amp;&amp;</span></span>
<span class="line"><span style="color:#ABB2BF;">	(</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;the object is a frozen object!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>å¥½äº†ï¼Œç°åœ¨å°±å†™äº†ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„ spliceï¼Œå¦‚ä¸‹ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> sliceDeleteElements</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteArr</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> index</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">index</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> current</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">index</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			deleteArr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> current</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> movePostElements</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">addElements</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæ·»åŠ çš„å…ƒç´ å’Œåˆ é™¤çš„å…ƒç´ ä¸ªæ•°ç›¸ç­‰ï¼Œç›¸å½“äºå…ƒç´ çš„æ›¿æ¢ï¼Œæ•°ç»„é•¿åº¦ä¸å˜ï¼Œè¢«åˆ é™¤å…ƒç´ åé¢çš„å…ƒç´ ä¸éœ€è¦æŒªåŠ¨;</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¦‚æœæ·»åŠ çš„å…ƒç´ å’Œåˆ é™¤çš„å…ƒç´ ä¸ªæ•°ä¸ç›¸ç­‰ï¼Œåˆ™ç§»åŠ¨åé¢çš„å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">	else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// åˆ é™¤çš„å…ƒç´ æ¯”æ–°å¢çš„å…ƒç´ å¤šï¼Œé‚£ä¹ˆåé¢çš„å…ƒç´ æ•´ä½“å‘å‰æŒªåŠ¨</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// ä¸€å…±éœ€è¦æŒªåŠ¨ len - startIndex - deleteCount ä¸ªå…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> fromIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// å°†è¦æŒªåŠ¨åˆ°çš„ç›®æ ‡ä½ç½®</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> toIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> -</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> -</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">fromIndex</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">				array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">toIndex</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fromIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">				delete</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">toIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æ³¨æ„æ³¨æ„ï¼è¿™é‡Œæˆ‘ä»¬æŠŠåé¢çš„å…ƒç´ å‘å‰æŒªï¼Œç›¸å½“äºæ•°ç»„é•¿åº¦å‡å°äº†ï¼Œéœ€è¦åˆ é™¤å†—ä½™å…ƒç´ </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// ç›®å‰é•¿åº¦ä¸º len + addElements - deleteCount</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> +</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			delete</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// åˆ é™¤çš„å…ƒç´ æ¯”æ–°å¢çš„å…ƒç´ å°‘ï¼Œé‚£ä¹ˆåé¢çš„å…ƒç´ æ•´ä½“å‘åæŒªåŠ¨</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æ€è€ƒä¸€ä¸‹: è¿™é‡Œä¸ºä»€ä¹ˆè¦ä»åå¾€å‰éå†ï¼Ÿä»å‰å¾€åä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> fromIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// å°†è¦æŒªåŠ¨åˆ°çš„ç›®æ ‡ä½ç½®</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> toIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">fromIndex</span><span style="color:#C678DD;"> in</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">				array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">toIndex</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">fromIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">				delete</span><span style="color:#E06C75;"> array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">toIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> computeStartIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">len</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¤„ç†ç´¢å¼•è´Ÿæ•°çš„æƒ…å†µ</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">startIndex</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> len</span><span style="color:#C678DD;"> :</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> startIndex</span><span style="color:#56B6C2;"> &gt;=</span><span style="color:#E06C75;"> len</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> len</span><span style="color:#C678DD;"> :</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> computeDeleteCount</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">argumentsLen</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ é™¤æ•°ç›®æ²¡æœ‰ä¼ ï¼Œé»˜è®¤åˆ é™¤startIndexåŠåé¢æ‰€æœ‰çš„</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">argumentsLen</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ é™¤æ•°ç›®è¿‡å°</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ é™¤æ•°ç›®è¿‡å¤§</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> startIndex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">splice</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">deleteCount</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">addElements</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> argumentsLen</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> arguments</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> array</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> deleteArr</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Array</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">	startIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> computeStartIndex</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">	deleteCount</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> computeDeleteCount</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">argumentsLen</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// åˆ¤æ–­ sealed å¯¹è±¡å’Œ frozen å¯¹è±¡, å³ å¯†å°å¯¹è±¡ å’Œ å†»ç»“å¯¹è±¡</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isSealed</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#56B6C2;"> !==</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;the object is a sealed object!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#E5C07B;">		Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFrozen</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&amp;&amp;</span></span>
<span class="line"><span style="color:#ABB2BF;">		(</span><span style="color:#E06C75;">deleteCount</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	) {</span></span>
<span class="line"><span style="color:#C678DD;">		throw</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> TypeError</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;the object is a frozen object!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ‹·è´åˆ é™¤çš„å…ƒç´ </span></span>
<span class="line"><span style="color:#61AFEF;">	sliceDeleteElements</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteArr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ç§»åŠ¨åˆ é™¤å…ƒç´ åé¢çš„å…ƒç´ </span></span>
<span class="line"><span style="color:#61AFEF;">	movePostElements</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">startIndex</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">len</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">deleteCount</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">addElements</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ’å…¥æ–°å…ƒç´ </span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		array</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">startIndex</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> addElements</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#E5C07B;">	array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> len</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> deleteCount</span><span style="color:#56B6C2;"> +</span><span style="color:#E5C07B;"> addElements</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> deleteArr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br></div></div><h2 id="å®ç°æ•°ç»„-sort-æ–¹æ³•" tabindex="-1">å®ç°æ•°ç»„ sort æ–¹æ³•ï¼Ÿ <a class="header-anchor" href="#å®ç°æ•°ç»„-sort-æ–¹æ³•" aria-label="Permalink to &quot;å®ç°æ•°ç»„ sort æ–¹æ³•ï¼Ÿ&quot;">â€‹</a></h2><p>ä¼°è®¡å¤§å®¶å¯¹ JS æ•°ç»„çš„ sort æ–¹æ³•å·²ç»ä¸é™Œç”Ÿäº†ï¼Œä¹‹å‰ä¹Ÿå¯¹å®ƒçš„ç”¨æ³•åšäº†è¯¦ç»†çš„æ€»ç»“ã€‚é‚£ï¼Œå®ƒçš„å†…éƒ¨æ˜¯å¦‚ä½•æ¥å®ç°çš„å‘¢ï¼Ÿå¦‚æœè¯´æˆ‘ä»¬èƒ½å¤Ÿè¿›å…¥å®ƒçš„å†…éƒ¨å»çœ‹ä¸€çœ‹ï¼Œ ç†è§£èƒŒåçš„è®¾è®¡ï¼Œä¼šä½¿æˆ‘ä»¬çš„æ€ç»´å’Œç´ å…»å¾—åˆ°ä¸é”™çš„æå‡ã€‚</p><p>sort æ–¹æ³•åœ¨ V8 å†…éƒ¨ç›¸å¯¹ä¸å…¶ä»–æ–¹æ³•è€Œè¨€æ˜¯ä¸€ä¸ªæ¯”è¾ƒé«˜æ·±çš„ç®—æ³•ï¼Œå¯¹äºå¾ˆå¤šè¾¹ç•Œæƒ…å†µåšäº†åå¤çš„ä¼˜åŒ–ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¸ä¼šç›´æ¥æ‹¿æºç æ¥å¹²è®²ã€‚æˆ‘ä»¬ä¼šæ¥æ ¹æ®æºç çš„æ€è·¯ï¼Œå®ç°ä¸€ä¸ª è·Ÿå¼•æ“æ€§èƒ½ä¸€æ ·çš„æ’åºç®—æ³•ï¼Œå¹¶ä¸”ä¸€æ­¥æ­¥æ‹†è§£å…¶ä¸­çš„å¥¥ç§˜ã€‚</p><h4 id="v8-å¼•æ“çš„æ€è·¯åˆ†æ" tabindex="-1">V8 å¼•æ“çš„æ€è·¯åˆ†æ <a class="header-anchor" href="#v8-å¼•æ“çš„æ€è·¯åˆ†æ" aria-label="Permalink to &quot;V8 å¼•æ“çš„æ€è·¯åˆ†æ&quot;">â€‹</a></h4><p>é¦–å…ˆå¤§æ¦‚æ¢³ç†ä¸€ä¸‹æºç ä¸­æ’åºçš„æ€è·¯ï¼š</p><p>è®¾è¦æ’åºçš„å…ƒç´ ä¸ªæ•°æ˜¯ nï¼š</p><p>å½“ n &lt;= 10 æ—¶ï¼Œé‡‡ç”¨ æ’å…¥æ’åº</p><p>å½“ n &gt; 10 æ—¶ï¼Œé‡‡ç”¨ï¼š<strong>ä¸‰è·¯å¿«é€Ÿæ’åº</strong></p><ul><li>10 &lt; n &lt;= 1000, é‡‡ç”¨ä¸­ä½æ•°ä½œä¸ºå“¨å…µå…ƒç´ </li><li>n &gt; 1000, æ¯éš” 200~215 ä¸ªå…ƒç´ æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œæ”¾åˆ°ä¸€ä¸ªæ–°æ•°ç»„ï¼Œç„¶åå¯¹å®ƒæ’åºï¼Œæ‰¾åˆ°ä¸­é—´ä½ç½®çš„æ•°ï¼Œä»¥æ­¤ä½œä¸ºä¸­ä½æ•°</li></ul><p>åœ¨åŠ¨æ‰‹ä¹‹å‰ï¼Œæˆ‘è§‰å¾—æˆ‘ä»¬æœ‰å¿…è¦ä¸ºä»€ä¹ˆè¿™ä¹ˆåšææ¸…æ¥šã€‚</p><p><strong>ç¬¬ä¸€ã€ä¸ºä»€ä¹ˆå…ƒç´ ä¸ªæ•°å°‘çš„æ—¶å€™è¦é‡‡ç”¨æ’å…¥æ’åºï¼Ÿ</strong></p><p>è™½ç„¶ æ’å…¥æ’åº ç†è®ºä¸Šè¯´æ˜¯ O(n^2)çš„ç®—æ³•ï¼Œ å¿«é€Ÿæ’åº æ˜¯ä¸€ä¸ª O(nlogn)çº§åˆ«çš„ç®—æ³•ã€‚ä½†æ˜¯åˆ«å¿˜äº†ï¼Œè¿™åªæ˜¯ç†è®ºä¸Šçš„ä¼°ç®—ï¼Œåœ¨å®é™…æƒ…å†µä¸­ä¸¤è€…çš„ç®—æ³•å¤æ‚åº¦å‰é¢éƒ½ä¼šæœ‰ä¸€ä¸ªç³»æ•°çš„ï¼Œ å½“ n è¶³å¤Ÿå°çš„æ—¶å€™ï¼Œå¿«é€Ÿæ’åº nlogn çš„ä¼˜åŠ¿ä¼šè¶Šæ¥è¶Šå°ï¼Œå€˜è‹¥æ’å…¥æ’åº O(n^2)å‰é¢çš„ç³»æ•°è¶³å¤Ÿå°ï¼Œé‚£ä¹ˆå°±ä¼šè¶…è¿‡å¿«æ’ã€‚è€Œäº‹å®ä¸Šæ­£æ˜¯å¦‚æ­¤ï¼Œ æ’å…¥æ’åº ç»è¿‡ä¼˜åŒ–ä»¥åå¯¹äºå°æ•°æ®é›†çš„æ’åºä¼šæœ‰éå¸¸ä¼˜è¶Šçš„æ€§èƒ½ï¼Œå¾ˆå¤šæ—¶å€™ç”šè‡³ä¼šè¶…è¿‡å¿«æ’ã€‚</p><p>å› æ­¤ï¼Œå¯¹äºå¾ˆå°çš„æ•°æ®é‡ï¼Œåº”ç”¨ æ’å…¥æ’åº æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„é€‰æ‹©ã€‚</p><p><strong>ç¬¬äºŒã€ä¸ºä»€ä¹ˆè¦èŠ±è¿™ä¹ˆå¤§çš„åŠ›æ°”é€‰æ‹©å“¨å…µå…ƒç´ ï¼Ÿ</strong></p><p>å› ä¸º å¿«é€Ÿæ’åº çš„æ€§èƒ½ç“¶é¢ˆåœ¨äºé€’å½’çš„æ·±åº¦ï¼Œæœ€åçš„æƒ…å†µæ˜¯æ¯æ¬¡çš„å“¨å…µéƒ½æ˜¯æœ€å°å…ƒç´ æˆ–è€…æœ€å¤§å…ƒç´ ï¼Œé‚£ä¹ˆè¿›è¡Œ partition(ä¸€è¾¹æ˜¯å°äºå“¨å…µçš„å…ƒç´ ï¼Œå¦ä¸€è¾¹æ˜¯å¤§äºå“¨å…µçš„å…ƒç´ )æ—¶ï¼Œå°±ä¼šæœ‰ä¸€è¾¹æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆè¿™ä¹ˆæ’ä¸‹å»ï¼Œé€’å½’çš„å±‚æ•°å°±è¾¾åˆ°äº† n, è€Œæ¯ä¸€å±‚çš„å¤æ‚åº¦æ˜¯ O(n)ï¼Œå› æ­¤å¿«æ’è¿™æ—¶å€™ä¼šé€€åŒ–æˆ O(n^2)çº§åˆ«ã€‚</p><p><strong>è¿™ç§æƒ…å†µæ˜¯è¦å°½åŠ›é¿å…çš„ï¼å¦‚æœæ¥é¿å…ï¼Ÿ</strong></p><p>å°±æ˜¯è®©å“¨å…µå…ƒç´ è¿›å¯èƒ½åœ°å¤„äºæ•°ç»„çš„ä¸­é—´ä½ç½®ï¼Œè®©æœ€å¤§æˆ–è€…æœ€å°çš„æƒ…å†µå°½å¯èƒ½å°‘ã€‚è¿™æ—¶å€™ï¼Œä½ å°±èƒ½ç†è§£ V8 é‡Œé¢æ‰€åšçš„ç§ç§ä¼˜åŒ–äº†ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥ä¸€æ­¥æ­¥å®ç°çš„è¿™æ ·çš„å®˜æ–¹æ’åºç®—æ³•ã€‚</p><h4 id="æ’å…¥æ’åºåŠä¼˜åŒ–" tabindex="-1">æ’å…¥æ’åºåŠä¼˜åŒ– <a class="header-anchor" href="#æ’å…¥æ’åºåŠä¼˜åŒ–" aria-label="Permalink to &quot;æ’å…¥æ’åºåŠä¼˜åŒ–&quot;">â€‹</a></h4><p>æœ€åˆçš„æ’å…¥æ’åºå¯èƒ½æ˜¯è¿™æ ·å†™çš„ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> insertSort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">start</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">end</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">	end</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> end</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> start</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> end</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> j</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E06C75;"> start</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">&gt;</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">]; </span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> temp</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> temp</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>çœ‹ä¼¼å¯ä»¥æ­£ç¡®çš„å®Œæˆæ’åºï¼Œä½†å®é™…ä¸Šäº¤æ¢å…ƒç´ ä¼šæœ‰ç›¸å½“å¤§çš„æ€§èƒ½æ¶ˆè€—ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨å˜é‡è¦†ç›–çš„æ–¹å¼æ¥å®Œæˆï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="`+E+`" alt="image-20240318201035211"></p><p>ä¼˜åŒ–åä»£ç å¦‚ä¸‹ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> insertSort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">start</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">end</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">	end</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> end</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> start</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> end</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> e</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> j</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E06C75;"> start</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">&gt;</span><span style="color:#E06C75;"> e</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">) </span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">		arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> e</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>æ¥ä¸‹æ¥æ­£å¼è¿›å…¥åˆ° sort æ–¹æ³•ã€‚</p><h4 id="å¯»æ‰¾å“¨å…µå…ƒç´ " tabindex="-1">å¯»æ‰¾å“¨å…µå…ƒç´  <a class="header-anchor" href="#å¯»æ‰¾å“¨å…µå…ƒç´ " aria-label="Permalink to &quot;å¯»æ‰¾å“¨å…µå…ƒç´ &quot;">â€‹</a></h4><p>sort çš„éª¨æ¶å¤§è‡´å¦‚ä¸‹ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">comparefn</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> array</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> length</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#61AFEF;"> InnerArraySort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">comparefn</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> InnerArraySort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">length</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">comparefn</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ¯”è¾ƒå‡½æ•°æœªä¼ å…¥</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">toString</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">callbackfn</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!==</span><span style="color:#98C379;"> &quot;[object Function]&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">		comparefn</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">x</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> y</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">			x</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> x</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">			y</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> y</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">x</span><span style="color:#56B6C2;"> ==</span><span style="color:#E06C75;"> y</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			else</span><span style="color:#C678DD;"> return</span><span style="color:#E06C75;"> x</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> y</span><span style="color:#C678DD;"> ?</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span><span style="color:#C678DD;"> :</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		};</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#61AFEF;"> insertSort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//...</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#61AFEF;"> getThirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">to</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å…ƒç´ ä¸ªæ•°å¤§äº1000æ—¶å¯»æ‰¾å“¨å…µå…ƒç´ </span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#61AFEF;"> quickSort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">to</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//å“¨å…µä½ç½®</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> thirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		while</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> &lt;=</span><span style="color:#D19A66;"> 10</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">				insertSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">				thirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> getThirdIndex</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// å°äº1000 ç›´æ¥å–ä¸­ç‚¹</span></span>
<span class="line"><span style="color:#E06C75;">				thirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> ((</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&gt;&gt;</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// ä¸‹é¢å¼€å§‹å¿«æ’</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>å…ˆæ¥æŠŠæ±‚å–å“¨å…µä½ç½®çš„ä»£ç å®ç°ä¸€ä¸‹ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> getThirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">to</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> tmpArr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> increment</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 200</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> ((</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&amp;</span><span style="color:#D19A66;"> 15</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> j</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">	from</span><span style="color:#56B6C2;"> +=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">	to</span><span style="color:#56B6C2;"> -=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> from</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> to</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> +=</span><span style="color:#E06C75;"> increment</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		tmpArr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]];</span></span>
<span class="line"><span style="color:#E06C75;">		j</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æŠŠä¸´æ—¶æ•°ç»„æ’åºï¼Œå–ä¸­é—´çš„å€¼ï¼Œç¡®ä¿å“¨å…µçš„å€¼æ¥è¿‘å¹³å‡ä½ç½®</span></span>
<span class="line"><span style="color:#E5C07B;">	tmpArr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sort</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#61AFEF;"> comparefn</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> thirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> tmpArr</span><span style="color:#ABB2BF;">[</span><span style="color:#E5C07B;">tmpArr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> thirdIndex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="å®Œæˆå¿«æ’" tabindex="-1">å®Œæˆå¿«æ’ <a class="header-anchor" href="#å®Œæˆå¿«æ’" aria-label="Permalink to &quot;å®Œæˆå¿«æ’&quot;">â€‹</a></h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®Œæˆå¿«æ’çš„å…·ä½“ä»£ç ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> _sort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">c</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">c</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#61AFEF;">	insertSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> quickSort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">to</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//...</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ä¸Šé¢æˆ‘ä»¬æ‹¿åˆ°äº†thirdIndex</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ç°åœ¨æˆ‘ä»¬æ‹¥æœ‰ä¸‰ä¸ªå…ƒç´ ï¼Œfrom, thirdIndex, to</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ä¸ºäº†å†æ¬¡ç¡®ä¿ thirdIndex ä¸æ˜¯æœ€å€¼ï¼ŒæŠŠè¿™ä¸‰ä¸ªå€¼æ’åº</span></span>
<span class="line"><span style="color:#ABB2BF;">	[</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">]] </span><span style="color:#56B6C2;">=</span><span style="color:#61AFEF;"> _sort</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;">		a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#E06C75;">		a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#E06C75;">		a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">	);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ç°åœ¨æ­£å¼æŠŠ thirdIndex ä½œä¸ºå“¨å…µ</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> pivot</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ­£å¼è¿›å…¥å¿«æ’</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> lowEnd</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> highStart</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> to</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ç°åœ¨æ­£å¼æŠŠ thirdIndex ä½œä¸ºå“¨å…µ, å¹¶ä¸”lowEndå’ŒthirdIndexäº¤æ¢</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> pivot</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">	a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">	a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> pivot</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// [lowEnd, i)çš„å…ƒç´ æ˜¯å’Œpivotç›¸ç­‰çš„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// [i, highStart) çš„å…ƒç´ æ˜¯éœ€è¦å¤„ç†çš„</span></span>
<span class="line"><span style="color:#C678DD;">	for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> lowEnd</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> highStart</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> element</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> order</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> comparefn</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">element</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">pivot</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">order</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">			a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> element</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">			lowEnd</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">order</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			do</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">				highStart</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">				if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">highStart</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">				order</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> comparefn</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">highStart</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">pivot</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">order</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// ç°åœ¨ a[highStart] &lt;= pivot</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// a[i] &gt; pivot</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// ä¸¤è€…äº¤æ¢</span></span>
<span class="line"><span style="color:#E06C75;">			a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">highStart</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">highStart</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> element</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">order</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// a[i] å’Œ a[lowEnd] äº¤æ¢</span></span>
<span class="line"><span style="color:#E06C75;">				element</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">				a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">				a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> element</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">				lowEnd</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ°¸è¿œåˆ‡åˆ†å¤§åŒºé—´</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">lowEnd</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E06C75;"> to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> highStart</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// ç»§ç»­åˆ‡åˆ†lowEnd ~ from è¿™ä¸ªåŒºé—´</span></span>
<span class="line"><span style="color:#E06C75;">		to</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> lowEnd</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å•ç‹¬å¤„ç†å°åŒºé—´</span></span>
<span class="line"><span style="color:#61AFEF;">		quickSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">highStart</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">lowEnd</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> &lt;=</span><span style="color:#E06C75;"> to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> highStart</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		from</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> highStart</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#61AFEF;">		quickSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><h3 id="æµ‹è¯•ç»“æœ" tabindex="-1">æµ‹è¯•ç»“æœ <a class="header-anchor" href="#æµ‹è¯•ç»“æœ" aria-label="Permalink to &quot;æµ‹è¯•ç»“æœ&quot;">â€‹</a></h3><p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p><p>ä¸€ä¸‡æ¡æ•°æ®ï¼š</p><p><img src="`+u+'" alt="image-20240318201748272"></p><p>åä¸‡æ¡æ•°æ®ï¼š</p><p><img src="'+m+'" alt="image-20240318201805973"></p><p>ä¸€ç™¾ä¸‡æ¡æ•°æ®ï¼š</p><p><img src="'+D+'" alt="image-20240318201819837"></p><p>ä¸€åƒä¸‡æ¡æ•°æ®ï¼š</p><p><img src="'+d+`" alt="image-20240318201831357"></p><p>ç»“æœä»…ä¾›å¤§å®¶å‚è€ƒï¼Œå› ä¸ºä¸åŒçš„ node ç‰ˆæœ¬å¯¹äºéƒ¨åˆ†ç»†èŠ‚çš„å®ç°å¯èƒ½ä¸ä¸€æ ·ï¼Œæˆ‘ç°åœ¨çš„ç‰ˆæœ¬æ˜¯ v10.15ã€‚</p><p>ä»ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œç›®å‰ç‰ˆæœ¬çš„ node å¯¹äºæœ‰åºç¨‹åº¦è¾ƒé«˜çš„æ•°æ®æ˜¯å¤„ç†çš„ä¸å¤Ÿå¥½çš„ï¼Œè€Œæˆ‘ä»¬åˆšåˆšå®ç°çš„æ’åºé€šè¿‡åå¤ç¡®å®šå“¨å…µçš„ä½ç½®å°±èƒ½ æœ‰æ•ˆçš„è§„é¿å¿«æ’åœ¨è¿™ä¸€åœºæ™¯ä¸‹çš„åŠ£åŠ¿ã€‚</p><p>æœ€åç»™å¤§å®¶å®Œæ•´ç‰ˆçš„ sort ä»£ç ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> sort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">comparefn</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> array</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> length</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> array</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#61AFEF;"> InnerArraySort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">comparefn</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> InnerArraySort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">length</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">comparefn</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ¯”è¾ƒå‡½æ•°æœªä¼ å…¥</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Object</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">toString</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">comparefn</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">!==</span><span style="color:#98C379;"> &quot;[object Function]&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">		comparefn</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">x</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">y</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">x</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> y</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">			x</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> x</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">			y</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> y</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toString</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">x</span><span style="color:#56B6C2;"> ==</span><span style="color:#E06C75;"> y</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			else</span><span style="color:#C678DD;"> return</span><span style="color:#E06C75;"> x</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> y</span><span style="color:#C678DD;"> ?</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;">1</span><span style="color:#C678DD;"> :</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		};</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#61AFEF;"> insertSort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">start</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">end</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">		end</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> end</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> start</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> end</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> e</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> j</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			for</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E06C75;"> start</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#61AFEF;"> comparefn</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;">				arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> e</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#61AFEF;"> getThirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">to</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> tmpArr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// é€’å¢é‡ï¼Œ200~215 ä¹‹é—´ï¼Œå› ä¸ºä»»ä½•æ­£æ•°å’Œ15åšä¸æ“ä½œï¼Œä¸ä¼šè¶…è¿‡15ï¼Œå½“ç„¶æ˜¯å¤§äº0çš„</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> increment</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 200</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> ((</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&amp;</span><span style="color:#D19A66;"> 15</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> j</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">		from</span><span style="color:#56B6C2;"> +=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">		to</span><span style="color:#56B6C2;"> -=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> from</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> to</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> +=</span><span style="color:#E06C75;"> increment</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">			tmpArr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">j</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">]];</span></span>
<span class="line"><span style="color:#E06C75;">			j</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// æŠŠä¸´æ—¶æ•°ç»„æ’åºï¼Œå–ä¸­é—´çš„å€¼ï¼Œç¡®ä¿å“¨å…µçš„å€¼æ¥è¿‘å¹³å‡ä½ç½®</span></span>
<span class="line"><span style="color:#E5C07B;">		tmpArr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sort</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			return</span><span style="color:#61AFEF;"> comparefn</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> thirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> tmpArr</span><span style="color:#ABB2BF;">[</span><span style="color:#E5C07B;">tmpArr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> &gt;&gt;</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">][</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> thirdIndex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#61AFEF;"> _sort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">c</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#E5C07B;">		arr</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">c</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">		insertSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> arr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#61AFEF;"> quickSort</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">to</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//å“¨å…µä½ç½®</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> thirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		while</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> &lt;=</span><span style="color:#D19A66;"> 10</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">				insertSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 1000</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">				thirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> getThirdIndex</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// å°äº1000 ç›´æ¥å–ä¸­ç‚¹</span></span>
<span class="line"><span style="color:#E06C75;">				thirdIndex</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> ((</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">&gt;&gt;</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> tmpArr</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> _sort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#E06C75;">			a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> tmpArr</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> tmpArr</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">to</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> tmpArr</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// ç°åœ¨æ­£å¼æŠŠ thirdIndex ä½œä¸ºå“¨å…µ</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> pivot</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">			[</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">]] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">]];</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// æ­£å¼è¿›å…¥å¿«æ’</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> lowEnd</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> highStart</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> to</span><span style="color:#56B6C2;"> -</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">			a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">thirdIndex</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">			a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> pivot</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// [lowEnd, i)çš„å…ƒç´ æ˜¯å’Œpivotç›¸ç­‰çš„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// [i, highStart) çš„å…ƒç´ æ˜¯éœ€è¦å¤„ç†çš„</span></span>
<span class="line"><span style="color:#C678DD;">			for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> lowEnd</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> highStart</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">				let</span><span style="color:#E06C75;"> element</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">				let</span><span style="color:#E06C75;"> order</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> comparefn</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">element</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">pivot</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">order</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">					a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">					a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> element</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">					lowEnd</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">				} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">order</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">					do</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">						highStart</span><span style="color:#56B6C2;">--</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">						if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">highStart</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">						order</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> comparefn</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">highStart</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">pivot</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">					} </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">order</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">					// ç°åœ¨ a[highStart] &lt;= pivot</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">					// a[i] &gt; pivot</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">					// ä¸¤è€…äº¤æ¢</span></span>
<span class="line"><span style="color:#E06C75;">					a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">highStart</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">					a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">highStart</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> element</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">					if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">order</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">						// a[i] å’Œ a[lowEnd] äº¤æ¢</span></span>
<span class="line"><span style="color:#E06C75;">						element</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">						a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#E06C75;">						a</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> element</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">						lowEnd</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// æ°¸è¿œåˆ‡åˆ†å¤§åŒºé—´</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">lowEnd</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> &gt;</span><span style="color:#E06C75;"> to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> highStart</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// å•ç‹¬å¤„ç†å°åŒºé—´</span></span>
<span class="line"><span style="color:#61AFEF;">				quickSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">highStart</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">to</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// ç»§ç»­åˆ‡åˆ†lowEnd ~ from è¿™ä¸ªåŒºé—´</span></span>
<span class="line"><span style="color:#E06C75;">				to</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> lowEnd</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">lowEnd</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> from</span><span style="color:#56B6C2;"> &lt;=</span><span style="color:#E06C75;"> to</span><span style="color:#56B6C2;"> -</span><span style="color:#E06C75;"> highStart</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">				quickSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">from</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">lowEnd</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E06C75;">				from</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> highStart</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#61AFEF;">	quickSort</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">array</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br></div></div><h2 id="_5-æ‰‹å†™å®ç°å‡½æ•°çš„-callã€applyã€bind-æ–¹æ³•" tabindex="-1">5.æ‰‹å†™å®ç°å‡½æ•°çš„ callã€applyã€bind æ–¹æ³• <a class="header-anchor" href="#_5-æ‰‹å†™å®ç°å‡½æ•°çš„-callã€applyã€bind-æ–¹æ³•" aria-label="Permalink to &quot;5.æ‰‹å†™å®ç°å‡½æ•°çš„ callã€applyã€bind æ–¹æ³•&quot;">â€‹</a></h2><h3 id="call-æ–¹æ³•å®ç°" tabindex="-1">call æ–¹æ³•å®ç° <a class="header-anchor" href="#call-æ–¹æ³•å®ç°" aria-label="Permalink to &quot;call æ–¹æ³•å®ç°&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰‹å†™è‡ªå·±çš„callæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">thisArg</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ...argsï¼š...æŠŠå‰©ä½™å‚æ•°argså±•å¼€</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 1.è·å–éœ€è¦è¢«æ‰§è¡Œçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 2.å¯¹thisArgè½¬æˆå¯¹è±¡ç±»å‹ï¼ˆé˜²æ­¢å®ƒä¼ å…¥çš„æ˜¯éå¯¹è±¡ç±»å‹ï¼‰</span></span>
<span class="line"><span style="color:#E06C75;">	thisArg</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> thisArg</span><span style="color:#C678DD;"> ?</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">thisArg</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 3.æ‰§è¡Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå¯¹è±¡</span></span>
<span class="line"><span style="color:#E5C07B;">	thisArg</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> fn</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> thisArg</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// ä¼ å…¥å‰©ä½™å‚æ•°ï¼Œæ‰§è¡ŒthisæŒ‡å‘çš„å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E06C75;"> thisArg</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// åˆ é™¤å‚æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 4.è¿”å›ç»“æœ</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç¤ºä¾‹å‡½æ•°1</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> foo</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;fooå‡½æ•°è¢«æ‰§è¡Œ&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç¤ºä¾‹å‡½æ•°2</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> sum</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">num1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">num2</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> num1</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> num2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç³»ç»Ÿå†…ç½®callæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">undefined</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> sumResult1</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> sum</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">({}, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">sumResult1</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// è‡ªå·±å®ç°çš„callæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">123</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">({ </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å“ˆå“ˆ&quot;</span><span style="color:#ABB2BF;"> });</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å‘µå‘µ&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCall</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> sumResult2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> sum</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">({}, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">sumResult2</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="apply-æ–¹æ³•å®ç°" tabindex="-1">apply æ–¹æ³•å®ç° <a class="header-anchor" href="#apply-æ–¹æ³•å®ç°" aria-label="Permalink to &quot;apply æ–¹æ³•å®ç°&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰‹å†™è‡ªå·±çš„applyæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">thisArg</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">argArray</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 1.è·å–éœ€è¦è¢«æ‰§è¡Œçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 2.åˆ¤æ–­å‚æ•°å¯¹è±¡æ˜¯ä»€ä¹ˆæ•°å€¼ï¼Œè¿›è¡Œè½¬æ¢ï¼Œæˆ–è€…æŒ‡å‘å…¨å±€</span></span>
<span class="line"><span style="color:#E06C75;">	thisArg</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#E06C75;">		thisArg</span><span style="color:#56B6C2;"> !==</span><span style="color:#D19A66;"> null</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E06C75;"> thisArg</span><span style="color:#56B6C2;"> !==</span><span style="color:#D19A66;"> undefined</span><span style="color:#C678DD;"> ?</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">thisArg</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 3.æ‰§è¡Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå¯¹è±¡</span></span>
<span class="line"><span style="color:#E5C07B;">	thisArg</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> fn</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// ***** åˆ¤æ–­æ˜¯å¦ä¼ äº†ç¬¬äºŒä¸ªæ•°ç»„å‚æ•° *****</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ–¹æ³•1ï¼š</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// var res;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// if(!argArray) { // æ²¡æœ‰ä¼ ç¬¬äºŒä¸ªå‚æ•°argArray</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//     res = thisArg.fn();</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// } else{ // æœ‰ä¼ å‚æ•°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//     res = thisArg.fn(...argArray);// å±•å¼€ä¼ å…¥å‰©ä½™æ•°ç»„å‚æ•°ï¼Œæ‰§è¡ŒthisæŒ‡å‘çš„å‡½æ•°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ–¹æ³•2ï¼š</span></span>
<span class="line"><span style="color:#E06C75;">	argArray</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> argArray</span><span style="color:#C678DD;"> ?</span><span style="color:#E06C75;"> argArray</span><span style="color:#C678DD;"> :</span><span style="color:#ABB2BF;"> []; </span><span style="color:#7F848E;font-style:italic;">// å¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±é»˜è®¤èµ‹å€¼ç©ºæ•°ç»„ç»™ç¬¬äºŒä¸ªå‚æ•°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// argArray = argArray || []; // é€»è¾‘æˆ–åˆ¤æ–­æ›¿ä»£ä¸‰å…ƒè¿ç®—ğŸ‘†</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> thisArg</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">argArray</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// å±•å¼€ä¼ å…¥å‰©ä½™æ•°ç»„å‚æ•°ï¼Œæ‰§è¡ŒthisæŒ‡å‘çš„å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	delete</span><span style="color:#E5C07B;"> thisArg</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// åˆ é™¤å‚æ•°å±æ€§</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 4.è¿”å›ç»“æœ</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç¤ºä¾‹å‡½æ•°1</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> sum</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">num1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">num2</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> num1</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> num2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç¤ºä¾‹å‡½æ•°2</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> foo</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">num</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> num</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç¤ºä¾‹å‡½æ•°3</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> bar</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;barå‡½æ•°è¢«æ‰§è¡Œ&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç³»ç»Ÿå†…ç½®applyæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">undefined</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> sumResult1</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> sum</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">apply</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;abc&quot;</span><span style="color:#ABB2BF;">, [</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">sumResult1</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// è‡ªå·±å®ç°çš„callæ–¹æ³•</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">123</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#ABB2BF;">({ </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;å“ˆå“ˆ&quot;</span><span style="color:#ABB2BF;"> });</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å‘µå‘µ&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç¬¬äºŒç§æƒ…å†µï¼šæ•°ç»„å‚æ•°</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> sumResult2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> sum</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;å˜¿å˜¿&quot;</span><span style="color:#ABB2BF;">, [</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">sumResult2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç¬¬ä¸‰ç§æƒ…å†µï¼šæ²¡æœ‰å‚æ•°</span></span>
<span class="line"><span style="color:#E5C07B;">bar</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myApply</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;abcBar&quot;</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><h3 id="bind-æ–¹æ³•å®ç°" tabindex="-1">bind æ–¹æ³•å®ç° <a class="header-anchor" href="#bind-æ–¹æ³•å®ç°" aria-label="Permalink to &quot;bind æ–¹æ³•å®ç°&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰‹å†™è‡ªå·±çš„bindæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;">Function</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myBind</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">thisArg</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;font-style:italic;">argArray</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 1.è·å–éœ€è¦è¢«æ‰§è¡Œçš„å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 2.åˆ¤æ–­å‚æ•°å¯¹è±¡æ˜¯ä»€ä¹ˆæ•°å€¼ï¼Œè¿›è¡Œè½¬æ¢ï¼Œæˆ–è€…æŒ‡å‘å…¨å±€</span></span>
<span class="line"><span style="color:#E06C75;">	thisArg</span><span style="color:#56B6C2;"> =</span></span>
<span class="line"><span style="color:#E06C75;">		thisArg</span><span style="color:#56B6C2;"> !==</span><span style="color:#D19A66;"> null</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E06C75;"> thisArg</span><span style="color:#56B6C2;"> !==</span><span style="color:#D19A66;"> undefined</span><span style="color:#C678DD;"> ?</span><span style="color:#61AFEF;"> Object</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">thisArg</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">:</span><span style="color:#E06C75;"> window</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è¿”å›å‡ºå»çš„å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	function</span><span style="color:#61AFEF;"> proxyFn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">		thisArg</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> fn</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// å¯¹ä¸¤ä¸ªä¼ å…¥çš„å‚æ•°è¿›è¡Œåˆå¹¶</span></span>
<span class="line"><span style="color:#C678DD;">		var</span><span style="color:#E06C75;"> finalArgs</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [...</span><span style="color:#E06C75;">argArrar</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">		var</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> thisArg</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">finalArgs</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// å±•å¼€æ•°ç»„å‚æ•° ä¼ å…¥</span></span>
<span class="line"><span style="color:#C678DD;">		delete</span><span style="color:#E5C07B;"> thisArg</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// åˆ é™¤å‚æ•°å±æ€§</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// 4.è¿”å›å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> proxyFn</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç¤ºä¾‹å‡½æ•°1</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> sum</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">num1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">num2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">num3</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">num4</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">num1</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> num2</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> num3</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> num4</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç¤ºä¾‹å‡½æ•°2</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> foo</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;fooå‡½æ•°è¢«æ‰§è¡Œ&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#D19A66;"> 20</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç³»ç»Ÿå†…ç½®çš„bindæ–¹æ³•ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// è‡ªå·±æ‰‹å†™å®ç°çš„bindæ–¹æ³•ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> bar</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> foo</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myBind</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;abc&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> bar</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">cosole</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> newSum</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> sum</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myBind</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;abc&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> numRes</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> newSum</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">cosole</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">numRes</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h2 id="_7-å®ç°ç»§æ‰¿" tabindex="-1">7.å®ç°ç»§æ‰¿ <a class="header-anchor" href="#_7-å®ç°ç»§æ‰¿" aria-label="Permalink to &quot;7.å®ç°ç»§æ‰¿&quot;">â€‹</a></h2><p>è¯´å‡ºä¸­â¼¼æ€æƒ³ï¼Œè€Œä¸æ˜¯åˆ—ä¸¾è¢«åšå®¢ç‚’äº†ã‡éâ¼œã‡éçš„å†·é¥­ã€‚</p><p>å®ç°ç»§æ‰¿æœ‰ä¸¤ä¸ªæ–¹é¢è¦è€ƒè™‘ï¼Œã‡ä¸ªæ˜¯åŸå‹å±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿ï¼Œå¦ã‡ä¸ªæ˜¯æ„é€ å™¨çš„ç»§æ‰¿ã€‚</p><h3 id="es5-ç»§æ‰¿-å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿" tabindex="-1"><strong>ES5</strong> ç»§æ‰¿ï¼ˆå¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼‰ <a class="header-anchor" href="#es5-ç»§æ‰¿-å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿" aria-label="Permalink to &quot;**ES5** ç»§æ‰¿ï¼ˆå¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼‰&quot;">â€‹</a></h3><p>å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿æ˜¯å¯¹ç»„åˆå¼ç»§æ‰¿ï¼ˆè°ƒç”¨äº† 2 æ¬¡çˆ¶æ„é€ æ–¹æ³•ï¼‰çš„æ”¹è¿›ï¼Œä½¿ç”¨çˆ¶ç±»çš„åŸå‹çš„å‰¯æœ¬æ¥ä½œä¸ºå­ç±»çš„åŸå‹ï¼Œè¿™æ ·å°±åªè°ƒç”¨ä¸€æ¬¡çˆ¶æ„é€ å‡½æ•°ï¼Œé¿å…äº†åˆ›å»ºä¸å¿…è¦çš„å±æ€§ã€‚</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> Parent</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> name</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">colors</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span><span style="color:#98C379;">&quot;red&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;blue&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;green&quot;</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#E5C07B;">Parent</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getName</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> Child</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	Parent</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//å€Ÿç”¨æ„é€ å‡½æ•°çš„æ–¹å¼æ¥å®ç°å±æ€§çš„ç»§æ‰¿å’Œä¼ å‚</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> age</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//è¿™é‡Œä¸ç”¨Child.prototype = new Parent()åŸå‹é“¾æ–¹å¼çš„åŸå› æ˜¯ä¼šè°ƒç”¨2æ¬¡çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œå¯¼è‡´å­ç±»çš„åŸå‹ä¸Šå¤šäº†ä¸éœ€è¦çš„çˆ¶ç±»å±æ€§</span></span>
<span class="line"><span style="color:#E5C07B;">Child</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Parent</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//è¿™é‡Œå°±æ˜¯å¯¹ç»„åˆç»§æ‰¿çš„æ”¹è¿›,åˆ›å»ºäº†çˆ¶ç±»åŸå‹çš„å‰¯æœ¬</span></span>
<span class="line"><span style="color:#E5C07B;">Child</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">constructor</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> Child</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">//æŠŠå­ç±»çš„æ„é€ æŒ‡å‘å­ç±»æœ¬èº«</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> child1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Child</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;AKã€dadada&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;18&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">child1</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">colors</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//[ &#39;red&#39;, &#39;blue&#39;, &#39;green&#39; ]</span></span>
<span class="line"><span style="color:#E5C07B;">child1</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getName</span><span style="color:#ABB2BF;">(); </span><span style="color:#7F848E;font-style:italic;">//AKã€dadada</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="`+f+`" alt="Snipaste_2024-02-20_16-26-50.png"></p><p>å®ç° 2</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> create</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">proto</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	function</span><span style="color:#61AFEF;"> F</span><span style="color:#ABB2BF;">() {}</span></span>
<span class="line"><span style="color:#E5C07B;">	F</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> proto</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> F</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Parent</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> Parent</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> name</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">Parent</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sayName</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Child</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> Child</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">	Parent</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> age</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#E5C07B;">Child</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> create</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Parent</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">Child</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">constructor</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> Child</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">Child</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sayAge</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æµ‹è¯•</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> child</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Child</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;Jack&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sayName</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">sayAge</span><span style="color:#ABB2BF;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="es6-ç»§æ‰¿" tabindex="-1">ES6 ç»§æ‰¿ <a class="header-anchor" href="#es6-ç»§æ‰¿" aria-label="Permalink to &quot;ES6 ç»§æ‰¿&quot;">â€‹</a></h3><p>åœ¨ ES6 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ class ç±»å»å®ç°ç»§æ‰¿ã€‚ä½¿ç”¨ extends è¡¨æ˜ç»§æ‰¿è‡ªå“ªä¸ªçˆ¶ç±»ï¼Œå¹¶ä¸”åœ¨å­ç±»æ„é€ å‡½æ•°ä¸­å¿…é¡»è°ƒç”¨ superã€‚</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> Parent</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	constructor</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">		this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> name</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#61AFEF;">	getName</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> Child</span><span style="color:#C678DD;"> extends</span><span style="color:#E5C07B;"> Parent</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	constructor</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">age</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//ä½¿ç”¨thisä¹‹å‰å¿…é¡»å…ˆè°ƒç”¨super(),å®ƒè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°å¹¶ç»‘å®šçˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•</span></span>
<span class="line"><span style="color:#E5C07B;font-style:italic;">		super</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		//ä¹‹åå­ç±»çš„æ„é€ å‡½æ•°å†è¿›ä¸€æ­¥è®¿é—®å’Œä¿®æ”¹ this</span></span>
<span class="line"><span style="color:#E5C07B;">		this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> age</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æµ‹è¯•</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> child</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Child</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;AKã€dadada&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">18</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// AKã€dadada</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">age</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 18</span></span>
<span class="line"><span style="color:#E5C07B;">child</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getName</span><span style="color:#ABB2BF;">(); </span><span style="color:#7F848E;font-style:italic;">// AKã€dadada</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="`+g+`" alt="Snipaste_2024-02-20_16-25-42.png"></p><h3 id="es5-ç»§æ‰¿å’Œ-es6-ç»§æ‰¿çš„åŒºåˆ«" tabindex="-1">ES5 ç»§æ‰¿å’Œ ES6 ç»§æ‰¿çš„<strong>åŒºåˆ«</strong>ï¼š <a class="header-anchor" href="#es5-ç»§æ‰¿å’Œ-es6-ç»§æ‰¿çš„åŒºåˆ«" aria-label="Permalink to &quot;ES5 ç»§æ‰¿å’Œ ES6 ç»§æ‰¿çš„**åŒºåˆ«**ï¼š&quot;">â€‹</a></h3><ul><li><code>ES5</code>ç»§æ‰¿æ˜¯å…ˆåˆ›å»ºå­ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åå†å°†çˆ¶ç±»æ–¹æ³•æ·»åŠ åˆ° thisï¼ˆ<code>Parent.call(this)</code>ï¼‰ä¸Šã€‚</li><li><code>ES6</code>çš„ç»§æ‰¿ä¸åŒï¼Œå®è´¨æ˜¯å…ˆå°†çˆ¶ç±»å®ä¾‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼ŒåŠ åˆ° this ä¸Šé¢ï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨ super æ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹ thisã€‚</li></ul><h2 id="_8-æ‰‹å†™å®ç°-promise" tabindex="-1">8.æ‰‹å†™å®ç° Promise <a class="header-anchor" href="#_8-æ‰‹å†™å®ç°-promise" aria-label="Permalink to &quot;8.æ‰‹å†™å®ç° Promise&quot;">â€‹</a></h2><h3 id="æ‰‹å†™å®ç°-promise" tabindex="-1">æ‰‹å†™å®ç° Promise <a class="header-anchor" href="#æ‰‹å†™å®ç°-promise" aria-label="Permalink to &quot;æ‰‹å†™å®ç° Promise&quot;">â€‹</a></h3><p>è¿™ä¸ªã‡èˆ¬ä¸ä¼šç›´æ¥å‡ºç°å§ï¼Œå› ä¸ºå¦‚æœæŒ‰ <a href="https://promisesaplus.com/" target="_blank" rel="noreferrer">Promise/A+è§„èŒƒ</a>æ¥ï¼Œä»£ç é‡ä¸å°‘ï¼Œå¦‚æœåšé¢˜æ—¶èƒ½æä¾› Promise/A+è§„èŒƒåŸæ–‡åšå‚è€ƒï¼Œåº”è¯¥æ˜¯èƒ½å†™å‡ºæ¥çš„ã€‚</p><p>æˆ‘å¯ä»¥è·Ÿé¢è¯•å®˜è¯´æˆ‘ github å·²ç»å†™è¿‡ã‡ä¸ªå®ç°äº†å—ï¼Ÿpromises-aplus-robin <a href="https://github.com/cumt-robin/promises-aplus-robin" target="_blank" rel="noreferrer">https://github.com/cumt-robin/promises-aplus-robin</a></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E06C75;">å¯ä»¥çœ‹åŒçº§çš„æ–‡æ¡£</span><span style="color:#ABB2BF;">ï¼šã€</span><span style="color:#E5C07B;">æ‰‹å†™Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">md</span><span style="color:#ABB2BF;">ã€‘</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="æ‰‹å†™-promise-prototype-catch" tabindex="-1">æ‰‹å†™ Promise.prototype.catch <a class="header-anchor" href="#æ‰‹å†™-promise-prototype-catch" aria-label="Permalink to &quot;æ‰‹å†™ Promise.prototype.catch&quot;">â€‹</a></h3><p>catch æ˜¯åŸºäº Promise.prototype.then å®ç°çš„ï¼Œæ‰€ä»¥å°±æœ‰ç‚¹ç®€å•äº†ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myCatch</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">onRejected</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">undefined</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">onRejected</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="æ‰‹å†™-promise-prototype-finally" tabindex="-1">æ‰‹å†™ Promise.prototype.finally <a class="header-anchor" href="#æ‰‹å†™-promise-prototype-finally" aria-label="Permalink to &quot;æ‰‹å†™ Promise.prototype.finally&quot;">â€‹</a></h3><p>è¿™ä¸ªæ˜¯æœ‰å¯èƒ½è€ƒçš„ï¼Œæ¯”å¦‚å¾®ä¿¡å°ç¨‹åºå°±ä¸æ”¯æŒ finallyã€‚å¯ä»¥åŸºäº .then æ¥å®ç°ï¼Œä¸ç®¡ fulfilled è¿˜æ˜¯ rejected éƒ½è¦æ‰§è¡Œ onFinallyã€‚</p><p>ä½†æ˜¯è¦æ³¨æ„ï¼Œä¸ç®¡å½“å‰ Promise çš„çŠ¶æ€æ˜¯ fulfilled è¿˜æ˜¯ rejectedï¼Œåªè¦åœ¨ onFinally ä¸­æ²¡æœ‰å‘ç”Ÿä»¥ä¸‹ä»»ä½•ä¸€æ¡æƒ…å†µï¼Œfinally æ–¹æ³•è¿”å›çš„æ–°çš„ Promise å®ä¾‹çš„çŠ¶æ€å°±ä¼šä¸å½“å‰ Promise çš„çŠ¶æ€ä¿æŒä¸€è‡´!</p><p>è¿™ä¹Ÿæ„å‘³ç€å³ä½¿åœ¨ onFinally ä¸­è¿”å›ä¸€ä¸ªçŠ¶æ€ä¸º fulfilled çš„ Promise ä¹Ÿä¸èƒ½é˜»æ­¢æ–°çš„ Promise å®ä¾‹é‡‡çº³å½“å‰ Promise çš„çŠ¶æ€æˆ–å€¼ï¼</p><ul><li>è¿”å›ä¸€ä¸ªçŠ¶æ€ä¸ºæˆ–å°†ä¸º rejected çš„ Promise</li><li>æŠ›å‡ºé”™è¯¯</li></ul><p>æ€»çš„æ¥è¯´ï¼Œåœ¨ finally æƒ…å†µä¸‹ï¼Œrejected ä¼˜å…ˆï¼</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">myFinally</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">onFinally</span><span style="color:#ABB2BF;">){</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">        value</span><span style="color:#C678DD;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">            return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">onFinally</span><span style="color:#ABB2BF;">()).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(()</span><span style="color:#C678DD;">=&gt;</span><span style="color:#E06C75;"> value</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;">        reason</span><span style="color:#C678DD;"> =&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">onFinally</span><span style="color:#ABB2BF;">()).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> { </span><span style="color:#C678DD;">throw</span><span style="color:#E06C75;"> reason</span><span style="color:#ABB2BF;"> }</span></span>
<span class="line"><span style="color:#ABB2BF;">	);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="æ‰‹å†™å®ç°-promise-all" tabindex="-1">æ‰‹å†™å®ç° Promise.all <a class="header-anchor" href="#æ‰‹å†™å®ç°-promise-all" aria-label="Permalink to &quot;æ‰‹å†™å®ç° Promise.all&quot;">â€‹</a></h3><p>è¿™ä¸ªä¸»è¦æ˜¯è€ƒå¯Ÿå¦‚ä½•æ”¶é›†æ¯ã‡ä¸ª Promise çš„çŠ¶æ€å˜åŒ–ï¼Œåœ¨æœ€åã‡ä¸ª Promise çŠ¶æ€å˜åŒ–æ—¶ï¼Œå¯¹å¤–å‘å‡ºä¿¡å·ã€‚</p><ul><li>åˆ¤æ–­ iterable æ˜¯å¦ç©º</li><li>åˆ¤æ–­ iterable æ˜¯å¦å…¨éƒ¨ä¸æ˜¯ Promise</li><li>éå†ï¼Œå¦‚æœæŸé¡¹æ˜¯ Promiseï¼Œåˆ©ç”¨ .then è·å–ç»“æœï¼Œå¦‚æœ fulfilledï¼Œå°† value å­˜åœ¨ values ä¸­ï¼Œå¹¶ç”¨ fulfillCount è®¡æ•°ï¼›å¦‚æœæ˜¯ rejectedï¼Œç›´æ¥ reject reasonã€‚</li><li>å¦‚æœæŸé¡¹ä¸æ˜¯ Promiseï¼Œç›´æ¥å°†å€¼å­˜èµ·æ¥ï¼Œå¹¶è®¡æ•°ã€‚</li><li>ç­‰æ‰€æœ‰å¼‚æ­¥éƒ½ fulfilledï¼ŒfulfillCount å¿…å°†æ˜¯ iterable çš„é•¿åº¦ï¼ˆåœ¨ onFulfilled ä¸­åˆ¤æ–­ fulfillCountï¼‰ï¼Œæ­¤æ—¶å¯ä»¥ resolve valuesã€‚</li></ul><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> PromiseAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// ä¼ å…¥å‚æ•°ä¸ºä¸€ä¸ªç©ºçš„å¯è¿­ä»£å¯¹è±¡ï¼Œç›´æ¥resolve</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">			resolve</span><span style="color:#ABB2BF;">([]);</span></span>
<span class="line"><span style="color:#ABB2BF;">		} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">			const</span><span style="color:#E5C07B;"> res</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> count</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				//ä¸ºä»€ä¹ˆä¸ç›´æ¥promise[i].then, å› ä¸ºpromise[i]å¯èƒ½ä¸æ˜¯ä¸€ä¸ªpromise, ä¹Ÿå¯èƒ½æ˜¯æ™®é€šå€¼</span></span>
<span class="line"><span style="color:#E5C07B;">				Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">promises</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">					.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">						res</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> data</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">						count</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">						if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">							resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//å¦‚æœæ‰€æœ‰Promiseéƒ½æˆåŠŸï¼Œåˆ™è¿”å›æˆåŠŸç»“æœæ•°ç»„</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">					})</span></span>
<span class="line"><span style="color:#ABB2BF;">					.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">						reject</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//å¦‚æœæœ‰ä¸€ä¸ªPromiseå¤±è´¥ï¼Œåˆ™è¿”å›è¿™ä¸ªå¤±è´¥ç»“æœ</span></span>
<span class="line"><span style="color:#ABB2BF;">					});</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æµ‹è¯•</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> promise1</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> promise2</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 4</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> promise3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;AKã€DADADA&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">PromiseAll</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">promise1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">promise2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">promise3</span><span style="color:#ABB2BF;">]).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">values</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">values</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//[5, 4, &quot;AKã€DADADA&quot;]</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="`+h+`" alt="Snipaste_2024-02-20_17-07-09.png"></p><p>æ–¹æ³• 2</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> PromiseAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		const</span><span style="color:#E5C07B;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> count</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		const</span><span style="color:#E5C07B;"> len</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;"> &lt;</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">; </span><span style="color:#E06C75;">i</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">			promises</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">				(</span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">					result</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> value</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">					count</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">					if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> ===</span><span style="color:#E06C75;"> len</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">						resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">result</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">				},</span></span>
<span class="line"><span style="color:#ABB2BF;">				(</span><span style="color:#E06C75;font-style:italic;">reason</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">					reject</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">reason</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#ABB2BF;">			);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Usage</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">PromiseAll</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">]).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">result</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">result</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// [1, 2, 3]</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>æ–¹æ³• 3ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> PromiseAll</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">iterable</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> tasks</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Array</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">from</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">iterable</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">tasks</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">([]);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#C678DD;">	if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">tasks</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">every</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">task</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#56B6C2;"> !</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">task</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">))) {</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">tasks</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		var</span><span style="color:#E06C75;"> values</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Array</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">tasks</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">fill</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">null</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		var</span><span style="color:#E06C75;"> fulfillCount</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">		tasks</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">task</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">arr</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">task</span><span style="color:#C678DD;"> instanceof</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">				task</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">					(</span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">						fulfillCount</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">						values</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">index</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> value</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">						if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">fulfillCount</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">							resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">values</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">					},</span></span>
<span class="line"><span style="color:#ABB2BF;">					(</span><span style="color:#E06C75;font-style:italic;">reason</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">						reject</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">reason</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">				);</span></span>
<span class="line"><span style="color:#ABB2BF;">			} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">				fulfillCount</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">				values</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">index</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> task</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="æ–¹æ³•-4" tabindex="-1">æ–¹æ³• 4 <a class="header-anchor" href="#æ–¹æ³•-4" aria-label="Permalink to &quot;æ–¹æ³• 4&quot;">â€‹</a></h4><h5 id="ä½•ä¸º-promise-all" tabindex="-1">ä½•ä¸º Promise.allï¼Ÿ <a class="header-anchor" href="#ä½•ä¸º-promise-all" aria-label="Permalink to &quot;ä½•ä¸º Promise.allï¼Ÿ&quot;">â€‹</a></h5><p><code>Promise.all</code> æ˜¯ es6 <code>Promise</code> å¯¹è±¡ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„åŠŸèƒ½å°±æ˜¯å°†å¤šä¸ª<code>Promise</code>å®ä¾‹åŒ…è£…æˆä¸€ä¸ª<code>promise</code>å®ä¾‹ã€‚ä»¥ä¸‹æ˜¯ MDN å¯¹ <code>Promise.all</code> çš„æè¿°ï¼š</p><blockquote><p>Promise.all() æ–¹æ³•æ¥æ”¶ä¸€ä¸ª promise çš„ iterable ç±»å‹ï¼ˆæ³¨ï¼šArrayï¼ŒMapï¼ŒSet éƒ½å±äº ES6 çš„ iterable ç±»å‹ï¼‰çš„è¾“å…¥ï¼Œå¹¶ä¸”åªè¿”å›ä¸€ä¸ª<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noreferrer"><code>Promise</code></a>å®ä¾‹ï¼Œ é‚£ä¸ªè¾“å…¥çš„æ‰€æœ‰ promise çš„ resolve å›è°ƒçš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚è¿™ä¸ª<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noreferrer"><code>Promise</code></a>çš„ resolve å›è°ƒæ‰§è¡Œæ˜¯åœ¨æ‰€æœ‰è¾“å…¥çš„ promise çš„ resolve å›è°ƒéƒ½ç»“æŸï¼Œæˆ–è€…è¾“å…¥çš„ iterable é‡Œæ²¡æœ‰ promise äº†çš„æ—¶å€™ã€‚å®ƒçš„ reject å›è°ƒæ‰§è¡Œæ˜¯ï¼Œåªè¦ä»»ä½•ä¸€ä¸ªè¾“å…¥çš„ promise çš„ reject å›è°ƒæ‰§è¡Œæˆ–è€…è¾“å…¥ä¸åˆæ³•çš„ promise å°±ä¼šç«‹å³æŠ›å‡ºé”™è¯¯ï¼Œå¹¶ä¸” reject çš„æ˜¯ç¬¬ä¸€ä¸ªæŠ›å‡ºçš„é”™è¯¯ä¿¡æ¯ã€‚</p></blockquote><p>æˆ‘æˆ´ä¸Šæˆ‘çš„ 300 åº¦è¿‘è§†çœ¼é•œï¼Œä»”ç»†åœ°æå–å‡ºè¿™æ®µæè¿°ä¸­çš„<strong>å…³é”®å­—</strong>ï¼š</p><ol><li><code>Promise.all</code> çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°çš„ <code>Promise</code> å®ä¾‹ã€‚</li><li><code>Promise.all</code> æ¥å—ä¸€ä¸ªå¯éå†çš„æ•°æ®å®¹å™¨ï¼Œå®¹å™¨ä¸­æ¯ä¸ªå…ƒç´ éƒ½åº”æ˜¯ <code>Promise</code> å®ä¾‹ã€‚å’±å°±æ˜¯è¯´ï¼Œå‡è®¾è¿™ä¸ªå®¹å™¨å°±æ˜¯æ•°ç»„ã€‚</li><li>æ•°ç»„ä¸­æ¯ä¸ª <code>Promise</code> å®ä¾‹éƒ½æˆåŠŸæ—¶ï¼ˆç”±<code>pendding</code>çŠ¶æ€è½¬åŒ–ä¸º<code>fulfilled</code>çŠ¶æ€ï¼‰ï¼Œ<code>Promise.all</code> æ‰æˆåŠŸã€‚è¿™äº› <code>Promise</code> å®ä¾‹æ‰€æœ‰çš„ <code>resolve</code> ç»“æœä¼šæŒ‰ç…§åŸæ¥çš„é¡ºåºé›†åˆåœ¨ä¸€ä¸ªæ•°ç»„ä¸­ä½œä¸º <code>Promise.all</code> çš„ <code>resolve</code> çš„ç»“æœã€‚</li><li>æ•°ç»„ä¸­åªè¦æœ‰ä¸€ä¸ª <code>Promise</code> å®ä¾‹å¤±è´¥ï¼ˆç”±<code>pendding</code>çŠ¶æ€è½¬åŒ–ä¸º<code>rejected</code>çŠ¶æ€ï¼‰ï¼Œ<code>Promise.all</code> å°±å¤±è´¥ã€‚<code>Promise.all</code> çš„ <code>.catch()</code> ä¼šæ•è·åˆ°è¿™ä¸ª <code>reject</code>ã€‚</li></ol><h5 id="åŸç”Ÿ-promise-all-æµ‹è¯•" tabindex="-1">åŸç”Ÿ Promise.all æµ‹è¯• <a class="header-anchor" href="#åŸç”Ÿ-promise-all-æµ‹è¯•" aria-label="Permalink to &quot;åŸç”Ÿ Promise.all æµ‹è¯•&quot;">â€‹</a></h5><p>å’±å…ˆçœ‹çœ‹åŸç”Ÿçš„<code>Promise.all</code>çš„æ˜¯å•¥æ•ˆæœã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p1</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p2 å»¶æ—¶ä¸€ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p3 å»¶æ—¶ä¸¤ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p4</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p4 rejected&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p5</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p5 rejected å»¶æ—¶1.5ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰Promiseå®ä¾‹éƒ½æˆåŠŸ</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">all</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	})</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 2ç§’åæ‰“å° [ &#39;p1&#39;, &#39;p2 å»¶æ—¶ä¸€ç§’&#39;, &#39;p3 å»¶æ—¶ä¸¤ç§’&#39; ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ä¸€ä¸ªPromiseå®ä¾‹å¤±è´¥</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">all</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	})</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p4 rejected</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ä¸€ä¸ªå»¶æ—¶å¤±è´¥çš„Promise</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">all</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	})</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 1.5ç§’åæ‰“å° p5 rejected</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ä¸¤ä¸ªPromiseå®ä¾‹å¤±è´¥</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">all</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	})</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p4 rejected</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p><strong>æ³¨æ„</strong></p><p>ä¸Šé¢ <code>p4</code> å’Œ <code>p5</code> åœ¨æœªä¼ å…¥ <code>Promise.all</code> æ—¶éœ€è¦æ³¨é‡Šæ‰ï¼Œå› ä¸ºä¸€ä¸ªè°ƒç”¨äº† <code>reject</code> çš„ <code>Promise</code> å®ä¾‹å¦‚æœæ²¡æœ‰ä½¿ç”¨ <code>.catch()</code> æ–¹æ³•å»æ•è·é”™è¯¯ä¼šæŠ¥é”™ã€‚ä½†å¦‚æœ <code>Promise</code> å®ä¾‹å®šä¹‰äº†è‡ªå·±çš„ <code>.catch</code>ï¼Œå°±ä¸ä¼šè§¦å‘ <code>Promise.all</code> çš„ <code>.catch()</code> æ–¹æ³•ã€‚</p><p>OKï¼Œç†è®ºå­˜åœ¨ï¼Œå®è·µå¼€å§‹ï¼</p><h5 id="æ‰‹åŠ¨å®ç°-promise-all" tabindex="-1">æ‰‹åŠ¨å®ç° Promise.all <a class="header-anchor" href="#æ‰‹åŠ¨å®ç°-promise-all" aria-label="Permalink to &quot;æ‰‹åŠ¨å®ç° Promise.all&quot;">â€‹</a></h5><ol><li><code>Promise.all</code> æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°çš„ <code>Promise</code> å®ä¾‹</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAll</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol><li>æ•°ç»„ä¸­æ‰€æœ‰ <code>Promise</code> å®ä¾‹éƒ½æˆåŠŸï¼Œ<code>Promise.all</code> æ‰æˆåŠŸã€‚ä¸éš¾æƒ³åˆ°ï¼Œå’±å¾—éœ€è¦ä¸€ä¸ªæ•°ç»„æ¥æ”¶é›†è¿™äº› <code>Promise</code> å®ä¾‹çš„ <code>resolve</code> ç»“æœã€‚ä½†æœ‰å¥ä¿—è¯è¯´å¾—å¥½ï¼šâ€œä¸æ€•ä¸€ä¸‡ï¼Œå°±æ€•ä¸‡ä¸€â€ï¼Œä¸‡ä¸€æ•°ç»„é‡Œé¢æœ‰å…ƒç´ ä¸æ˜¯ <code>Promise</code>å’‹åŠ â€”â€” é‚£å°±å¾—ç”¨ <code>Promise.resolve()</code> æŠŠå®ƒåŠäº†ã€‚è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œ<code>Promise</code> å®ä¾‹æ˜¯ä¸èƒ½ç›´æ¥è°ƒç”¨ <code>resolve</code> æ–¹æ³•çš„ï¼Œå’±å¾—åœ¨ <code>.then()</code> ä¸­å»æ”¶é›†ç»“æœã€‚æ³¨æ„è¦ä¿æŒç»“æœçš„é¡ºåºã€‚</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAll</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [];</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		promises</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">			Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">				arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			});</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol><li>å°†æ”¶é›†åˆ°çš„ç»“æœï¼ˆæ•°ç»„<code>arr</code>ï¼‰ä½œä¸ºå‚æ•°ä¼ ç»™å¤–å±‚çš„ <code>resolve</code> æ–¹æ³•ã€‚è¿™é‡Œå’±ä»¬è‚¯å®šæ˜¯æœ‰ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶çš„ï¼Œå¦‚ä½•åˆ¤æ–­æ‰€æœ‰ <code>Promise</code> å®ä¾‹éƒ½æˆåŠŸäº†å‘¢ï¼Ÿæ–°æ‰‹å®¹æ˜“å†™å‡ºè¿™å¥ä»£ç ï¼ˆæ²¡é”™å°±æ˜¯æˆ‘æœ¬äººäº† ğŸ˜­ï¼‰ï¼š</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">arr</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>å’±ä»”ç»†æƒ³æƒ³ <code>Promise</code> ä½¿ç”¨æ¥å¹²å˜›çš„ â€”â€” å¤„ç†å¼‚æ­¥ä»»åŠ¡ã€‚å¯¹å‘€ï¼Œå¼‚æ­¥ä»»åŠ¡å¾ˆå¤šéƒ½éœ€è¦èŠ±æ—¶é—´å‘€ï¼Œå¦‚æœè¿™äº› <code>Promise</code> ä¸­æœ€åä¸€ä¸ªå…ˆå®Œæˆå‘¢ï¼Ÿé‚£ <code>arr</code> æ•°ç»„ä¸å°±åªæœ‰æœ€åä¸€é¡¹äº†ï¼Œå‰é¢çš„æ‰€æœ‰é¡¹éƒ½æ˜¯ <code>empty</code>ã€‚æ‰€ä»¥è¿™é‡Œå’±ä»¬åº”è¯¥åˆ›å»ºä¸€ä¸ªè®¡æ•°å™¨ï¼Œæ¯æœ‰ä¸€ä¸ª <code>Promise</code> å®ä¾‹æˆåŠŸï¼Œè®¡æ•°å™¨åŠ ä¸€ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAll</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [],</span></span>
<span class="line"><span style="color:#E06C75;">		count</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		promises</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">			Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">				arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">				count</span><span style="color:#56B6C2;"> +=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">				if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">			});</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol><li>æœ€åå°±æ˜¯å¤„ç†å¤±è´¥çš„æƒ…å†µäº†ï¼Œè¿™é‡Œæœ‰ä¸¤ç§å†™æ³•ï¼Œç¬¬ä¸€ç§æ˜¯ç”¨ <code>.catch()</code> æ–¹æ³•æ•è·å¤±è´¥ï¼š</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAll</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [],</span></span>
<span class="line"><span style="color:#E06C75;">		count</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		promises</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">			Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">				.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">					arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">					count</span><span style="color:#56B6C2;"> +=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">					if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				})</span></span>
<span class="line"><span style="color:#ABB2BF;">				.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">reject</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>ç¬¬äºŒç§å†™æ³•å°±æ˜¯ç»™ <code>.then()</code> æ–¹æ³•ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å¤„ç†é”™è¯¯çš„å›è°ƒå‡½æ•°ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAll</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [],</span></span>
<span class="line"><span style="color:#E06C75;">		count</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		promises</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">			Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">				arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E06C75;">				count</span><span style="color:#56B6C2;"> +=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">				if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">			}, </span><span style="color:#E06C75;">reject</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h5 id="æµ‹è¯•æ¡ˆä¾‹" tabindex="-1">æµ‹è¯•æ¡ˆä¾‹ <a class="header-anchor" href="#æµ‹è¯•æ¡ˆä¾‹" aria-label="Permalink to &quot;æµ‹è¯•æ¡ˆä¾‹&quot;">â€‹</a></h5><p>è‡´æ­¤ <code>Promise.all</code> å¤§åŠŸå‘Šæˆï¼Œèµ¶ç´§æ‹¿æ¥æµ‹è¯•ä¸€ä¸‹ï¼ˆæ‘©æ‹³æ“¦æŒï¼‰ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p1</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p2 å»¶æ—¶ä¸€ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p3 å»¶æ—¶ä¸¤ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p4</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p4 rejected&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p5</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p5 rejected å»¶æ—¶1.5ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰ Promsie éƒ½æˆåŠŸ</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAll</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 2ç§’åæ‰“å° [ &#39;p1&#39;, &#39;p2 å»¶æ—¶ä¸€ç§’&#39;, &#39;p3 å»¶æ—¶ä¸¤ç§’&#39; ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ä¸€ä¸ª Promise å¤±è´¥</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAll</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p4 rejected</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ä¸€ä¸ªå»¶æ—¶å¤±è´¥çš„ Promise</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAll</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 1.5ç§’åæ‰“å° p5 rejected å»¶æ—¶1.5ç§’</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ä¸¤ä¸ªå¤±è´¥çš„ Promise</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAll</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p4 rejected</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>â€œOhOhOhOh~~~~â€ï¼Œä¸åŸç”Ÿçš„ <code>Promise.all</code>è¿è¡Œç»“æœä¸èƒ½è¯´å¾ˆåƒï¼Œåªèƒ½è¯´ä¸€æ¨¡ä¸€æ ·ã€‚è€è¯è¯´çš„å¥½ï¼Œè¶çƒ­æ‰“é“â€”â€”æ­£åœ¨ç«å€™ä¸Šã€‚æˆ‘æ‰“å¼€æŸä¸ªå­¦ä¹ ç½‘ç«™ï¼ˆ<a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noreferrer">MDN Web Docs (mozilla.org)</a>ï¼‰ï¼Œäº†è§£åˆ° <code>Promise</code> å¯¹è±¡ç”¨äºåŒæ—¶å¤„ç†å¤šä¸ª <code>Promise</code> çš„æ–¹æ³•è¿˜æœ‰ <code>Promise.race</code>ã€<code>Promise.any</code>ã€<code>Promise.allSettle</code>ã€‚ä»å°è€å¸ˆå°±æ•™ä¼šäº†å’±ä»¬ä¸¾ä¸€åä¸‰ï¼Œä»”ç»†çœ‹äº†è¿™ä¸‰ä¸ªæ–¹æ³•çš„æè¿°ä¹‹åï¼Œæˆ‘è¿˜çœŸç»™åå‡ºæ¥äº† ğŸ˜„ã€‚</p><h5 id="promise-race" tabindex="-1">Promise.race <a class="header-anchor" href="#promise-race" aria-label="Permalink to &quot;Promise.race&quot;">â€‹</a></h5><p><code>Promise.race</code> ä»å­—é¢æ„æ€ç†è§£å°±æ˜¯èµ›è·‘ï¼Œä»¥çŠ¶æ€å˜åŒ–æœ€å¿«çš„é‚£ä¸ª <code>Promise</code> å®ä¾‹ä¸ºå‡†ï¼Œæœ€å¿«çš„ <code>Promise</code> æˆåŠŸ <code>Promise.race</code> å°±æˆåŠŸï¼Œæœ€å¿«çš„ <code>Promise</code> å¤±è´¥ <code>Promise.race</code> å°±å¤±è´¥ã€‚</p><p>å’±æ¥çœ‹çœ‹åŸç”Ÿ <code>Promise.race</code> æ•ˆæœ</p><h6 id="åŸç”Ÿ-promise-race-æµ‹è¯•" tabindex="-1">åŸç”Ÿ Promise.race æµ‹è¯• <a class="header-anchor" href="#åŸç”Ÿ-promise-race-æµ‹è¯•" aria-label="Permalink to &quot;åŸç”Ÿ Promise.race æµ‹è¯•&quot;">â€‹</a></h6><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p1</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p2 å»¶æ—¶ä¸€ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p3 å»¶æ—¶ä¸¤ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p4</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p4 rejected&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p5</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p5 rejected å»¶æ—¶1ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// p1æ— å»¶æ—¶ï¼Œp2å»¶æ—¶1sï¼Œp3å»¶æ—¶2s</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">race</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// p4æ— å»¶æ—¶reject</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">race</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p4 rejected</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// p5 å»¶æ—¶1.5ç§’rejectï¼Œp2å»¶æ—¶1s</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">race</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 1såæ‰“å°: p2 å»¶æ—¶ä¸€ç§’</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>ç†è®ºå­˜åœ¨ï¼Œå®è·µå¼€å§‹</p><h6 id="æ‰‹å†™-promise-race" tabindex="-1">æ‰‹å†™ Promise.race <a class="header-anchor" href="#æ‰‹å†™-promise-race" aria-label="Permalink to &quot;æ‰‹å†™ Promise.race&quot;">â€‹</a></h6><p>æ•´ä½“æµç¨‹ä¸ <code>Promise</code> å·®ä¸å¤šï¼Œåªæ˜¯å¯¹æ•°ç»„ä¸­çš„ <code>Promise</code> å®ä¾‹å¤„ç†çš„é€»è¾‘ä¸ä¸€æ ·ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å°†æœ€å¿«æ”¹å˜çŠ¶æ€çš„ <code>Promise</code> ç»“æœä½œä¸º <code>Promise.race</code> çš„ç»“æœï¼Œç›¸å¯¹æ¥è¯´å°±æ¯”è¾ƒç®€å•äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyRace</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// è¿™é‡Œä¸éœ€è¦ä½¿ç”¨ç´¢å¼•ï¼Œåªè¦èƒ½å¾ªç¯å‡ºæ¯ä¸€é¡¹å°±è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">		for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> item</span><span style="color:#C678DD;"> of</span><span style="color:#E06C75;"> promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">			Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">reject</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h6 id="æµ‹è¯•æ¡ˆä¾‹-1" tabindex="-1">æµ‹è¯•æ¡ˆä¾‹ <a class="header-anchor" href="#æµ‹è¯•æ¡ˆä¾‹-1" aria-label="Permalink to &quot;æµ‹è¯•æ¡ˆä¾‹&quot;">â€‹</a></h6><p>è¿˜æ˜¯åˆšæ‰å‡ ä¸ªæ¡ˆä¾‹ï¼Œå’±å°±ä¸é‡å¤å†™äº† ğŸ˜</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// p1æ— å»¶æ—¶ï¼Œp2å»¶æ—¶1sï¼Œp3å»¶æ—¶2s</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyRace</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// p4æ— å»¶æ—¶reject</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyRace</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p4 rejected</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// p5 å»¶æ—¶1.5ç§’rejectï¼Œp2å»¶æ—¶1s</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyRace</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// 1såæ‰“å°: p2 å»¶æ—¶ä¸€ç§’</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œç»“æœä¸åŸç”Ÿçš„ <code>Promise.race</code> æ˜¯ä¸€è‡´çš„ï¼ŒæˆåŠŸï¼</p><h5 id="promise-any" tabindex="-1">Promise.any <a class="header-anchor" href="#promise-any" aria-label="Permalink to &quot;Promise.any&quot;">â€‹</a></h5><p><code>Promise.any</code> ä¸ <code>Promise.all</code> å¯ä»¥çœ‹åšæ˜¯ç›¸åçš„ã€‚<code>Promise.any</code> ä¸­åªè¦æœ‰ä¸€ä¸ª <code>Promise</code> å®ä¾‹æˆåŠŸå°±æˆåŠŸï¼Œåªæœ‰å½“æ‰€æœ‰çš„ <code>Promise</code> å®ä¾‹å¤±è´¥æ—¶ <code>Promise.any</code> æ‰å¤±è´¥ï¼Œæ­¤æ—¶<code>Promise.any</code> ä¼šæŠŠæ‰€æœ‰çš„å¤±è´¥/é”™è¯¯é›†åˆåœ¨ä¸€èµ·ï¼Œè¿”å›ä¸€ä¸ªå¤±è´¥çš„ <code>promise </code>å’Œ<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/AggregateError" target="_blank" rel="noreferrer"><code>AggregateError</code></a>ç±»å‹çš„å®ä¾‹ã€‚MDN ä¸Šè¯´è¿™ä¸ªæ–¹æ³•è¿˜å¤„äºè¯•éªŒé˜¶æ®µï¼Œå¦‚æœ <code>node</code> æˆ–è€…æµè§ˆå™¨ç‰ˆæœ¬è¿‡ä½å¯èƒ½æ— æ³•ä½¿ç”¨ï¼Œå„ä½çœ‹å®˜è‡ªè¡Œæµ‹è¯•ä¸‹ã€‚</p><h6 id="åŸç”Ÿ-promise-any-æµ‹è¯•" tabindex="-1">åŸç”Ÿ Promise.any æµ‹è¯• <a class="header-anchor" href="#åŸç”Ÿ-promise-any-æµ‹è¯•" aria-label="Permalink to &quot;åŸç”Ÿ Promise.any æµ‹è¯•&quot;">â€‹</a></h6><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p1</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p2 å»¶æ—¶ä¸€ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p3 å»¶æ—¶ä¸¤ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p4</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p4 rejected&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p5</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p5 rejected å»¶æ—¶1.5ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰ Promise éƒ½æˆåŠŸ</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">any</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ä¸¤ä¸ª Promise æˆåŠŸ</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">any</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// åªæœ‰ä¸€ä¸ªå»¶æ—¶æˆåŠŸçš„ Promise</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">any</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p2 å»¶æ—¶1ç§’</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰ Promise éƒ½å¤±è´¥</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">any</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// AggregateError: All promises were rejected</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœ <code>Promise.any</code> ä¸­æœ‰å¤šä¸ªæˆåŠŸçš„ <code>Promise</code> å®ä¾‹ï¼Œåˆ™ä»¥æœ€å¿«æˆåŠŸçš„é‚£ä¸ªç»“æœä½œä¸ºè‡ªèº« <code>resolve</code> çš„ç»“æœã€‚</p><p>OKï¼Œç†è®ºå­˜åœ¨ï¼Œå®è·µå¼€å§‹</p><h6 id="æ‰‹å†™-promise-any" tabindex="-1">æ‰‹å†™ Promise.any <a class="header-anchor" href="#æ‰‹å†™-promise-any" aria-label="Permalink to &quot;æ‰‹å†™ Promise.any&quot;">â€‹</a></h6><ol><li>ä¾è‘«èŠ¦ç”»ç“¢ï¼Œå’±ä»¬å…ˆå†™å‡º <code>Promise.any</code> çš„æ•´ä½“ç»“æ„ï¼š</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAny</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		promises</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol><li>è¿™é‡Œè·Ÿ<code>Promise.all</code> çš„é€»è¾‘æ˜¯åçš„ï¼Œå’±ä»¬éœ€è¦æ”¶é›† <code>reject</code> çš„ <code>Promise</code>ï¼Œä¹Ÿéœ€è¦ä¸€ä¸ªæ•°ç»„å’Œè®¡æ•°å™¨ï¼Œç”¨è®¡æ•°å™¨åˆ¤æ–­æ˜¯å¦æ‰€æœ‰çš„ <code>Promise</code> å®ä¾‹éƒ½å¤±è´¥ã€‚å¦å¤–åœ¨æ”¶é›†å¤±è´¥çš„ <code>Promise</code> ç»“æœæ—¶å’±éœ€è¦æ‰“ä¸Šä¸€ä¸ªå¤±è´¥çš„æ ‡è®°æ–¹ä¾¿åˆ†æç»“æœã€‚</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAny</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [],</span></span>
<span class="line"><span style="color:#E06C75;">		count</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		promises</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">			Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">resolve</span><span style="color:#ABB2BF;">, (</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">				arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> { </span><span style="color:#E06C75;">status</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;rejected&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">val</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;"> };</span></span>
<span class="line"><span style="color:#E06C75;">				count</span><span style="color:#56B6C2;"> +=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">				if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#61AFEF;"> Error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æ²¡æœ‰promiseæˆåŠŸ&quot;</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">			});</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>è¿™é‡Œæˆ‘æ²¡æœ‰ä½¿ç”¨ MDN ä¸Šè§„å®šçš„ <code>AggregateError</code> å®ä¾‹ï¼Œæ‰‹å†™å˜›ï¼Œéšå¿ƒæ‰€æ¬²ä¸€ç‚¹ï¼Œå†™è‡ªå·±çœ‹ç€èˆ’æœçš„ ğŸ˜„</p><h6 id="æµ‹è¯•æ¡ˆä¾‹-2" tabindex="-1">æµ‹è¯•æ¡ˆä¾‹ <a class="header-anchor" href="#æµ‹è¯•æ¡ˆä¾‹-2" aria-label="Permalink to &quot;æµ‹è¯•æ¡ˆä¾‹&quot;">â€‹</a></h6><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰ Promise éƒ½æˆåŠŸ</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAny</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ä¸¤ä¸ª Promise æˆåŠŸ</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAny</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// åªæœ‰ä¸€ä¸ªå»¶æ—¶æˆåŠŸçš„ Promise</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAny</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// p2 å»¶æ—¶1ç§’</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰ Promise éƒ½å¤±è´¥</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAny</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)); </span><span style="color:#7F848E;font-style:italic;">// æ²¡æœ‰promiseæˆåŠŸ</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h5 id="promise-allsettled" tabindex="-1">Promise.allSettled <a class="header-anchor" href="#promise-allsettled" aria-label="Permalink to &quot;Promise.allSettled&quot;">â€‹</a></h5><p>æœ‰æ—¶å€™ï¼Œå’±ä»£ç äººæ€»æ˜¯ä¼šæœ‰ç‚¹ç‰¹æ®Šçš„éœ€æ±‚ï¼šå¦‚æœå’±å¸Œæœ›ä¸€ç»„ <code>Promise</code> å®ä¾‹æ— è®ºæˆåŠŸä¸å¦ï¼Œéƒ½ç­‰å®ƒä»¬å¼‚æ­¥æ“ä½œç»“æŸäº†åœ¨ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼Œè¿™å¯å¦‚ä½•æ˜¯å¥½ï¼Ÿäºæ˜¯å°±å‡ºç°äº† <code>Promise.allSettled</code>ã€‚</p><h6 id="åŸç”Ÿ-promise-allsettled-æµ‹è¯•" tabindex="-1">åŸç”Ÿ <code>Promise.allSettled</code> æµ‹è¯• <a class="header-anchor" href="#åŸç”Ÿ-promise-allsettled-æµ‹è¯•" aria-label="Permalink to &quot;åŸç”Ÿ \`Promise.allSettled\` æµ‹è¯•&quot;">â€‹</a></h6><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p1</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p2 å»¶æ—¶ä¸€ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p3 å»¶æ—¶ä¸¤ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p4</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p4 rejected&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> p5</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;p5 rejected å»¶æ—¶1.5ç§’&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰ Promise å®ä¾‹éƒ½æˆåŠŸ</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">allSettled</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p1&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p2 å»¶æ—¶ä¸€ç§’&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p3 å»¶æ—¶ä¸¤ç§’&#39; }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æœ‰ä¸€ä¸ª Promise å¤±è´¥</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">allSettled</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p1&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p2 å»¶æ—¶ä¸€ç§’&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;rejected&#39; , value: &#39;p4 rejected&#39; }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰ Promise éƒ½å¤±è´¥</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">allSettled</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;rejected&#39;, reason: &#39;p4 rejected&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;rejected&#39;, reason: &#39;p5 rejected å»¶æ—¶1.5ç§’&#39; }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸ <code>Promise.any</code> ç±»ä¼¼ï¼Œ<code>Promise.allSettled</code> ä¹Ÿç»™æ‰€æœ‰æ”¶é›†åˆ°çš„ç»“æœæ‰“ä¸Šäº†æ ‡è®°ã€‚è€Œä¸” <code>Promise.allSettled</code> æ˜¯ä¸ä¼šå˜æˆ <code>rejected</code> çŠ¶æ€çš„ï¼Œä¸ç®¡ä¸€ç»„ <code>Promise</code> å®ä¾‹çš„å„è‡ªç»“æœå¦‚ä½•ï¼Œ<code>Promise.allSettled</code> éƒ½ä¼šè½¬å˜ä¸º <code>fulfilled</code> çŠ¶æ€ã€‚</p><p>OKï¼Œç†è®ºå­˜åœ¨ï¼Œå®è·µå¼€å§‹</p><h6 id="æ‰‹å†™-promise-allsettled" tabindex="-1">æ‰‹å†™ Promise.allSettled <a class="header-anchor" href="#æ‰‹å†™-promise-allsettled" aria-label="Permalink to &quot;æ‰‹å†™ Promise.allSettled&quot;">â€‹</a></h6><p>å’±å°±æ˜¯è¯´ï¼Œå¾—ç”¨ä¸ªæ•°ç»„æŠŠæ‰€æœ‰çš„ <code>Promise</code> å®ä¾‹çš„ç»“æœï¼ˆæ— è®ºæˆåŠŸä¸å¦ï¼‰éƒ½æ”¶é›†èµ·æ¥ï¼Œåˆ¤æ–­æ”¶é›†å®Œäº†ï¼ˆæ‰€æœ‰ <code>Promise</code> å®ä¾‹çŠ¶æ€éƒ½æ”¹å˜äº†ï¼‰ï¼Œå’±å°±å°†è¿™ä¸ªæ”¶é›†åˆ°çš„ç»“æœ <code>resolve</code> æ‰ã€‚æ”¶é›†æˆåŠŸ <code>Promise</code> ç»“æœçš„é€»è¾‘å’±ä»¬åœ¨ <code>Promise.all</code> ä¸­å®ç°è¿‡ï¼Œæ”¶é›†å¤±è´¥ <code>Promise</code> ç»“æœå’±ä»¬åœ¨ <code>Promise.any</code> ä¸­å¤„ç†è¿‡ã€‚è¿™æ³¢ï¼Œè¿™æ³¢æ˜¯ä¾è‘«èŠ¦ç”»ç“¢â€”â€”ç…§æ ·ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAllSettled</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [],</span></span>
<span class="line"><span style="color:#E06C75;">		count</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		promises</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">			Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">				(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">					arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> { </span><span style="color:#E06C75;">status</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;fulfilled&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">val</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;"> };</span></span>
<span class="line"><span style="color:#E06C75;">					count</span><span style="color:#56B6C2;"> +=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">					if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				},</span></span>
<span class="line"><span style="color:#ABB2BF;">				(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">					arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> { </span><span style="color:#E06C75;">status</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;rejected&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">val</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;"> };</span></span>
<span class="line"><span style="color:#E06C75;">					count</span><span style="color:#56B6C2;"> +=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">					if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#ABB2BF;">			);</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>è¿™ä»£ç ï¼Œé€»è¾‘ä¸Šè™½è¯´æ²¡é—®é¢˜ï¼Œä½†å„ä½ä¼˜ç§€çš„ç¨‹åºå‘˜ä»¬è‚¯å®šæ˜¯çœ‹ä¸é¡ºçœ¼çš„ï¼Œæ€ä¹ˆä¼šæœ‰ä¸¤æ®µé‡å¤çš„ä»£ç æï¼Œä¸è¡Œï¼Œå’±å¾—å°è£…ä¸€ä¸‹ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAllSettled</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">promises</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> arr</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [],</span></span>
<span class="line"><span style="color:#E06C75;">		count</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		const</span><span style="color:#61AFEF;"> processResult</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">index</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">status</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">			arr</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">index</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> { </span><span style="color:#E06C75;">status</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">status</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">val</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;"> };</span></span>
<span class="line"><span style="color:#E06C75;">			count</span><span style="color:#56B6C2;"> +=</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">			if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">count</span><span style="color:#56B6C2;"> ===</span><span style="color:#E5C07B;"> promises</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;">) </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">arr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">		promises</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">item</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">i</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">			Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">item</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">				(</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">					processResult</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;fulfilled&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				},</span></span>
<span class="line"><span style="color:#ABB2BF;">				(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">					processResult</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;rejected&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#ABB2BF;">			);</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>perfectï¼Œä¿—è¯è¯´å¾—å¥½ï¼šæ²¡ç—…èµ°ä¸¤æ­¥ã€‚è€æ ·å­ï¼Œç»™ä»£ç è·‘å‡ ä¸ªæ¡ˆä¾‹ã€‚</p><h6 id="æµ‹è¯•æ¡ˆä¾‹-3" tabindex="-1">æµ‹è¯•æ¡ˆä¾‹ <a class="header-anchor" href="#æµ‹è¯•æ¡ˆä¾‹-3" aria-label="Permalink to &quot;æµ‹è¯•æ¡ˆä¾‹&quot;">â€‹</a></h6><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰ Promise å®ä¾‹éƒ½æˆåŠŸ</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">MyAllSettled</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p3</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p1&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p2 å»¶æ—¶ä¸€ç§’&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p3 å»¶æ—¶ä¸¤ç§’&#39; }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æœ‰ä¸€ä¸ª MyAllSettled å¤±è´¥</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">allSettled</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p1&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;fulfilled&#39;, value: &#39;p2 å»¶æ—¶ä¸€ç§’&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;rejected&#39; , value: &#39;p4 rejected&#39; }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ‰€æœ‰ MyAllSettled éƒ½å¤±è´¥</span></span>
<span class="line"><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">allSettled</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">p4</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">p5</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;rejected&#39;, reason: &#39;p4 rejected&#39; },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   { status: &#39;rejected&#39;, reason: &#39;p5 rejected å»¶æ—¶1.5ç§’&#39; }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>è‡´æ­¤ï¼Œå¤§åŠŸå‘Šæˆï¼Œæˆ‘å¯ä»¥éª„å‚²åœ°å¯¹å¦ˆå¦ˆè¯´ï¼šâ€œå¦ˆå¦ˆï¼Œæˆ‘å†ä¹Ÿä¸æ€• Promise.allâ€äº†</p><h2 id="æ‰‹å†™-async-await" tabindex="-1">æ‰‹å†™ <code>async/await</code> <a class="header-anchor" href="#æ‰‹å†™-async-await" aria-label="Permalink to &quot;æ‰‹å†™ \`async/await\`&quot;">â€‹</a></h2><h3 id="ä»€ä¹ˆæ˜¯-async-await-åŠå…¶å¦‚ä½•å·¥ä½œ" tabindex="-1">ä»€ä¹ˆæ˜¯ <code>async/await</code> åŠå…¶å¦‚ä½•å·¥ä½œ <a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-async-await-åŠå…¶å¦‚ä½•å·¥ä½œ" aria-label="Permalink to &quot;ä»€ä¹ˆæ˜¯ \`async/await\` åŠå…¶å¦‚ä½•å·¥ä½œ&quot;">â€‹</a></h3><p>1ã€Asyncâ€”å£°æ˜ä¸€ä¸ªå¼‚æ­¥å‡½æ•°</p><ul><li>è‡ªåŠ¨å°†å¸¸è§„å‡½æ•°è½¬æ¢æˆ Promiseï¼Œè¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ª Promise å¯¹è±¡</li><li>åªæœ‰ async å‡½æ•°å†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œ then æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°</li><li>å¼‚æ­¥å‡½æ•°å†…éƒ¨å¯ä»¥ä½¿ç”¨ await</li></ul><p>2ã€Awaitâ€”æš‚åœå¼‚æ­¥çš„åŠŸèƒ½æ‰§è¡Œ(var result = await someAsyncCall()ğŸ˜‰</p><ul><li>æ”¾ç½®åœ¨ Promise è°ƒç”¨ä¹‹å‰ï¼Œawait å¼ºåˆ¶å…¶ä»–ä»£ç ç­‰å¾…ï¼Œç›´åˆ° Promise å®Œæˆå¹¶è¿”å›ç»“æœ</li><li>åªèƒ½ä¸ Promise ä¸€èµ·ä½¿ç”¨ï¼Œä¸é€‚ç”¨ä¸å›è°ƒ</li><li>åªèƒ½åœ¨ async å‡½æ•°å†…éƒ¨ä½¿ç”¨</li></ul><p>æ¥çœ‹ä¸‹ MDN çš„æ¦‚å¿µ</p><blockquote><p>async å‡½æ•°æ˜¯ä½¿ç”¨<code>async</code>å…³é”®å­—å£°æ˜çš„å‡½æ•°ã€‚async å‡½æ•°æ˜¯<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/AsyncFunction" target="_blank" rel="noreferrer">AsyncFunction</a> æ„é€ å‡½æ•°çš„å®ä¾‹ï¼Œå¹¶ä¸”å…¶ä¸­å…è®¸ä½¿ç”¨ <code>await</code> å…³é”®å­—</p><p><code>await</code> æ“ä½œç¬¦ç”¨äºç­‰å¾…ä¸€ä¸ª <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noreferrer">Promise</a>å…‘ç°å¹¶è·å–å®ƒå…‘ç°ä¹‹åçš„å€¼ã€‚å®ƒåªèƒ½åœ¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank" rel="noreferrer">async function</a>æˆ–è€…<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Modules" target="_blank" rel="noreferrer">JavaScript æ¨¡å—</a>é¡¶å±‚ä¸­ä½¿ç”¨ã€‚</p><p><code>async</code> å’Œ <code>await</code> å…³é”®å­—è®©æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼å†™å‡ºåŸºäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FPromise" target="_blank" rel="noreferrer"><code>Promise</code></a> çš„å¼‚æ­¥è¡Œä¸ºï¼Œè€Œæ— éœ€åˆ»æ„åœ°é“¾å¼è°ƒç”¨ <code>promise</code>ã€‚</p></blockquote><h3 id="async" tabindex="-1">async <a class="header-anchor" href="#async" aria-label="Permalink to &quot;async&quot;">â€‹</a></h3><p><code>async</code>åœ¨å­—é¢ä¸Šçš„æ„æ€å‘¢ï¼Œæ˜¯<code>å¼‚æ­¥</code>çš„æ¦‚å¿µï¼Œæ ¹æ® MDN çš„æ¦‚å¿µå‘¢ï¼Œè¯´æ˜ async å£°æ˜çš„æ˜¯ä¸€ä¸ªå¼‚æ­¥æ„é€ å‡½æ•°ï¼Œæ¥çœ‹å¦‚ä¸‹ç¤ºä¾‹</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> fn1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> async</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">fn1</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Promise {&lt;fulfilled&gt;: 1}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>æ ¹æ®ä¸Šè¿°ç¤ºä¾‹å†…å®¹ï¼Œè¡¨è¿° async å£°æ˜äº†ä¸€ä¸ªå¼‚æ­¥æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”è°ƒç”¨äº†è¯¥å‡½æ•°ï¼Œè¿”å›ç»“æœæ˜¯ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚</p><p>é‚£é—®é¢˜æ¥äº†ï¼Œåœ¨çœ‹ä¸Šè¿°ä»£ç å¼‚æ­¥å‡½æ•°ä¸­ return çš„æ˜¯ 1ï¼Œç»“æœå´æ˜¯ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œä¸æ€¥ï¼Œç­”æ¡ˆæ¥äº†ã€‚</p><p>å¦‚æœåœ¨å‡½æ•°ä¸­ return çš„ä¸æ˜¯ä¸€ä¸ª promise,é‚£ä¹ˆå°†ç­‰åŒäºä½¿ç”¨ Promise.resolve(x)ç»™åŒ…è£…èµ·æ¥</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>å°†å¸¸è§„å‡½æ•°è½¬æ¢æˆ Promiseï¼Œè¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ª Promise å¯¹è±¡</p></blockquote><p>é‚£è¿™ä¹ˆçœ‹ async ä¸ Promise æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œçœ‹ç€æ˜¯æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå…ˆä¸ç€æ€¥ï¼Œå†æ¥ç€çœ‹ä¸‹<code>await</code></p><h3 id="await" tabindex="-1">await <a class="header-anchor" href="#await" aria-label="Permalink to &quot;await&quot;">â€‹</a></h3><p><code>await</code>å­—é¢æ„æ€å‘¢ç­‰å¾…ç­‰å€™çš„æ„æ€ï¼Œé‚£åˆ°åº•æ˜¯åœ¨ç­‰ä»€ä¹ˆå‘¢ï¼Œç­‰ promise å¯¹è±¡å—ï¼Ÿ</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> fn1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> result</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> r1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> fn1</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">r1</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 1</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">result</span><span style="color:#ABB2BF;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>è¿˜å¯ä»¥ç­‰å…¶å®ƒå€¼å—ï¼Ÿ</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> fn1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> fn2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> test</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#98C379;"> &quot;test&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> result</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> r1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> fn1</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> r2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> fn2</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">r1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">r2</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 1 &#39;test&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">result</span><span style="color:#ABB2BF;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>ç»“æœå‘¢ï¼Œä¸æ˜¯ promise å¯¹è±¡çš„å€¼ä¹Ÿç­‰åˆ°äº†ã€‚</p><blockquote><p>await ä¸ä»…ä»…ç”¨äºç­‰ Promise å¯¹è±¡ï¼Œå®ƒå¯ä»¥ç­‰ä»»æ„è¡¨è¾¾å¼çš„ç»“æœã€‚å¹¶ä¸”è¿”å›å¤„ç†ç»“æœ</p><p>åªèƒ½åœ¨ async å‡½æ•°å†…éƒ¨ä½¿ç”¨</p></blockquote><h3 id="async-await-ä½œç”¨" tabindex="-1">async/await ä½œç”¨ <a class="header-anchor" href="#async-await-ä½œç”¨" aria-label="Permalink to &quot;async/await ä½œç”¨&quot;">â€‹</a></h3><p>æ ¹æ®ä¸Šè¿°å†…å®¹å‘¢ï¼Œäº†è§£åˆ° async ä¸ await å¦‚ä½•ä½¿ç”¨ä»¥åŠè¿”å›ç»“æœï¼Œé‚£å®ƒä»¬çš„ä½œç”¨ä½“ç°åˆ°å“ªäº†å‘¢ï¼Ÿ</p><p>å…ˆçœ‹ä¸‹åˆ—æœ‰ä¸€ä¸ªä¸šåŠ¡ï¼Œä¸šåŠ¡å†…å®¹å‘¢éœ€è¦é‡å¤è¯·æ±‚æ“ä½œï¼Œä½†æ˜¯æ¥å£å‚æ•°å‘¢éƒ½éœ€è¦åœ¨ä¸Šä¸€ä¸ªè¯·æ±‚ç»“æœä¸­è·å–ï¼Œå…ˆçœ‹ä¸‹ä¾‹å­</p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">type</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> type</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">	getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">c</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">c</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">			return</span><span style="color:#E06C75;"> data</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>å¤šé‡çš„å¼‚æ­¥æ“è¿™æ˜¯ä¸æ˜¯ä¼ è¯´ä¸­çš„å›è°ƒåœ°ç‹±å‘¢ï¼Œé‚£æ€ä¹ˆè§£å†³å‘¢</p><p>ç”¨ promise æ–¹æ³•æ¥è§£å†³</p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">type</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">		let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> type</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#61AFEF;">		resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">result</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	})</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	})</span></span>
<span class="line"><span style="color:#ABB2BF;">	.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>æ¥ç”¨ async/await æ¥è§£å†³</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">type</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> type</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> result</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> getResult</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> n1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> n2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">n1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> n3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> await</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">n2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">n1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">n2</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">n3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">getResult</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>è¾“å‡ºç»“æœå‘¢ä¸<code>Promise</code>è§£å†³æ–¹æ¡ˆæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯ä»£ç çœ‹èµ·æ¥ç®€æ´æ˜äº†</p><blockquote><p><strong>ç”¨åŒæ­¥æ–¹å¼ï¼Œæ‰§è¡Œå¼‚æ­¥æ“ä½œ</strong>è¾¾åˆ°æ’é˜Ÿæ•ˆæœï¼Œè§£å†³å›è°ƒåœ°ç‹±</p></blockquote><h3 id="generator" tabindex="-1">Generator <a class="header-anchor" href="#generator" aria-label="Permalink to &quot;Generator&quot;">â€‹</a></h3><p>async/await ä¸ºä»€ä¹ˆè¯´æ˜¯è¯­æ³•ç³–å‘¢ï¼Œæ˜¯è°çš„è¯­æ³•ç³–å‘¢ï¼Ÿ</p><p>åœ¨é˜®ä¸€å³°çš„ ES6 å…¥é—¨æ•™ç¨‹ä¸­æœ‰è¯´åˆ°ï¼š</p><p>async å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿä¸€å¥è¯ï¼Œå®ƒå°±æ˜¯ Generator å‡½æ•°çš„è¯­æ³•ç³–ã€‚</p><blockquote><p>Generator å‡½æ•°å°±æ˜¯ä¸€ä¸ªå°è£…çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæˆ–è€…è¯´æ˜¯å¼‚æ­¥ä»»åŠ¡çš„å®¹å™¨ã€‚</p><p>å¼‚æ­¥æ“ä½œéœ€è¦æš‚åœçš„åœ°æ–¹ï¼Œéƒ½ç”¨ yield è¯­å¥æ³¨æ˜</p><p>è°ƒç”¨ Generator å‡½æ•°ï¼Œè¿”å›çš„æ˜¯æŒ‡é’ˆå¯¹è±¡(è¿™æ˜¯å®ƒå’Œæ™®é€šå‡½æ•°çš„ä¸åŒä¹‹å¤„),ã€‚è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ next æ–¹æ³•ï¼Œä¼šç§»åŠ¨å†…éƒ¨æŒ‡é’ˆã€‚</p><p>next æ–¹æ³•çš„ä½œç”¨æ˜¯åˆ†é˜¶æ®µæ‰§è¡Œ Generator å‡½æ•°ã€‚æ¯æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„ä¿¡æ¯ï¼ˆ value å±æ€§å’Œ done å±æ€§ï¼‰ã€‚value å±æ€§æ˜¯ yield è¯­å¥åé¢è¡¨è¾¾å¼çš„å€¼ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„å€¼ï¼›done å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤º Generator å‡½æ•°æ˜¯å¦æ‰§è¡Œå®Œæ¯•ï¼Œå³æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚</p></blockquote><p>äº†è§£ generator ç”¨æ³•</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function*</span><span style="color:#61AFEF;"> Generator</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	yield</span><span style="color:#98C379;"> &quot;1&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	yield</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#98C379;"> &quot;3&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> gen</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> Generator</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">gen</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//è¿”å›ä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ Generator {&lt;suspended&gt;}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>è°ƒç”¨ next æ–¹æ³•</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> res1</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> gen</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">next</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res1</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// è¿”å›å½“å‰é˜¶æ®µçš„å€¼ { value: &#39;1&#39;, done: false }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> res2</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> gen</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">next</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res2</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// è¿”å›å½“å‰é˜¶æ®µçš„å€¼ { value: Promise { 2 }, done: false }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">res2</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">value</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 2</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> res3</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> gen</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">next</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res3</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// { value: &#39;3&#39;, done: true }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> res4</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> gen</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">next</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res4</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// { value: undefined, done: true }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="å®ç°-async-await" tabindex="-1">å®ç° async/await <a class="header-anchor" href="#å®ç°-async-await" aria-label="Permalink to &quot;å®ç° async/await&quot;">â€‹</a></h3><p><strong>async/await çš„ç†è§£</strong></p><ul><li><strong>async å‡½æ•°æ‰§è¡Œç»“æœè¿”å›çš„æ˜¯ä¸€ä¸ª Promise</strong></li><li><strong>async å‡½æ•°å°±æ˜¯å°† Generator å‡½æ•°çš„æ˜Ÿå·ï¼ˆ*ï¼‰æ›¿æ¢æˆ asyncï¼Œå°† yield æ›¿æ¢æˆ await</strong></li><li><strong>async/await å°±æ˜¯ Generator çš„è¯­æ³•ç³–ï¼Œå…¶æ ¸å¿ƒé€»è¾‘æ˜¯è¿­ä»£æ‰§è¡Œ next å‡½æ•°</strong></li></ul><p>å…ˆæ¥åˆæ­¥å®ç°ä¸€ä¸ªæ‰§è¡Œç»“æœè¿”å› Promise çš„å‡½æ•°</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> muYouAsync</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è¿”å›ä¸€ä¸ªå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// è¿”å›ä¸€ä¸ªpromise</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {});</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>å¹¶ä¸”å‘¢ muYouAsync æ¥å—ä¸€ä¸ª Generator å‡½æ•°ä½œä¸ºå‚æ•°çš„ï¼Œé‚£æˆ‘ä»¬å†æ¥å®Œå–„ä¸€ä¸‹</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function*</span><span style="color:#61AFEF;"> gen</span><span style="color:#ABB2BF;">() {}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æ¥å—ä¸€ä¸ªGeneratorå‡½æ•°ä½œä¸ºå‚æ•°</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> muYouAsync</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">gen</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è¿”å›ä¸€ä¸ªå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// è¿”å›ä¸€ä¸ªpromise</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {});</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸‹çœ‹ä¸‹æ‰§è¡Œç»“æœæ˜¯å¦è¿”å› Promise</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> asyncGen</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> muYouAsync</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">gen</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">asyncGen</span><span style="color:#ABB2BF;">()); </span><span style="color:#7F848E;font-style:italic;">//Promise {&lt;pending&gt;}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>çœ‹è¾“å‡ºç»“æœçš„è¯ä¸æ‰§è¡Œç»“æœè¿”å› Promise æ˜¯ä¸€è‡´çš„</p><p>è‡³æ­¤å‘¢ç¬¬ä¸€éƒ¨åˆ†å‡½æ•°æ‰§è¡Œè¿”å›ç»“æœå·²å®Œæˆï¼Œé‚£æˆ‘ä»¬æ¥å®Œå–„ä¸€ä¸‹ Generator å‡½æ•°</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">nums</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span></span>
<span class="line"><span style="color:#C678DD;">	new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">			resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">nums</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">function*</span><span style="color:#61AFEF;"> gen</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> yield</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> yield</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> yield</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> res3</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Generator å‡½æ•°ä¹Ÿç¼–å†™å®Œæˆäº†ï¼Œåœ¨ä¸‹ä¸€æ­¥æˆ‘ä»¬è¦æƒ³ï¼Œæ€ä¹ˆè®©å®ƒæ‰§è¡Œèµ·æ¥äº†å‘¢ï¼Œé‚£å°±éœ€è¦ç”¨åˆ° Generator æ ¸å¿ƒé€»è¾‘è¿­ä»£æ‰§è¡Œ next å‡½æ•°ï¼Œ<strong>æ³¨æ„ç‚¹æ˜¯éœ€è¦å°† next è¿­ä»£æ‰§è¡Œ</strong></p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">//æ¥å—ä¸€ä¸ªGeneratorå‡½æ•°ä½œä¸ºå‚æ•°</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> muYouAsync</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">gen</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è¿”å›ä¸€ä¸ªå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// è¿”å›ä¸€ä¸ªpromise</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// æ‰§è¡ŒGeneratorå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> g</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> gen</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">			const</span><span style="color:#61AFEF;"> next</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">				const</span><span style="color:#ABB2BF;"> { </span><span style="color:#E5C07B;">done</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">value</span><span style="color:#ABB2BF;"> } </span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;"> g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">next</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">context</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">done</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">					// è¿™æ—¶å€™è¯´æ˜å·²ç»æ˜¯å®Œæˆäº†ï¼Œéœ€è¦è¿”å›ç»“æœ</span></span>
<span class="line"><span style="color:#61AFEF;">					resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">					// ç»§ç»­æ‰§è¡Œnextå‡½æ•°,ä¼ å…¥æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#C678DD;">					return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">val</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#61AFEF;"> next</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">val</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#ABB2BF;">			};</span></span>
<span class="line"><span style="color:#61AFEF;">			next</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>æ•´ä½“çš„é€»è¾‘å·²ç»å…¨éƒ½è¡¥å……å¥½äº†ï¼Œé‚£æˆ‘ä»¬è¿˜éœ€è¦åœ¨å®Œå–„ä¸‹æœ€åä¸€æ­¥ï¼Œasync è¿”å›çš„æ˜¯ promiseï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ try catch æ¥æ•è·ã€‚</p><h3 id="å®Œæ•´ä»£ç " tabindex="-1">å®Œæ•´ä»£ç  <a class="header-anchor" href="#å®Œæ•´ä»£ç " aria-label="Permalink to &quot;å®Œæ•´ä»£ç &quot;">â€‹</a></h3><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// æ¥å—ä¸€ä¸ªGeneratorå‡½æ•°ä½œä¸ºå‚æ•°</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> muYouAsync</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">gen</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è¿”å›ä¸€ä¸ªå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">		// è¿”å›ä¸€ä¸ªpromise</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#C678DD;"> new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">			// æ‰§è¡ŒGeneratorå‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">			let</span><span style="color:#E06C75;"> g</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> gen</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">			const</span><span style="color:#61AFEF;"> next</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">context</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">				let</span><span style="color:#E06C75;"> res</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">				try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">					res</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> g</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">next</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">context</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				} </span><span style="color:#C678DD;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">error</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">					reject</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">error</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#C678DD;">				if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">done</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">					// è¿™æ—¶å€™è¯´æ˜å·²ç»æ˜¯å®Œæˆäº†ï¼Œéœ€è¦è¿”å›ç»“æœ</span></span>
<span class="line"><span style="color:#61AFEF;">					resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">					// ç»§ç»­æ‰§è¡Œnextå‡½æ•°,ä¼ å…¥æ‰§è¡Œç»“æœ</span></span>
<span class="line"><span style="color:#C678DD;">					return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">						(</span><span style="color:#E06C75;font-style:italic;">val</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#61AFEF;"> next</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">val</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">						(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#61AFEF;"> next</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					);</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#ABB2BF;">			};</span></span>
<span class="line"><span style="color:#61AFEF;">			next</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">		});</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>é‚£æˆ‘ä»¬æœ€åæ¥æµ‹è¯•ä¸€ä¸‹</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">nums</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span></span>
<span class="line"><span style="color:#C678DD;">	new</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">			resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">nums</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">function*</span><span style="color:#61AFEF;"> gen</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res1</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> yield</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res2</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> yield</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> res3</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> yield</span><span style="color:#61AFEF;"> getFetch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> res3</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> asyncGen</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> muYouAsync</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">gen</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">asyncGen</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">then</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}); </span><span style="color:#7F848E;font-style:italic;">// 4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_9-ä½¿ç”¨-settimeout-å®ç°-setinterval" tabindex="-1">9. ä½¿ç”¨ setTimeout å®ç° setInterval <a class="header-anchor" href="#_9-ä½¿ç”¨-settimeout-å®ç°-setinterval" aria-label="Permalink to &quot;9. ä½¿ç”¨ setTimeout å®ç° setInterval&quot;">â€‹</a></h2><p>(1)ç”¨ setTimeout()æ–¹æ³•æ¥æ¨¡æ‹Ÿ setInterval()ä¸ setInterval()ä¹‹é—´çš„ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p>é¦–å…ˆæ¥çœ‹ setInterval çš„ç¼ºé™·ï¼Œä½¿ç”¨ setInterval()åˆ›å»ºçš„å®šæ—¶å™¨ç¡®ä¿äº†å®šæ—¶å™¨ä»£ç è§„åˆ™åœ°æ’å…¥é˜Ÿåˆ—ä¸­ã€‚</p><p>è¿™ä¸ªé—®é¢˜åœ¨äºï¼šå¦‚æœå®šæ—¶å™¨ä»£ç åœ¨ä»£ç å†æ¬¡æ·»åŠ åˆ°é˜Ÿåˆ—ä¹‹å‰è¿˜æ²¡å®Œæˆæ‰§è¡Œï¼Œç»“æœå°±ä¼šå¯¼è‡´å®šæ—¶å™¨ä»£ç è¿ç»­è¿è¡Œå¥½å‡ æ¬¡ã€‚è€Œä¹‹é—´æ²¡æœ‰é—´éš”ã€‚ä¸è¿‡å¹¸è¿çš„æ˜¯ï¼šjavascript å¼•æ“è¶³å¤Ÿèªæ˜ï¼Œèƒ½å¤Ÿé¿å…è¿™ä¸ªé—®é¢˜ã€‚</p><p>å½“ä¸”ä»…å½“æ²¡æœ‰è¯¥å®šæ—¶å™¨çš„å¦‚ä½•ä»£ç å®ä¾‹æ—¶ï¼Œæ‰ä¼šå°†å®šæ—¶å™¨ä»£ç æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ã€‚è¿™ç¡®ä¿äº†å®šæ—¶å™¨ä»£ç åŠ å…¥é˜Ÿåˆ—ä¸­æœ€å°çš„æ—¶é—´é—´éš”ä¸ºæŒ‡å®šæ—¶é—´ã€‚</p><p>è¿™ç§é‡å¤å®šæ—¶å™¨çš„è§„åˆ™æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š1.æŸäº›é—´éš”ä¼šè¢«è·³è¿‡ 2.å¤šä¸ªå®šæ—¶å™¨çš„ä»£ç æ‰§è¡Œæ—¶é—´å¯èƒ½ä¼šæ¯”é¢„æœŸå°ã€‚</p><p>ä¸‹é¢ä¸¾ä¾‹å­è¯´æ˜ï¼š</p><p>å‡è®¾ï¼ŒæŸä¸ª onclick äº‹ä»¶å¤„ç†ç¨‹åºä½¿ç”¨å•¦ setInterval()æ¥è®¾ç½®äº†ä¸€ä¸ª 200ms çš„é‡å¤å®šæ—¶å™¨ã€‚å¦‚æœäº‹ä»¶å¤„ç†ç¨‹åºèŠ±äº† 300ms å¤šä¸€ç‚¹çš„æ—¶é—´å®Œæˆã€‚</p><p>è¿™ä¸ªä¾‹å­ä¸­çš„ç¬¬ä¸€ä¸ªå®šæ—¶å™¨æ˜¯åœ¨ 205ms å¤„æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ï¼Œä½†æ˜¯è¦è¿‡ 300ms æ‰èƒ½æ‰§è¡Œã€‚</p><p>åœ¨ 405ms åˆæ·»åŠ äº†ä¸€ä¸ªå‰¯æœ¬ã€‚åœ¨ä¸€ä¸ªé—´éš”ï¼Œ605ms å¤„ï¼Œç¬¬ä¸€ä¸ªå®šæ—¶å™¨ä»£ç è¿˜åœ¨æ‰§è¡Œä¸­ï¼Œè€Œä¸”é˜Ÿåˆ—ä¸­å·²ç»æœ‰äº†ä¸€ä¸ªå®šæ—¶å™¨å®ä¾‹ï¼Œç»“æœæ˜¯ 605ms çš„å®šæ—¶å™¨ä»£ç ä¸ä¼šæ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ã€‚ç»“æœæ˜¯åœ¨ 5ms å¤„æ·»åŠ çš„å®šæ—¶å™¨ä»£ç æ‰§è¡Œç»“æŸåï¼Œ405 å¤„çš„ä»£ç ç«‹å³æ‰§è¡Œã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> say</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//something</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">say</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">say</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// æˆ–è€…</span></span>
<span class="line"><span style="color:#61AFEF;">setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	//do something</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">arguments</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">callee</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>setIntervalçš„ç¼ºç‚¹</code>ï¼šsetInterval çš„ä½œç”¨æ˜¯<code>æ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€ä¸ªå‡½æ•°</code>ï¼Œä½†æ˜¯è¿™ä¸ªæ‰§è¡Œä¸æ˜¯çœŸçš„åˆ°äº†æ—¶é—´ç«‹å³æ‰§è¡Œï¼Œå®ƒçœŸæ­£çš„ä½œç”¨æ˜¯æ¯éš”ä¸€æ®µæ—¶é—´å°†äº‹ä»¶åŠ å…¥äº‹ä»¶é˜Ÿåˆ—ä¸­å»ï¼Œåªæœ‰å½“å½“å‰çš„æ‰§è¡Œæ ˆä¸ºç©ºçš„æ—¶å€™ï¼Œæ‰èƒ½å»ä»äº‹ä»¶é˜Ÿåˆ—ä¸­å–å‡ºäº‹ä»¶æ‰§è¡Œã€‚æ‰€ä»¥å¯èƒ½ä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼Œå°±æ˜¯å½“å‰æ‰§è¡Œæ ˆæ‰§è¡Œçš„æ—¶é—´å¾ˆé•¿ï¼Œå¯¼è‡´äº‹ä»¶é˜Ÿåˆ—é‡Œè¾¹ç§¯ç´¯å¤šä¸ªå®šæ—¶å™¨åŠ å…¥çš„äº‹ä»¶ï¼Œå½“æ‰§è¡Œæ ˆç»“æŸçš„æ—¶å€™ï¼Œè¿™äº›äº‹ä»¶ä¼šä¾æ¬¡æ‰§è¡Œï¼Œå› æ­¤å°±ä¸èƒ½åˆ°é—´éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œçš„æ•ˆæœã€‚</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#61AFEF;">é’ˆå¯¹</span><span style="color:#98C379;"> setInterval</span><span style="color:#98C379;"> çš„è¿™ä¸ªç¼ºç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨</span><span style="color:#98C379;"> setTimeout</span><span style="color:#98C379;"> é€’å½’è°ƒç”¨æ¥æ¨¡æ‹Ÿ</span><span style="color:#98C379;"> setIntervalï¼Œè¿™æ ·æˆ‘ä»¬å°±ç¡®ä¿äº†åªæœ‰ä¸€ä¸ªäº‹ä»¶ç»“æŸäº†ï¼Œæˆ‘ä»¬æ‰ä¼šè§¦å‘ä¸‹ä¸€ä¸ªå®šæ—¶å™¨äº‹ä»¶ï¼Œè¿™æ ·è§£å†³äº†</span><span style="color:#98C379;"> setInterval</span><span style="color:#98C379;"> çš„é—®é¢˜ã€‚</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>å®ç°æ€è·¯æ˜¯ä½¿ç”¨é€’å½’å‡½æ•°ï¼Œä¸æ–­åœ°å»æ‰§è¡Œ setTimeout ä»è€Œè¾¾åˆ° setInterval çš„æ•ˆæœã€‚</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> mySetInterval</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">fn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// æ§åˆ¶å™¨ï¼Œæ§åˆ¶å®šæ—¶å™¨æ˜¯å¦ç»§ç»­æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> timer</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">		flag</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è®¾ç½®é€’å½’å‡½æ•°ï¼Œæ¨¡æ‹Ÿå®šæ—¶å™¨æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">	function</span><span style="color:#61AFEF;"> interval</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">		if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">timer</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">flag</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">			fn</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">			setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">interval</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">timeout</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//é€’å½’</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// å¯åŠ¨å®šæ—¶å™¨</span></span>
<span class="line"><span style="color:#61AFEF;">	setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">interval</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">timeout</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">	// è¿”å›æ§åˆ¶å™¨</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> timer</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> timer</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> mySetInterval</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//3ç§’ååœæ­¢å®šæ—¶å™¨</span></span>
<span class="line"><span style="color:#61AFEF;">setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">timer</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">flag</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">), </span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>é¢˜ç›®æè¿°ï¼šsetinterval ç”¨æ¥å®ç°å¾ªç¯å®šæ—¶è°ƒç”¨ å¯èƒ½ä¼šå­˜åœ¨ä¸€å®šçš„é—®é¢˜ èƒ½ç”¨ settimeout è§£å†³å—</p><p>å®ç°ä»£ç å¦‚ä¸‹:</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> mySettimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">fn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">t</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> timer</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	function</span><span style="color:#61AFEF;"> interval</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#61AFEF;">		fn</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">		timer</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> setTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">interval</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">t</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#61AFEF;">	interval</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		cancel</span><span style="color:#ABB2BF;">: () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">			clearTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">timer</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		},</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// let a=mySettimeout(()=&gt;{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(111);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// },1000)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// let b=mySettimeout(() =&gt; {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(222)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// }, 1000)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><p>æ‰©å±•ï¼šæˆ‘ä»¬èƒ½åè¿‡æ¥ä½¿ç”¨ setinterval æ¨¡æ‹Ÿå®ç° settimeout å—ï¼Ÿ</p></blockquote><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> mySetTimeout</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">fn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">time</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">	const</span><span style="color:#E5C07B;"> timer</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> setInterval</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">		clearInterval</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">timer</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">		fn</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	}, </span><span style="color:#E06C75;">time</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// mySetTimeout(()=&gt;{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//   console.log(1);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// },1000)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>æ‰©å±•æ€è€ƒï¼šä¸ºä»€ä¹ˆè¦ç”¨ settimeout æ¨¡æ‹Ÿå®ç° setintervalï¼Ÿsetinterval çš„ç¼ºé™·æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>ç­”æ¡ˆè¯·è‡ªè¡Œç™¾åº¦å“ˆ è¿™ä¸ªå…¶å®é¢è¯•å®˜é—®çš„ä¹ŸæŒºå¤šçš„ å°ç¼–è¿™é‡Œå°±ä¸å±•å¼€äº†</p><h3 id="å†™ä¸€ä¸ª-mysetinterval-fn-a-b" tabindex="-1">å†™ä¸€ä¸ª <code>mySetInterVal(fn, a, b)</code> <a class="header-anchor" href="#å†™ä¸€ä¸ª-mysetinterval-fn-a-b" aria-label="Permalink to &quot;å†™ä¸€ä¸ª \`mySetInterVal(fn, a, b)\`&quot;">â€‹</a></h3><p><strong>æ¯æ¬¡é—´éš” <code>a,a+b,a+2b</code> çš„æ—¶é—´ï¼Œç„¶åå†™ä¸€ä¸ª <code>myClear</code>ï¼Œåœæ­¢ä¸Šé¢çš„ <code>mySetInterVal</code></strong></p><p>å‚è€ƒç­”æ¡ˆï¼š</p><p>è¯¥é¢˜çš„æ€è·¯å°±æ˜¯æ¯ä¸€æ¬¡åœ¨å®šæ—¶å™¨ä¸­é‡å¯å®šæ—¶å™¨å¹¶ä¸”åœ¨æ—¶é—´æ¯ä¸€æ¬¡éƒ½åŠ  <code>b</code>ï¼Œå¹¶ä¸”è¦æŠŠå®šæ—¶å™¨è¿”å›å›æ¥ï¼Œå¯ä»¥ä½œä¸º<em>myClear</em>çš„å‚æ•°ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">var</span><span style="color:#61AFEF;"> mySetInterVal</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">fn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> timer</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> null</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#61AFEF;"> settimer</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">fn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">b</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">		timer</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> setTimeout</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">			fn</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#61AFEF;">			settimer</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">a</span><span style="color:#56B6C2;"> +</span><span style="color:#E06C75;"> b</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}, </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	};</span></span>
<span class="line"><span style="color:#61AFEF;">	settimer</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">fn</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">b</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#E06C75;"> timer</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> timer</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> mySetInterVal</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">	() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">		console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;timer&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#D19A66;">	1000</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;">	1000</span></span>
<span class="line"><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#61AFEF;"> myClear</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">timer</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">	timer</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#61AFEF;"> clearTimeout</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">timer</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="æ‰‹å†™å®ç°-generator" tabindex="-1">æ‰‹å†™å®ç° generator <a class="header-anchor" href="#æ‰‹å†™å®ç°-generator" aria-label="Permalink to &quot;æ‰‹å†™å®ç° generator&quot;">â€‹</a></h2><h3 id="generator-åŸç†" tabindex="-1">generator åŸç† <a class="header-anchor" href="#generator-åŸç†" aria-label="Permalink to &quot;generator åŸç†&quot;">â€‹</a></h3><p>Generator æ˜¯ ES6 ä¸­æ–°å¢çš„è¯­æ³•ï¼Œå’Œ Promise ä¸€æ ·ï¼Œéƒ½å¯ä»¥ç”¨æ¥å¼‚æ­¥ç¼– ç¨‹</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">var</span><span style="color:#E06C75;"> a</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">var</span><span style="color:#61AFEF;"> b</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> async</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">	a</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> a</span><span style="color:#56B6C2;"> +</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">await</span><span style="color:#D19A66;"> 10</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;2&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// -&gt; &#39;2&#39; 10</span></span>
<span class="line"><span style="color:#E06C75;">	a</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">await</span><span style="color:#D19A66;"> 10</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">	console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;3&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// -&gt; &#39;3&#39; 20</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#61AFEF;">b</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E06C75;">a</span><span style="color:#56B6C2;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;1&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">a</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// -&gt; &#39;1&#39; 1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ä½¿ç”¨ * è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª Generator å‡½æ•°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å†…éƒ¨å¯ä»¥é€šè¿‡ yield æš‚åœä»£ç </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// é€šè¿‡è°ƒç”¨ next æ¢å¤æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#C678DD;">function*</span><span style="color:#61AFEF;"> test</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	let</span><span style="color:#E06C75;"> a</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	yield</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	yield</span><span style="color:#D19A66;"> 3</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> b</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> test</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">b</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">next</span><span style="color:#ABB2BF;">()); </span><span style="color:#7F848E;font-style:italic;">// &gt; { value: 2, done: false }</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">b</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">next</span><span style="color:#ABB2BF;">()); </span><span style="color:#7F848E;font-style:italic;">// &gt; { value: 3, done: false }</span></span>
<span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">b</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">next</span><span style="color:#ABB2BF;">()); </span><span style="color:#7F848E;font-style:italic;">// &gt; { value: undefined, done: true }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>ä»ä»¥ä¸Šä»£ç å¯ä»¥å‘ç°ï¼ŒåŠ ä¸Š * çš„å‡½æ•°æ‰§è¡Œåæ‹¥æœ‰äº† next å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ å‡½æ•°æ‰§è¡Œåè¿”å›äº†ä¸€ä¸ªå¯¹è±¡ã€‚æ¯æ¬¡è°ƒç”¨ next å‡½æ•°å¯ä»¥ç»§ç»­æ‰§è¡Œè¢«æš‚åœçš„ä»£ ç ã€‚</p><h3 id="ä»¥ä¸‹æ˜¯-generator-å‡½æ•°çš„ç®€å•å®ç°" tabindex="-1">ä»¥ä¸‹æ˜¯ Generator å‡½æ•°çš„ç®€å•å®ç° <a class="header-anchor" href="#ä»¥ä¸‹æ˜¯-generator-å‡½æ•°çš„ç®€å•å®ç°" aria-label="Permalink to &quot;ä»¥ä¸‹æ˜¯ Generator å‡½æ•°çš„ç®€å•å®ç°&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// cb ä¹Ÿå°±æ˜¯ç¼–è¯‘è¿‡çš„ test å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> generator</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">cb</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#C678DD;">		var</span><span style="color:#E06C75;"> object</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">			next</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#61AFEF;">			stop</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {},</span></span>
<span class="line"><span style="color:#ABB2BF;">		};</span></span>
<span class="line"><span style="color:#C678DD;">		return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">			next</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#C678DD;">				var</span><span style="color:#E06C75;"> ret</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> cb</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">object</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">				if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">ret</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> undefined</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> { </span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">undefined</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">done</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;"> };</span></span>
<span class="line"><span style="color:#C678DD;">				return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">					value</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">ret</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">					done</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">				};</span></span>
<span class="line"><span style="color:#ABB2BF;">			},</span></span>
<span class="line"><span style="color:#ABB2BF;">		};</span></span>
<span class="line"><span style="color:#ABB2BF;">	})();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å¦‚æœä½ ä½¿ç”¨ babel ç¼–è¯‘åå¯ä»¥å‘ç° test å‡½æ•°å˜æˆäº†è¿™æ ·</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> test</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">	var</span><span style="color:#E06C75;"> a</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">	return</span><span style="color:#61AFEF;"> generator</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">_context</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">		while</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">			switch</span><span style="color:#ABB2BF;"> ((</span><span style="color:#E5C07B;">_context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prev</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> _context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">next</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// å¯ä»¥å‘ç°é€šè¿‡ yield å°†ä»£ç åˆ†å‰²æˆå‡ å—</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// æ¯æ¬¡æ‰§è¡Œ next å‡½æ•°å°±æ‰§è¡Œä¸€å—ä»£ç </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// å¹¶ä¸”è¡¨æ˜ä¸‹æ¬¡éœ€è¦æ‰§è¡Œå“ªå—ä»£ç </span></span>
<span class="line"><span style="color:#C678DD;">				case</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">					a</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 1</span><span style="color:#56B6C2;"> +</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">					_context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">next</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 4</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">					return</span><span style="color:#D19A66;"> 2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">				case</span><span style="color:#D19A66;"> 4</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E5C07B;">					_context</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">next</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> 6</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">					return</span><span style="color:#D19A66;"> 3</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">				// æ‰§è¡Œå®Œæ¯•</span></span>
<span class="line"><span style="color:#C678DD;">				case</span><span style="color:#D19A66;"> 6</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">				case</span><span style="color:#98C379;"> &quot;end&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">					return</span><span style="color:#E5C07B;"> _context</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stop</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">	});</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div>`,489),j=[q];function w(k,P,x,_,I,S){return a(),n("div",null,j)}const V=s(v,[["render",w]]);export{T as __pageData,V as default};
